###############################################################################
#
# IAR C/C++ Compiler V10.10.1.4655 for 8051               04/Feb/2026  00:32:04
# Copyright 2004-2017 IAR Systems AB.
# Standalone license - IAR Embedded Workbench for 8051
#
#    Core               =  plain
#    Code model         =  banked
#    Data model         =  large
#    Calling convention =  xdata reentrant
#    Constant location  =  data_rom
#    Dptr setup         =  1,16
#                          
#    Source file        =  
#        C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\Source\zcl_ZEM.c
#    Command line       =  
#        -f C:\Users\ASUS\AppData\Local\Temp\EWC5FA.tmp
#        ("C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\Source\zcl_ZEM.c" -D
#        BDB_REPORTING -D SECURE=1 -D TC_LINKKEY_JOIN -D NV_INIT -D NV_RESTORE
#        -D xZTOOL_P1 -D xMT_TASK -D xMT_APP_FUNC -D xMT_SYS_FUNC -D
#        xMT_ZDO_FUNC -D xMT_APP_CNF_FUNC -D LCD_SUPPORTED=DEBUG -D
#        MULTICAST_ENABLED=FALSE -D ZCL_READ -D ZCL_DISCOVER -D ZCL_WRITE -D
#        ZCL_BASIC -D ZCL_IDENTIFY -D ZCL_TEMPERATURE_MEASUREMENT -D ZCL_GROUPS
#        -D HAL_LED=TRUE -D HAL_UART=TRUE -D INT_HEAP_LEN=2048 -lC
#        "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\CoordinatorEB\List"
#        -lA "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\CoordinatorEB\List"
#        --diag_suppress Pe001,Pa010 -o "C:\Users\ASUS\Desktop\work\graduration
#        project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\CoordinatorEB\Obj"
#        -e --debug --core=plain --dptr=16,1 --data_model=large
#        --code_model=banked --calling_convention=xdata_reentrant
#        --place_constants=data_rom --nr_virtual_regs 16 -f
#        "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\Tools\CC2530DB\f8wCoord.cfg"
#        (-DCPU32MHZ -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRUE
#        -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8 -DMAC_CFG_RX_MAX=5
#        -DZDO_COORDINATOR -DRTR_NWK) -f
#        "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\Tools\CC2530DB\f8wConfig.cfg"
#        (-DZIGBEEPRO -DSECURE=1 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR
#        -DDEFAULT_CHANLIST=0x00000800 -DZDAPP_CONFIG_PAN_ID=0x1234
#        -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MASK=0x007F
#        -DBEACON_REQUEST_DELAY=100 -DBEACON_REQ_DELAY_MASK=0x00FF
#        -DLINK_STATUS_JITTER_MASK=0x007F -DROUTE_EXPIRY_TIME=30
#        -DAPSC_ACK_WAIT_DURATION_POLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7
#        -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3
#        -DNWK_MAX_DATA_RETRIES=2 -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9
#        -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40 -DNWK_MAX_BINDING_ENTRIES=4
#        -DMAX_BINDING_CLUSTER_IDS=4 -DDEFAULT_KEY={0} -DMAC_MAX_FRAME_SIZE=116
#        -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const __code"
#        -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000
#        -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100 -DREJOIN_POLL_RATE=440
#        -DREJOIN_BACKOFF=900000 -DREJOIN_SCAN=900000 -DENABLE_LED4_DISABLE_S1)
#        -f "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\Tools\CC2530DB\f8wZCL.cfg"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\" -I
#        "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\Source\" -I
#        "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\Source\" -I
#        "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\ZMain\TI2530DB\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\hal\include\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\hal\target\CC2530EB\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\mac\include\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\mac\high_level\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\single_chip\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\mt\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\osal\include\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\services\saddr\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\services\sdata\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\stack\af\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\stack\bdb\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\stack\gp\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\stack\nwk\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\stack\sapi\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\stack\sec\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\stack\sys\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\stack\zcl\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\stack\zdo\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\zmac\"
#        -I "C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\..\..\..\..\..\Components\zmac\f8w\"
#        -Ohz --require_prototypes)
#    Locale             =  Chinese (Simplified)_China.936
#    List file          =  
#        C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\CoordinatorEB\List\zcl_ZEM.lst
#    Object file        =  
#        C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\ZEM\CC2530DB\CoordinatorEB\Obj\zcl_ZEM.r51
#
###############################################################################

C:\Users\ASUS\Desktop\work\graduration project\software\Z-Stack 3.0.2\Projects\zstack\HomeAutomation\ZEM\Source\zcl_ZEM.c
      1          /*********************************************************************
      2           * INCLUDES
      3           */
      4          #include "ZComDef.h"
      5          #include "OSAL.h"
      6          #include "AF.h"
      7          #include "ZDApp.h"
      8          #include "ZDObject.h"
      9          #include "ZDProfile.h"
     10          #include "MT_SYS.h"
     11          
     12          #include "zcl.h"
     13          #include "zcl_general.h"
     14          #include "zcl_ha.h"
     15          #include "zcl_ms.h"
     16          
     17          #include "zcl_ZEM.h"
     18          
     19          #include "onboard.h"

   \                                 In  segment SFR_AN, at 0xf1
   \   unsigned char volatile __sfr PERCFG
   \                     PERCFG:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf4
   \   unsigned char volatile __sfr P1SEL
   \                     P1SEL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
     20          
     21          /* HAL */
     22          #include "hal_lcd.h"
     23          #include "hal_led.h"
     24          #include "hal_key.h"
     25          #include "hal_uart.h"
     26          
     27          #include "bdb_interface.h"
     28          #include "bdb_Reporting.h"
     29             
     30          /*********************************************************************
     31           * MACROS
     32           */
     33          
     34          // how often to report temperature
     35          #define ZEM_REPORT_INTERVAL   10000
     36          
     37          #define GUI_LOCAL_TEMP    1
     38          
     39          #define APP_TITLE "   Temp Sensor  "
     40          
     41          /*********************************************************************
     42           * CONSTANTS
     43           */
     44          
     45          /*********************************************************************
     46           * TYPEDEFS
     47           */
     48          
     49          /*********************************************************************
     50           * GLOBAL VARIABLES
     51           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     52          byte zclZEM_TaskID;
   \                     zclZEM_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     53          
     54          extern int16 zdpExternalStateTaskID;
     55          
     56          // UART Buffer

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     57          static uint8 zclZEM_UartBuf[ZCLZEM_UART_BUF_LEN];
   \                     zclZEM_UartBuf:
   \   000000                DS 64
   \   000040                REQUIRE __INIT_XDATA_Z
     58          
     59          /*********************************************************************
     60           * GLOBAL FUNCTIONS
     61           */
     62          
     63          /*********************************************************************
     64           * LOCAL VARIABLES
     65           */
     66          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     67          uint8 zclZEM_NwkState = 0; // DEV_INIT
   \                     zclZEM_NwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     68          
     69          //static uint8 aProcessCmd[] = { 1, 0, 0, 0 }; // used for reset command, { length + cmd0 + cmd1 + data }
     70          
     71          // Application Endpoint for data communication

   \                                 In  segment XDATA_I, align 1, keep-with-next
     72          static endPointDesc_t ZEM_AppEp =
   \                     ZEM_AppEp:
   \   000000                DS 7
   \   000007                REQUIRE `?<Initializer for ZEM_AppEp>`
   \   000007                REQUIRE __INIT_XDATA_I
     73          {
     74            ZEM_ENDPOINT,                       // Application endpoint
     75            0,
     76            &zclZEM_TaskID,
     77            &zclZEM_SimpleDesc,                 // Simple description for this application
     78            (afNetworkLatencyReq_t)0            // No Network Latency req
     79          };
     80          #ifdef BDB_REPORTING
     81          #if BDBREPORTING_MAX_ANALOG_ATTR_SIZE == 8
     82            uint8 reportableChange[] = {0x2C, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}; // 0x2C01 is 300 in int16
     83          #endif
     84          #if BDBREPORTING_MAX_ANALOG_ATTR_SIZE == 4

   \                                 In  segment XDATA_I, align 1, keep-with-next
     85            uint8 reportableChange[] = {0x2C, 0x01, 0x00, 0x00}; // 0x2C01 is 300 in int16
   \                     reportableChange:
   \   000000                DS 4
   \   000004                REQUIRE `?<Initializer for reportableChange>`
   \   000004                REQUIRE __INIT_XDATA_I
     86          #endif 
     87          #if BDBREPORTING_MAX_ANALOG_ATTR_SIZE == 2
     88            uint8 reportableChange[] = {0x2C, 0x01}; // 0x2C01 is 300 in int16
     89          #endif 
     90          #endif
     91          
     92          /*********************************************************************
     93           * LOCAL FUNCTIONS
     94           */
     95          static void zclZEM_HandleKeys( byte shift, byte keys );
     96          static void zclZEM_BasicResetCB( void );
     97          
     98          static void zclZEM_ProcessCommissioningStatus(bdbCommissioningModeMsg_t* bdbCommissioningModeMsg);
     99          
    100          // Functions to process ZCL Foundation incoming Command/Response messages
    101          static void zclZEM_ProcessIncomingMsg( zclIncomingMsg_t *msg );
    102          #ifdef ZCL_READ
    103          static uint8 zclZEM_ProcessInReadRspCmd( zclIncomingMsg_t *pInMsg );
    104          #endif
    105          #ifdef ZCL_WRITE
    106          static uint8 zclZEM_ProcessInWriteRspCmd( zclIncomingMsg_t *pInMsg );
    107          #endif
    108          static uint8 zclZEM_ProcessInDefaultRspCmd( zclIncomingMsg_t *pInMsg );
    109          #ifdef ZCL_DISCOVER
    110          static uint8 zclZEM_ProcessInDiscCmdsRspCmd( zclIncomingMsg_t *pInMsg );
    111          static uint8 zclZEM_ProcessInDiscAttrsRspCmd( zclIncomingMsg_t *pInMsg );
    112          static uint8 zclZEM_ProcessInDiscAttrsExtRspCmd( zclIncomingMsg_t *pInMsg );
    113          #endif // ZCL_DISCOVER
    114          
    115          static void zclSampleApp_BatteryWarningCB( uint8 voltLevel);
    116          
    117          /*********************************************************************
    118           * STATUS STRINGS
    119           */
    120          
    121          /*********************************************************************
    122           * CONSTANTS
    123           */
    124          
    125          
    126          /*********************************************************************
    127           * ZCL General Profile Callback table
    128           */

   \                                 In  segment XDATA_I, align 1, keep-with-next
    129          static zclGeneral_AppCallbacks_t zclZEM_CmdCallbacks =
   \                     zclZEM_CmdCallbacks:
   \   000000                DS 18
   \   000012                REQUIRE `?<Initializer for zclZEM_CmdCallbacks>`
   \   000012                REQUIRE __INIT_XDATA_I
    130          {
    131            zclZEM_BasicResetCB,        // Basic Cluster Reset command
    132            NULL,                                           // Identify Trigger Effect command
    133            NULL,             				                      // On/Off cluster command
    134            NULL,                                           // On/Off cluster enhanced command Off with Effect
    135            NULL,                                           // On/Off cluster enhanced command On with Recall Global Scene
    136            NULL,                                           // On/Off cluster enhanced command On with Timed Off
    137          #ifdef ZCL_LEVEL_CTRL
    138            NULL,                                           // Level Control Move to Level command
    139            NULL,                                           // Level Control Move command
    140            NULL,                                           // Level Control Step command
    141            NULL,                                           // Level Control Stop command
    142          #endif
    143          #ifdef ZCL_GROUPS
    144            NULL,                                           // Group Response commands
    145          #endif
    146          #ifdef ZCL_SCENES
    147            NULL,                                           // Scene Store Request command
    148            NULL,                                           // Scene Recall Request command
    149            NULL,                                           // Scene Response command
    150          #endif
    151          #ifdef ZCL_ALARMS
    152            NULL,                                           // Alarm (Response) commands
    153          #endif
    154          #ifdef SE_UK_EXT
    155            NULL,                                           // Get Event Log command
    156            NULL,                                           // Publish Event Log command
    157          #endif
    158            NULL,                                           // RSSI Location command
    159            NULL                                            // RSSI Location Response command
    160          };
    161          
    162          /*********************************************************************
    163           * @fn          zclZEM_Init
    164           *
    165           * @brief       Initialization function for the zclGeneral layer.
    166           *
    167           * @param       none
    168           *
    169           * @return      none
    170           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    171          void zclZEM_Init( byte task_id )
   \                     zclZEM_Init:
    172          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000   74F6         MOV       A,#-0xa
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 29
   \   000005   74E3         MOV       A,#-0x1d
   \   000007   12....       LCALL     ?ALLOC_XSTACK8
   \   00000A   E9           MOV       A,R1
    173            zclZEM_TaskID = task_id;
   \   00000B   90....       MOV       DPTR,#zclZEM_TaskID
   \   00000E   F0           MOVX      @DPTR,A
    174          
    175            // Register the Simple Descriptor for this application
    176            bdb_RegisterSimpleDescriptor( &zclZEM_SimpleDesc ); 
   \   00000F                ; Setup parameters for call to function bdb_RegisterSimpleDescriptor
   \   00000F   7A..         MOV       R2,#zclZEM_SimpleDesc & 0xff
   \   000011   7B..         MOV       R3,#(zclZEM_SimpleDesc >> 8) & 0xff
   \   000013   12....       LCALL     `??bdb_RegisterSimpleDescriptor::?relay`; Banked call to: bdb_RegisterSimpleDescriptor
    177            
    178            // Register the ZCL General Cluster Library callback functions
    179            zclGeneral_RegisterCmdCallbacks( ZEM_ENDPOINT, &zclZEM_CmdCallbacks );
   \   000016                ; Setup parameters for call to function zclGeneral_RegisterCmdCallbacks
   \   000016   7A..         MOV       R2,#zclZEM_CmdCallbacks & 0xff
   \   000018   7B..         MOV       R3,#(zclZEM_CmdCallbacks >> 8) & 0xff
   \   00001A   7908         MOV       R1,#0x8
   \   00001C   12....       LCALL     `??zclGeneral_RegisterCmdCallbacks::?relay`; Banked call to: zclGeneral_RegisterCmdCallbacks
    180          
    181            // Register the application's attribute list
    182            zclZEM_ResetAttributesToDefaultValues();
   \   00001F                ; Setup parameters for call to function zclZEM_ResetAttributesToDefaultValues
   \   00001F   12....       LCALL     `??zclZEM_ResetAttributesToDefaultValues::?relay`; Banked call to: zclZEM_ResetAttributesToDefaultValues
    183            zcl_registerAttrList( ZEM_ENDPOINT, zclZEM_NumAttributes, zclZEM_Attrs );
   \   000022                ; Setup parameters for call to function zcl_registerAttrList
   \   000022   7C..         MOV       R4,#zclZEM_Attrs & 0xff
   \   000024   7D..         MOV       R5,#(zclZEM_Attrs >> 8) & 0xff
   \   000026   90....       MOV       DPTR,#zclZEM_NumAttributes
   \   000029   E4           CLR       A
   \   00002A   93           MOVC      A,@A+DPTR
   \   00002B   FA           MOV       R2,A
   \   00002C   7908         MOV       R1,#0x8
   \   00002E   12....       LCALL     `??zcl_registerAttrList::?relay`; Banked call to: zcl_registerAttrList
    184          
    185            // Register the Application to receive the unprocessed Foundation command/response messages
    186            zcl_registerForMsg( zclZEM_TaskID );
   \   000031                ; Setup parameters for call to function zcl_registerForMsg
   \   000031   90....       MOV       DPTR,#zclZEM_TaskID
   \   000034   E0           MOVX      A,@DPTR
   \   000035   F9           MOV       R1,A
   \   000036   12....       LCALL     `??zcl_registerForMsg::?relay`; Banked call to: zcl_registerForMsg
    187          
    188            // Register low voltage NV memory protection application callback
    189            RegisterVoltageWarningCB( zclSampleApp_BatteryWarningCB );
   \   000039                ; Setup parameters for call to function RegisterVoltageWarningCB
   \   000039   7A..         MOV       R2,#`??zclSampleApp_BatteryWarningCB::?relay` & 0xff
   \   00003B   7B..         MOV       R3,#(`??zclSampleApp_BatteryWarningCB::?relay` >> 8) & 0xff
   \   00003D   12....       LCALL     `??RegisterVoltageWarningCB::?relay`; Banked call to: RegisterVoltageWarningCB
    190          
    191            // Register for all key events - This app will handle all key events
    192            RegisterForKeys( zclZEM_TaskID );
   \   000040                ; Setup parameters for call to function RegisterForKeys
   \   000040   90....       MOV       DPTR,#zclZEM_TaskID
   \   000043   E0           MOVX      A,@DPTR
   \   000044   F9           MOV       R1,A
   \   000045   12....       LCALL     `??RegisterForKeys::?relay`; Banked call to: RegisterForKeys
    193          
    194            bdb_RegisterCommissioningStatusCB( zclZEM_ProcessCommissioningStatus );
   \   000048                ; Setup parameters for call to function bdb_RegisterCommissioningStatusCB
   \   000048   7A..         MOV       R2,#`??zclZEM_ProcessCommissioningStatus::?relay` & 0xff
   \   00004A   7B..         MOV       R3,#(`??zclZEM_ProcessCommissioningStatus::?relay` >> 8) & 0xff
   \   00004C   12....       LCALL     `??bdb_RegisterCommissioningStatusCB::?relay`; Banked call to: bdb_RegisterCommissioningStatusCB
    195          
    196          #ifdef ZDO_COORDINATOR
    197            bdb_StartCommissioning( BDB_COMMISSIONING_MODE_NWK_FORMATION |
    198                                    BDB_COMMISSIONING_MODE_FINDING_BINDING );
   \   00004F                ; Setup parameters for call to function bdb_StartCommissioning
   \   00004F   790C         MOV       R1,#0xc
   \   000051   12....       LCALL     `??bdb_StartCommissioning::?relay`; Banked call to: bdb_StartCommissioning
    199            NLME_PermitJoiningRequest(255);
   \   000054                ; Setup parameters for call to function NLME_PermitJoiningRequest
   \   000054   79FF         MOV       R1,#-0x1
   \   000056   12....       LCALL     `??NLME_PermitJoiningRequest::?relay`; Banked call to: NLME_PermitJoiningRequest
    200            // Broadcast
    201            osal_start_timerEx(zclZEM_TaskID,
    202                               ZEM_BROADCAST_EVT,
    203                               ZEM_BROADCAST_PERIOD);
   \   000059                ; Setup parameters for call to function osal_start_timerEx
   \   000059   90....       MOV       DPTR,#__Constant_3e8
   \   00005C   12....       LCALL     ?PUSH_XSTACK8_X_FOUR
   \   00005F   7A80         MOV       R2,#-0x80
   \   000061   7B00         MOV       R3,#0x0
   \   000063   90....       MOV       DPTR,#zclZEM_TaskID
   \   000066   E0           MOVX      A,@DPTR
   \   000067   F9           MOV       R1,A
   \   000068   12....       LCALL     `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   00006B   7404         MOV       A,#0x4
   \   00006D   12....       LCALL     ?DEALLOC_XSTACK8
    204            // groupcast
    205            osal_start_timerEx(zclZEM_TaskID,
    206                               ZEM_GROUPCAST_EVT,
    207                               ZEM_GROUPCAST_PERIOD);
   \   000070                ; Setup parameters for call to function osal_start_timerEx
   \   000070   90....       MOV       DPTR,#__Constant_3e8
   \   000073   12....       LCALL     ?PUSH_XSTACK8_X_FOUR
   \   000076   7A00         MOV       R2,#0x0
   \   000078   7B01         MOV       R3,#0x1
   \   00007A   90....       MOV       DPTR,#zclZEM_TaskID
   \   00007D   E0           MOVX      A,@DPTR
   \   00007E   F9           MOV       R1,A
   \   00007F   12....       LCALL     `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   000082   7404         MOV       A,#0x4
   \   000084   12....       LCALL     ?DEALLOC_XSTACK8
    208          #else
    209            bdb_StartCommissioning( BDB_COMMISSIONING_MODE_NWK_STEERING |
    210                                    BDB_COMMISSIONING_MODE_FINDING_BINDING );
    211            // Add group
    212            aps_Group_t group = {
    213              .ID = GROUP_ID,
    214              .name = "",
    215            };
    216            aps_AddGroup(ZEM_ENDPOINT, &group);
    217            // P2P
    218            osal_start_timerEx(zclZEM_TaskID,
    219                               ZEM_P2P_EVT,
    220                               ZEM_P2P_PERIOD);
    221          #endif
    222          
    223            // Initialize UART communication
    224            zclZEM_InitUart();
   \   000087   43F101       ORL       0xf1,#0x1
   \   00008A   43F430       ORL       0xf4,#0x30
   \   00008D   43FE10       ORL       0xfe,#0x10
   \   000090   53FEDF       ANL       0xfe,#0xdf
   \   000093   85..82       MOV       DPL,?XSP + 0
   \   000096   85..83       MOV       DPH,?XSP + 1
   \   000099   7401         MOV       A,#0x1
   \   00009B   F0           MOVX      @DPTR,A
   \   00009C   12....       LCALL     ?XSTACK_DISP0_8
   \   00009F   7404         MOV       A,#0x4
   \   0000A1   F0           MOVX      @DPTR,A
   \   0000A2   7402         MOV       A,#0x2
   \   0000A4   12....       LCALL     ?XSTACK_DISP0_8
   \   0000A7   E4           CLR       A
   \   0000A8   F0           MOVX      @DPTR,A
   \   0000A9   7403         MOV       A,#0x3
   \   0000AB   12....       LCALL     ?XSTACK_DISP0_8
   \   0000AE   E4           CLR       A
   \   0000AF   F0           MOVX      @DPTR,A
   \   0000B0   A3           INC       DPTR
   \   0000B1   F0           MOVX      @DPTR,A
   \   0000B2   740A         MOV       A,#0xa
   \   0000B4   12....       LCALL     ?XSTACK_DISP0_8
   \   0000B7   7440         MOV       A,#0x40
   \   0000B9   F0           MOVX      @DPTR,A
   \   0000BA   A3           INC       DPTR
   \   0000BB   E4           CLR       A
   \   0000BC   F0           MOVX      @DPTR,A
   \   0000BD   7412         MOV       A,#0x12
   \   0000BF   12....       LCALL     ?XSTACK_DISP0_8
   \   0000C2   E4           CLR       A
   \   0000C3   F0           MOVX      @DPTR,A
   \   0000C4   A3           INC       DPTR
   \   0000C5   F0           MOVX      @DPTR,A
   \   0000C6   7405         MOV       A,#0x5
   \   0000C8   12....       LCALL     ?XSTACK_DISP0_8
   \   0000CB   7406         MOV       A,#0x6
   \   0000CD   F0           MOVX      @DPTR,A
   \   0000CE   7416         MOV       A,#0x16
   \   0000D0   12....       LCALL     ?XSTACK_DISP0_8
   \   0000D3   7401         MOV       A,#0x1
   \   0000D5   F0           MOVX      @DPTR,A
   \   0000D6   741B         MOV       A,#0x1b
   \   0000D8   12....       LCALL     ?XSTACK_DISP0_8
   \   0000DB   74..         MOV       A,#`??zclZEM_UartCB::?relay` & 0xff
   \   0000DD   F0           MOVX      @DPTR,A
   \   0000DE   A3           INC       DPTR
   \   0000DF   74..         MOV       A,#(`??zclZEM_UartCB::?relay` >> 8) & 0xff
   \   0000E1   F0           MOVX      @DPTR,A
   \   0000E2                ; Setup parameters for call to function HalUARTOpen
   \   0000E2   AA..         MOV       R2,?XSP + 0
   \   0000E4   AB..         MOV       R3,?XSP + 1
   \   0000E6   7900         MOV       R1,#0x0
   \   0000E8   12....       LCALL     `??HalUARTOpen::?relay`; Banked call to: HalUARTOpen
    225            
    226            // Read and send MAC address
    227            zclZEM_ReadAndSendMAC();
   \   0000EB                ; Setup parameters for call to function zclZEM_ReadAndSendMAC
   \   0000EB   12....       LCALL     `??zclZEM_ReadAndSendMAC::?relay`; Banked call to: zclZEM_ReadAndSendMAC
    228          
    229          #ifdef BDB_REPORTING
    230            //Adds the default configuration values for the temperature attribute of the ZCL_CLUSTER_ID_MS_TEMPERATURE_MEASUREMENT cluster, for endpoint ZEM_ENDPOINT
    231            //Default maxReportingInterval value is 10 seconds
    232            //Default minReportingInterval value is 3 seconds
    233            //Default reportChange value is 300 (3 degrees)
    234            bdb_RepAddAttrCfgRecordDefaultToList(ZEM_ENDPOINT, ZCL_CLUSTER_ID_MS_TEMPERATURE_MEASUREMENT, ATTRID_MS_TEMPERATURE_MEASURED_VALUE, 0, 10, reportableChange);
   \   0000EE                ; Setup parameters for call to function bdb_RepAddAttrCfgRecordDefaultToList
   \   0000EE   75....       MOV       ?V0,#reportableChange & 0xff
   \   0000F1   75....       MOV       ?V1,#(reportableChange >> 8) & 0xff
   \   0000F4   78..         MOV       R0,#?V0
   \   0000F6   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000F9   75..0A       MOV       ?V0,#0xa
   \   0000FC   75..00       MOV       ?V1,#0x0
   \   0000FF   78..         MOV       R0,#?V0
   \   000101   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000104   E4           CLR       A
   \   000105   F5..         MOV       ?V0,A
   \   000107   78..         MOV       R0,#?V0
   \   000109   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   00010C   7C00         MOV       R4,#0x0
   \   00010E   7D00         MOV       R5,#0x0
   \   000110   7A02         MOV       R2,#0x2
   \   000112   7B04         MOV       R3,#0x4
   \   000114   7908         MOV       R1,#0x8
   \   000116   12....       LCALL     `??bdb_RepAddAttrCfgRecordDefaultToList::?relay`; Banked call to: bdb_RepAddAttrCfgRecordDefaultToList
   \   000119   7406         MOV       A,#0x6
   \   00011B   12....       LCALL     ?DEALLOC_XSTACK8
    235          #endif
    236            
    237            zdpExternalStateTaskID = zclZEM_TaskID;
   \   00011E   90....       MOV       DPTR,#zclZEM_TaskID
   \   000121   E0           MOVX      A,@DPTR
   \   000122   90....       MOV       DPTR,#zdpExternalStateTaskID
   \   000125   F0           MOVX      @DPTR,A
   \   000126   A3           INC       DPTR
   \   000127   E4           CLR       A
   \   000128   F0           MOVX      @DPTR,A
    238             osal_start_timerEx(
    239                zclZEM_TaskID,
    240                ZEMAPP_EVT,
    241                3000);
   \   000129                ; Setup parameters for call to function osal_start_timerEx
   \   000129   90....       MOV       DPTR,#__Constant_bb8
   \   00012C   12....       LCALL     ?PUSH_XSTACK8_X_FOUR
   \   00012F   7A80         MOV       R2,#-0x80
   \   000131   7B00         MOV       R3,#0x0
   \   000133   90....       MOV       DPTR,#zclZEM_TaskID
   \   000136   E0           MOVX      A,@DPTR
   \   000137   F9           MOV       R1,A
   \   000138   12....       LCALL     `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   00013B   7404         MOV       A,#0x4
   \   00013D   12....       LCALL     ?DEALLOC_XSTACK8
    242          }
   \   000140   741D         MOV       A,#0x1d
   \   000142   12....       LCALL     ?DEALLOC_XSTACK8
   \   000145   7F02         MOV       R7,#0x2
   \   000147   02....       LJMP      ?BANKED_LEAVE_XDATA
   \   00014A                REQUIRE PERCFG
   \   00014A                REQUIRE P1SEL
   \   00014A                REQUIRE P1DIR
    243          
    244          /*********************************************************************
    245           * @fn          zclSample_event_loop
    246           *
    247           * @brief       Event Loop Processor for zclGeneral.
    248           *
    249           * @param       none
    250           *
    251           * @return      none
    252           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    253          uint16 zclZEM_event_loop( uint8 task_id, uint16 events )
   \                     zclZEM_event_loop:
    254          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000   74F4         MOV       A,#-0xc
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 129
   \   000005   747F         MOV       A,#0x7f
   \   000007   12....       LCALL     ?ALLOC_XSTACK8
   \   00000A   EA           MOV       A,R2
   \   00000B   FE           MOV       R6,A
   \   00000C   EB           MOV       A,R3
   \   00000D   FF           MOV       R7,A
    255            afIncomingMSGPacket_t *MSGpkt;
    256          
    257            (void)task_id;  // Intentionally unreferenced parameter
    258          
    259            if ( events & SYS_EVENT_MSG )
   \   00000E   5480         ANL       A,#0x80
   \   000010   7075         JNZ       ??zclZEM_event_loop_0
    260            {
    261              while ( (MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( zclZEM_TaskID )) )
    262              {
    263                switch ( MSGpkt->hdr.event )
    264                {
    265                  case ZCL_INCOMING_MSG:
    266                    // Incoming ZCL Foundation command/response messages
    267                    zclZEM_ProcessIncomingMsg( (zclIncomingMsg_t *)MSGpkt );
    268                    break;
    269          
    270                  case AF_INCOMING_MSG_CMD:
    271                    // Incoming AF data messages
    272                    zclZEM_AF_RxProc( MSGpkt );
    273                    break;
    274          
    275                  case KEY_CHANGE:
    276                    zclZEM_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
    277                    break;
    278          
    279                  case ZDO_STATE_CHANGE:
    280                    // 处理网络状态变化
    281                    {
    282                      uint8 newState = ((uint8*)MSGpkt)[0];
    283                      zclZEM_NwkState = newState; // 更新网络状态
    284                      
    285                      if (newState == 5) // DEV_END_DEVICE
    286                      {
    287                        // 终端设备已加入网络
    288                        uint8 successMsg[] = "Network joined successfully!\r\n";
    289                        HalUARTWrite(HAL_UART_PORT_0, successMsg, sizeof(successMsg)-1);
    290                        
    291                        // 联网成功后向协调器发送MAC地址
    292                        #ifndef ZDO_COORDINATOR
    293                        zclZEM_SendMACToCoordinator();
    294                        #endif
    295                      }
    296                      else if (newState == 9) // DEV_NWK_ORPHAN
    297                      {
    298                        // 设备成为孤立设备
    299                        #ifndef ZDO_COORDINATOR
    300                        {
    301                          static uint8 retryCount = 0;
    302                          if (retryCount < 3)
    303                          {
    304                            retryCount++;
    305                            osal_start_timerEx(zclZEM_TaskID, ZEM_REJOIN_EVT, 2000);
    306                          }
    307                        }
    308                        #endif
    309                      }
    310                    }
    311                    break;
    312          
    313                  default:
    314                    break;
    315                }
    316          
    317                // Release the memory
    318                osal_msg_deallocate( (uint8 *)MSGpkt );
    319              }
    320          
    321              // return unprocessed events
    322              return (events ^ SYS_EVENT_MSG);
    323            }
    324          
    325            // 先处理LED闪烁事件，确保不会被SYS_EVENT_MSG阻塞
    326            if(events & ZEMAPP_EVT)
   \   000012   EE           MOV       A,R6
   \   000013   5480         ANL       A,#0x80
   \   000015   7003         JNZ       $+5
   \   000017   02....       LJMP      ??zclZEM_event_loop_1 & 0xFFFF
    327            {
    328              uint8 debugMsg[] = "ZEMAPP_EVT事件触发，开始LED闪烁...\r\n";
   \   00001A   90....       MOV       DPTR,#`?<Constant "ZEMAPP_EVT\\344\\272\\213\\344\\273\\266`
   \   00001D   7453         MOV       A,#0x53
   \   00001F   12....       LCALL     ?XSTACK_DISP102_8
   \   000022   742E         MOV       A,#0x2e
   \   000024   12....       LCALL     ?MOVE_LONG8_XDATA_XDATA
    329              HalUARTWrite(HAL_UART_PORT_0, debugMsg, sizeof(debugMsg)-1);
   \   000027                ; Setup parameters for call to function HalUARTWrite
   \   000027   7C2D         MOV       R4,#0x2d
   \   000029   FD           MOV       R5,A
   \   00002A   7453         MOV       A,#0x53
   \   00002C   12....       LCALL     ?XSTACK_DISP101_8
   \   00002F   7900         MOV       R1,#0x0
   \   000031   12....       LCALL     `??HalUARTWrite::?relay`; Banked call to: HalUARTWrite
    330              
    331              HalLedBlink(
    332                  HAL_LED_1, // 指定使用LED1
    333                  10, // 指定闪烁次数为10次
    334                  50, // 指定50%的时间LED处于点亮状态
    335                  1000); // 指定每次闪烁周期为1000ms
   \   000034                ; Setup parameters for call to function HalLedBlink
   \   000034   7CE8         MOV       R4,#-0x18
   \   000036   7D03         MOV       R5,#0x3
   \   000038   7B32         MOV       R3,#0x32
   \   00003A   7A0A         MOV       R2,#0xa
   \   00003C   7901         MOV       R1,#0x1
   \   00003E   12....       LCALL     `??HalLedBlink::?relay`; Banked call to: HalLedBlink
    336                  
    337              uint8 debugMsg2[] = "LED闪烁命令已发送，设置下一次定时器...\r\n";
   \   000041   90....       MOV       DPTR,#`?<Constant "LED\\351\\227\\252\\347\\203\\201\\345\\22`
   \   000044   741A         MOV       A,#0x1a
   \   000046   12....       LCALL     ?XSTACK_DISP102_8
   \   000049   7439         MOV       A,#0x39
   \   00004B   12....       LCALL     ?MOVE_LONG8_XDATA_XDATA
    338              HalUARTWrite(HAL_UART_PORT_0, debugMsg2, sizeof(debugMsg2)-1);
   \   00004E                ; Setup parameters for call to function HalUARTWrite
   \   00004E   7C38         MOV       R4,#0x38
   \   000050   FD           MOV       R5,A
   \   000051   741A         MOV       A,#0x1a
   \   000053   12....       LCALL     ?XSTACK_DISP101_8
   \   000056   7900         MOV       R1,#0x0
   \   000058   12....       LCALL     `??HalUARTWrite::?relay`; Banked call to: HalUARTWrite
    339              
    340              // 设置下一次LED闪烁定时器
    341              osal_start_timerEx(zclZEM_TaskID, ZEMAPP_EVT, 10000);
   \   00005B                ; Setup parameters for call to function osal_start_timerEx
   \   00005B   90....       MOV       DPTR,#__Constant_2710
   \   00005E   12....       LCALL     ?PUSH_XSTACK8_X_FOUR
   \   000061   7A80         MOV       R2,#-0x80
   \   000063   7B00         MOV       R3,#0x0
   \   000065   90....       MOV       DPTR,#zclZEM_TaskID
   \   000068   E0           MOVX      A,@DPTR
   \   000069   F9           MOV       R1,A
   \   00006A   12....       LCALL     `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   00006D   7404         MOV       A,#0x4
   \   00006F   12....       LCALL     ?DEALLOC_XSTACK8
    342              
    343              return (events ^ ZEMAPP_EVT);
   \   000072   EE           MOV       A,R6
   \   000073   6480         XRL       A,#0x80
   \   000075   FA           MOV       R2,A
   \   000076   EF           MOV       A,R7
   \   000077   02....       LJMP      ??zclZEM_event_loop_2 & 0xFFFF
    344            }
   \                     ??zclZEM_event_loop_3:
   \   00007A   90....       MOV       DPTR,#zclZEM_NwkState
   \   00007D   74D1         MOV       A,#-0x2f
   \   00007F   F0           MOVX      @DPTR,A
   \                     ??zclZEM_event_loop_4:
   \   000080                ; Setup parameters for call to function osal_msg_deallocate
   \   000080   AA..         MOV       R2,?V0
   \   000082   AB..         MOV       R3,?V1
   \   000084   12....       LCALL     `??osal_msg_deallocate::?relay`; Banked call to: osal_msg_deallocate
   \                     ??zclZEM_event_loop_0:
   \   000087                ; Setup parameters for call to function osal_msg_receive
   \   000087   90....       MOV       DPTR,#zclZEM_TaskID
   \   00008A   E0           MOVX      A,@DPTR
   \   00008B   F9           MOV       R1,A
   \   00008C   12....       LCALL     `??osal_msg_receive::?relay`; Banked call to: osal_msg_receive
   \   00008F   8A..         MOV       ?V0,R2
   \   000091   8B..         MOV       ?V1,R3
   \   000093   EA           MOV       A,R2
   \   000094   45..         ORL       A,?V1
   \   000096   601D         JZ        ??zclZEM_event_loop_5
   \   000098   8A82         MOV       DPL,R2
   \   00009A   8B83         MOV       DPH,R3
   \   00009C   E0           MOVX      A,@DPTR
   \   00009D   24E6         ADD       A,#-0x1a
   \   00009F   600F         JZ        ??zclZEM_event_loop_6
   \   0000A1   24E6         ADD       A,#-0x1a
   \   0000A3   6006         JZ        ??zclZEM_event_loop_7
   \   0000A5   2463         ADD       A,#0x63
   \   0000A7   60D1         JZ        ??zclZEM_event_loop_3
   \   0000A9   80D5         SJMP      ??zclZEM_event_loop_4
   \                     ??zclZEM_event_loop_7:
   \   0000AB                ; Setup parameters for call to function zclZEM_ProcessIncomingMsg
   \   0000AB   12....       LCALL     `??zclZEM_ProcessIncomingMsg::?relay`; Banked call to: zclZEM_ProcessIncomingMsg
   \   0000AE   80D0         SJMP      ??zclZEM_event_loop_4
   \                     ??zclZEM_event_loop_6:
   \   0000B0                ; Setup parameters for call to function zclZEM_AF_RxProc
   \   0000B0   12....       LCALL     `??zclZEM_AF_RxProc::?relay`; Banked call to: zclZEM_AF_RxProc
   \   0000B3   80CB         SJMP      ??zclZEM_event_loop_4
   \                     ??zclZEM_event_loop_5:
   \   0000B5   EE           MOV       A,R6
   \   0000B6   FA           MOV       R2,A
   \   0000B7   EF           MOV       A,R7
   \   0000B8   6480         XRL       A,#0x80
   \   0000BA   02....       LJMP      ??zclZEM_event_loop_2 & 0xFFFF
    345            
    346          #if ZG_BUILD_ENDDEVICE_TYPE    
    347            if ( events & ZEM_END_DEVICE_REJOIN_EVT )
    348            {
    349              bdb_ZedAttemptRecoverNwk();
    350              return ( events ^ ZEM_END_DEVICE_REJOIN_EVT );
    351            }
    352          #endif
    353          
    354            if ( events & ZEM_LCD_AUTO_UPDATE_EVT )
   \                     ??zclZEM_event_loop_1:
   \   0000BD   EE           MOV       A,R6
   \   0000BE   5410         ANL       A,#0x10
   \   0000C0   6005         JZ        ??zclZEM_event_loop_8
    355            {
    356              return ( events ^ ZEM_LCD_AUTO_UPDATE_EVT );
   \   0000C2   EE           MOV       A,R6
   \   0000C3   6410         XRL       A,#0x10
   \   0000C5   8008         SJMP      ??zclZEM_event_loop_9
    357            }
    358          
    359            if ( events & ZEM_KEY_AUTO_REPEAT_EVT )
   \                     ??zclZEM_event_loop_8:
   \   0000C7   EE           MOV       A,R6
   \   0000C8   5420         ANL       A,#0x20
   \   0000CA   6007         JZ        ??zclZEM_event_loop_10
    360            {
    361              return ( events ^ ZEM_KEY_AUTO_REPEAT_EVT );
   \   0000CC   EE           MOV       A,R6
   \   0000CD   6420         XRL       A,#0x20
   \                     ??zclZEM_event_loop_9:
   \   0000CF   FA           MOV       R2,A
   \   0000D0   02....       LJMP      ??zclZEM_event_loop_11 & 0xFFFF
    362            }
    363            
    364            // Broadcast event
    365            if ( events & ZEM_BROADCAST_EVT )
    366            {
    367              uint8 broadcastData[] = "Broadcast";
    368              zclZEM_AF_Broadcast(CLUSTER_BROADCAST, 
    369                                  sizeof(broadcastData)-1, 
    370                                  broadcastData);
    371              osal_start_timerEx(zclZEM_TaskID,
    372                                ZEM_BROADCAST_EVT,
    373                                ZEM_BROADCAST_PERIOD);
    374              return ( events ^ ZEM_BROADCAST_EVT );
    375            }
    376            
    377            // Groupcast event
    378            if ( events & ZEM_GROUPCAST_EVT )
   \                     ??zclZEM_event_loop_10:
   \   0000D3   EF           MOV       A,R7
   \   0000D4   5401         ANL       A,#0x1
   \   0000D6   7003         JNZ       $+5
   \   0000D8   02....       LJMP      ??zclZEM_event_loop_12 & 0xFFFF
    379            {
    380              uint8 groupcastData[] = "Groupcast";
   \   0000DB   90....       MOV       DPTR,#`?<Constant "Groupcast">`
   \   0000DE   7410         MOV       A,#0x10
   \   0000E0   12....       LCALL     ?XSTACK_DISP102_8
   \   0000E3   740A         MOV       A,#0xa
   \   0000E5   12....       LCALL     ?MOVE_LONG8_XDATA_XDATA
    381              zclZEM_AF_Groupcast(GROUP_ID,
    382                                  CLUSTER_GROUPCAST,
    383                                  sizeof(groupcastData)-1, 
    384                                  groupcastData);
   \   0000E8   7408         MOV       A,#0x8
   \   0000EA   12....       LCALL     ?XSTACK_DISP0_8
   \   0000ED   7401         MOV       A,#0x1
   \   0000EF   F0           MOVX      @DPTR,A
   \   0000F0   85..82       MOV       DPL,?XSP + 0
   \   0000F3   85..83       MOV       DPH,?XSP + 1
   \   0000F6   7415         MOV       A,#0x15
   \   0000F8   F0           MOVX      @DPTR,A
   \   0000F9   A3           INC       DPTR
   \   0000FA   E4           CLR       A
   \   0000FB   F0           MOVX      @DPTR,A
   \   0000FC   7409         MOV       A,#0x9
   \   0000FE   12....       LCALL     ?XSTACK_DISP0_8
   \   000101   7408         MOV       A,#0x8
   \   000103   F0           MOVX      @DPTR,A
   \   000104   90....       MOV       DPTR,#??transferId_2
   \   000107   12....       LCALL     ?Subroutine9 & 0xFFFF
   \                     ??CrossCallReturnLabel_7:
   \   00010A   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   00010D   75....       MOV       ?V0,#??transferId_2 & 0xff
   \   000110   75....       MOV       ?V1,#(??transferId_2 >> 8) & 0xff
   \   000113   78..         MOV       R0,#?V0
   \   000115   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000118   7413         MOV       A,#0x13
   \   00011A   12....       LCALL     ?XSTACK_DISP100_8
   \   00011D   88..         MOV       ?V0,R0
   \   00011F   89..         MOV       ?V1,R1
   \   000121   78..         MOV       R0,#?V0
   \   000123   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000126   75..09       MOV       ?V0,#0x9
   \   000129   75..00       MOV       ?V1,#0x0
   \   00012C   78..         MOV       R0,#?V0
   \   00012E   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000131   75..02       MOV       ?V0,#0x2
   \   000134   78..         MOV       R0,#?V0
   \   000136   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000139   7900         MOV       R1,#0x0
   \   00013B   7C..         MOV       R4,#ZEM_AppEp & 0xff
   \   00013D   7D..         MOV       R5,#(ZEM_AppEp >> 8) & 0xff
   \   00013F   7409         MOV       A,#0x9
   \   000141   12....       LCALL     ?XSTACK_DISP101_8
   \   000144   12....       LCALL     `??AF_DataRequest::?relay`; Banked call to: AF_DataRequest
   \   000147   7409         MOV       A,#0x9
   \   000149   12....       LCALL     ?DEALLOC_XSTACK8
    385              osal_start_timerEx(zclZEM_TaskID,
    386                                ZEM_GROUPCAST_EVT,
    387                                ZEM_GROUPCAST_PERIOD);
   \   00014C                ; Setup parameters for call to function osal_start_timerEx
   \   00014C   90....       MOV       DPTR,#__Constant_3e8
   \   00014F   12....       LCALL     ?PUSH_XSTACK8_X_FOUR
   \   000152   7A00         MOV       R2,#0x0
   \   000154   7B01         MOV       R3,#0x1
   \   000156   90....       MOV       DPTR,#zclZEM_TaskID
   \   000159   E0           MOVX      A,@DPTR
   \   00015A   F9           MOV       R1,A
   \   00015B   12....       LCALL     `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   00015E   7404         MOV       A,#0x4
   \   000160   12....       LCALL     ?DEALLOC_XSTACK8
    388              return ( events ^ ZEM_GROUPCAST_EVT );
   \   000163   EE           MOV       A,R6
   \   000164   FA           MOV       R2,A
   \   000165   EF           MOV       A,R7
   \   000166   6401         XRL       A,#0x1
   \   000168   02....       LJMP      ??zclZEM_event_loop_2 & 0xFFFF
    389            }
    390            
    391            // P2P event
    392            if ( events & ZEM_P2P_EVT )
   \                     ??zclZEM_event_loop_12:
   \   00016B   EF           MOV       A,R7
   \   00016C   5402         ANL       A,#0x2
   \   00016E   7003         JNZ       $+5
   \   000170   02....       LJMP      ??zclZEM_event_loop_13 & 0xFFFF
    393            {
    394              uint8 p2pData[] = "P2P";
   \   000173   90....       MOV       DPTR,#`?<Constant "P2P">`
   \   000176   740C         MOV       A,#0xc
   \   000178   12....       LCALL     ?XSTACK_DISP102_8
   \   00017B   7404         MOV       A,#0x4
   \   00017D   12....       LCALL     ?MOVE_LONG8_XDATA_XDATA
    395              zclZEM_AF_P2P(0x0000, // 目标设备网络地址（这里使用0x0000作为示例）
    396                            CLUSTER_P2P,
    397                            sizeof(p2pData)-1, 
    398                            p2pData);
   \   000180   7408         MOV       A,#0x8
   \   000182   12....       LCALL     ?XSTACK_DISP0_8
   \   000185   7402         MOV       A,#0x2
   \   000187   F0           MOVX      @DPTR,A
   \   000188   85..82       MOV       DPL,?XSP + 0
   \   00018B   85..83       MOV       DPH,?XSP + 1
   \   00018E   E4           CLR       A
   \   00018F   F0           MOVX      @DPTR,A
   \   000190   A3           INC       DPTR
   \   000191   F0           MOVX      @DPTR,A
   \   000192   7409         MOV       A,#0x9
   \   000194   12....       LCALL     ?XSTACK_DISP0_8
   \   000197   7408         MOV       A,#0x8
   \   000199   F0           MOVX      @DPTR,A
   \   00019A   90....       MOV       DPTR,#??transferId
   \   00019D   12....       LCALL     ?Subroutine9 & 0xFFFF
   \                     ??CrossCallReturnLabel_8:
   \   0001A0   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   0001A3   75....       MOV       ?V0,#??transferId & 0xff
   \   0001A6   75....       MOV       ?V1,#(??transferId >> 8) & 0xff
   \   0001A9   78..         MOV       R0,#?V0
   \   0001AB   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0001AE   740F         MOV       A,#0xf
   \   0001B0   12....       LCALL     ?XSTACK_DISP100_8
   \   0001B3   88..         MOV       ?V0,R0
   \   0001B5   89..         MOV       ?V1,R1
   \   0001B7   78..         MOV       R0,#?V0
   \   0001B9   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0001BC   75..03       MOV       ?V0,#0x3
   \   0001BF   75..00       MOV       ?V1,#0x0
   \   0001C2   78..         MOV       R0,#?V0
   \   0001C4   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0001C7   E4           CLR       A
   \   0001C8   F5..         MOV       ?V0,A
   \   0001CA   78..         MOV       R0,#?V0
   \   0001CC   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0001CF   7900         MOV       R1,#0x0
   \   0001D1   7C..         MOV       R4,#ZEM_AppEp & 0xff
   \   0001D3   7D..         MOV       R5,#(ZEM_AppEp >> 8) & 0xff
   \   0001D5   7409         MOV       A,#0x9
   \   0001D7   12....       LCALL     ?XSTACK_DISP101_8
   \   0001DA   12....       LCALL     `??AF_DataRequest::?relay`; Banked call to: AF_DataRequest
   \   0001DD   7409         MOV       A,#0x9
   \   0001DF   12....       LCALL     ?DEALLOC_XSTACK8
    399              osal_start_timerEx(zclZEM_TaskID,
    400                                ZEM_P2P_EVT,
    401                                ZEM_P2P_PERIOD);
   \   0001E2                ; Setup parameters for call to function osal_start_timerEx
   \   0001E2   90....       MOV       DPTR,#__Constant_3e8
   \   0001E5   12....       LCALL     ?PUSH_XSTACK8_X_FOUR
   \   0001E8   7A00         MOV       R2,#0x0
   \   0001EA   7B02         MOV       R3,#0x2
   \   0001EC   90....       MOV       DPTR,#zclZEM_TaskID
   \   0001EF   E0           MOVX      A,@DPTR
   \   0001F0   F9           MOV       R1,A
   \   0001F1   12....       LCALL     `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   0001F4   7404         MOV       A,#0x4
   \   0001F6   12....       LCALL     ?DEALLOC_XSTACK8
    402              return ( events ^ ZEM_P2P_EVT );
   \   0001F9   EE           MOV       A,R6
   \   0001FA   FA           MOV       R2,A
   \   0001FB   EF           MOV       A,R7
   \   0001FC   6402         XRL       A,#0x2
   \                     ??zclZEM_event_loop_2:
   \   0001FE   FB           MOV       R3,A
   \   0001FF   8004         SJMP      ??zclZEM_event_loop_11
    403            }
    404            #ifdef ZDO_COORDINATOR
    405              if ( events & ZEM_RETRY_FORMATION_EVT )//如果事件类型为重试网络形成事件
    406              {
    407                  // 重试网络形成，并打印失败信息
    408                  uint8 failMsg[] = "Network formation failed! Retrying...\r\n";
    409                  HalUARTWrite(HAL_UART_PORT_0, failMsg, sizeof(failMsg)-1);
    410                  
    411                  /* 重试网络形成 */
    412                  bdb_StartCommissioning(BDB_COMMISSIONING_MODE_NWK_FORMATION |
    413                                              BDB_COMMISSIONING_MODE_FINDING_BINDING );
    414                  
    415                  // 无论成功与否，5秒后再次重试 - 实现真正的无限重试
    416                  osal_start_timerEx(zclZEM_TaskID, ZEM_RETRY_FORMATION_EVT, 5000);
    417                  
    418                return ( events ^ ZEM_RETRY_FORMATION_EVT );
    419              }
    420            #else
    421              if ( events & ZEM_REJOIN_EVT )//如果事件类型为重新加入网络事件
    422              {
    423                  // 重新加入网络
    424                  
    425                  /* 重新加入网络 */
    426                  bdb_StartCommissioning(BDB_COMMISSIONING_MODE_NWK_STEERING |
    427                                              BDB_COMMISSIONING_MODE_FINDING_BINDING );
    428                return ( events ^ ZEM_REJOIN_EVT );
    429              }
    430            #endif
    431          
    432            // Discard unknown events
    433            return 0;
   \                     ??zclZEM_event_loop_13:
   \   000201   7A00         MOV       R2,#0x0
   \   000203   7B00         MOV       R3,#0x0
   \                     ??zclZEM_event_loop_11:
   \   000205   7481         MOV       A,#-0x7f
   \   000207                REQUIRE ?Subroutine0
   \   000207                ; // Fall through to label ?Subroutine0
    434          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   12....       LCALL     ?DEALLOC_XSTACK8
   \   000003   7F04         MOV       R7,#0x4
   \   000005   02....       LJMP      ?BANKED_LEAVE_XDATA
    435          
    436          /*********************************************************************
    437           * @fn      zclZEM_InitUart
    438           *
    439           * @brief   Initialize UART for communication
    440           *
    441           * @param   none
    442           *
    443           * @return  none
    444           */
    445          static void zclZEM_InitUart(void)
    446          {
    447            // 统一使用协调器的UART引脚配置（P1.4/P1.5）
    448            /********** 1. 配置UART0的P1.4/P1.5和PERCFG寄存器 **********/
    449            // PERCFG的bit0(U0CFG)设置为1：UART0映射到Alternative 2位置(P1.4/P1.5)
    450            PERCFG |= (1 << 0);  // 配置PERCFG |= 0x01来设置相应的bit0
    451          
    452            /********** 2. 配置P1.4/P1.5为UART0功能和P1端口寄存器 **********/
    453            // P1SEL的bit4(P1.4)和bit5(P1.5)设置为1：配置为外设功能(UART)
    454            P1SEL |= (1 << 4) | (1 << 5);  // 配置P1SEL |= 0x30(00110000)
    455            // P1DIR的bit4(P1.4=TX)设置为1：输出；bit5(P1.5=RX)设置为0：输入
    456            P1DIR |= (1 << 4);   // P1.4(TX)作为输出
    457            P1DIR &= ~(1 << 5);  // P1.5(RX)作为输入
    458          
    459            halUARTCfg_t uartConfig;
    460            /* UART Configuration */
    461            uartConfig.configured          = TRUE;      // Enable configuration
    462            uartConfig.baudRate            = HAL_UART_BR_115200;  // Baud rate
    463            uartConfig.flowControl         = FALSE;     // Disable hardware flow control
    464            uartConfig.flowControlThreshold= 0;         // Flow control threshold
    465            uartConfig.rx.maxBufSize       = ZCLZEM_UART_BUF_LEN;  // Receive buffer size
    466            uartConfig.tx.maxBufSize       = 0;         // Transmit buffer size
    467            uartConfig.idleTimeout         = 6;         // Default timeout
    468            uartConfig.intEnable           = TRUE;      // Enable interrupt
    469            uartConfig.callBackFunc        = zclZEM_UartCB;  // Set callback function
    470            /* Start UART */
    471            // 统一使用UART0端口（协调器配置）
    472            HalUARTOpen(HAL_UART_PORT_0, &uartConfig);  // Open UART0 with configuration
    473          }
    474          
    475          
    476          void zclZEM_SendMACToCoordinator(void)
                      ^
Warning[Pe177]: function "zclZEM_SendMACToCoordinator" was declared but never
          referenced
    477          {
    478            uint8* macAddr;
    479            uint8 macData[10]; // MAC地址数据包：1字节类型标识 + 8字节MAC地址 + 1字节结束符
    480            
    481            // 读取MAC地址
    482            macAddr = NLME_GetExtAddr();
    483            
    484            // 构建数据包
    485            macData[0] = 0x01; // 类型标识：MAC地址数据
    486            osal_memcpy(&macData[1], macAddr, 8); // 复制MAC地址
    487            macData[9] = 0x00; // 结束符
    488            
    489            // 向协调器发送数据（协调器网络地址通常为0x0000）
    490            zclZEM_AF_P2P(0x0000, // 协调器网络地址
    491                          CLUSTER_P2P, // 使用点对点集群
    492                          10, // 数据长度
    493                          macData); // 数据内容
    494            
    495            // 同时通过串口显示发送信息
    496            uint8 sendMsg[] = "MAC address sent to coordinator!\r\n";
    497            HalUARTWrite(HAL_UART_PORT_0, sendMsg, sizeof(sendMsg)-1);
    498          }
    499          
    500          /*********************************************************************
    501           * @fn      zclZEM_ReadAndSendMAC
    502           *
    503           * @brief   Read MAC address and send it via UART
    504           *
    505           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    506          void zclZEM_ReadAndSendMAC(void)
   \                     zclZEM_ReadAndSendMAC:
    507          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000   74F4         MOV       A,#-0xc
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 56
   \   000005   74C8         MOV       A,#-0x38
   \   000007   12....       LCALL     ?ALLOC_XSTACK8
    508            uint8* macAddr;
    509            uint8 macStr[50]; // 足够存储MAC地址字符串
    510            uint8 i, pos = 0;
    511            
    512            // Read MAC address from system
    513            macAddr = NLME_GetExtAddr();
   \   00000A                ; Setup parameters for call to function NLME_GetExtAddr
   \   00000A   12....       LCALL     `??NLME_GetExtAddr::?relay`; Banked call to: NLME_GetExtAddr
   \   00000D   8A..         MOV       ?V0,R2
   \   00000F   8B..         MOV       ?V1,R3
   \   000011   AE..         MOV       R6,?V0
   \   000013   AF..         MOV       R7,?V1
    514            
    515            // 手动构建MAC地址字符串
    516            const uint8 header[] = "MAC: ";
   \   000015   90....       MOV       DPTR,#`?<Constant "MAC: ">`
   \   000018   AC..         MOV       R4,?XSP + 0
   \   00001A   AD..         MOV       R5,?XSP + 1
   \   00001C   7406         MOV       A,#0x6
   \   00001E   12....       LCALL     ?MOVE_LONG8_XDATA_XDATA
    517            osal_memcpy(macStr, header, 4);
   \   000021                ; Setup parameters for call to function osal_memcpy
   \   000021   A8..         MOV       R0,?XSP + 0
   \   000023   A9..         MOV       R1,?XSP + 1
   \   000025   88..         MOV       ?V0,R0
   \   000027   89..         MOV       ?V1,R1
   \   000029   F5..         MOV       ?V2,A
   \   00002B   78..         MOV       R0,#?V0
   \   00002D   12....       LCALL     ?PUSH_XSTACK_I_THREE
   \   000030   7C04         MOV       R4,#0x4
   \   000032   7D00         MOV       R5,#0x0
   \   000034   7409         MOV       A,#0x9
   \   000036   12....       LCALL     ?XSTACK_DISP101_8
   \   000039   12....       LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   00003C   7403         MOV       A,#0x3
   \   00003E   12....       LCALL     ?DEALLOC_XSTACK8
    518            pos = 4;
   \   000041   7804         MOV       R0,#0x4
    519            
    520            // 添加MAC地址字节，格式化为十六进制
    521            for (i = 0; i < 8; i++) {
   \   000043   7C00         MOV       R4,#0x0
    522              // 转换高4位
    523              uint8 highNibble = (macAddr[i] >> 4) & 0x0F;
   \                     ??zclZEM_ReadAndSendMAC_0:
   \   000045   EC           MOV       A,R4
   \   000046   FA           MOV       R2,A
   \   000047   EE           MOV       A,R6
   \   000048   2A           ADD       A,R2
   \   000049   FA           MOV       R2,A
   \   00004A   E4           CLR       A
   \   00004B   3F           ADDC      A,R7
   \   00004C   FB           MOV       R3,A
   \   00004D   8A82         MOV       DPL,R2
   \   00004F   8B83         MOV       DPH,R3
   \   000051   E0           MOVX      A,@DPTR
   \   000052   C4           SWAP      A
   \   000053   540F         ANL       A,#0xf
   \   000055   F9           MOV       R1,A
    524              macStr[pos++] = (highNibble < 10) ? ('0' + highNibble) : ('A' + highNibble - 10);
   \   000056   88..         MOV       ?V0,R0
   \   000058   7401         MOV       A,#0x1
   \   00005A   28           ADD       A,R0
   \   00005B   F8           MOV       R0,A
   \   00005C   E9           MOV       A,R1
   \   00005D   C3           CLR       C
   \   00005E   940A         SUBB      A,#0xa
   \   000060   5004         JNC       ??zclZEM_ReadAndSendMAC_1
   \   000062   7430         MOV       A,#0x30
   \   000064   8002         SJMP      ??zclZEM_ReadAndSendMAC_2
   \                     ??zclZEM_ReadAndSendMAC_1:
   \   000066   7437         MOV       A,#0x37
   \                     ??zclZEM_ReadAndSendMAC_2:
   \   000068   29           ADD       A,R1
   \   000069   C0E0         PUSH      A
   \   00006B   E5..         MOV       A,?V0
   \   00006D   F5..         MOV       ?V2,A
   \   00006F   7406         MOV       A,#0x6
   \   000071   12....       LCALL     ?XSTACK_DISP0_8
   \   000074   E582         MOV       A,DPL
   \   000076   25..         ADD       A,?V2
   \   000078   F582         MOV       DPL,A
   \   00007A   E4           CLR       A
   \   00007B   3583         ADDC      A,DPH
   \   00007D   F583         MOV       DPH,A
   \   00007F   D0E0         POP       A
   \   000081   F0           MOVX      @DPTR,A
    525              
    526              // 转换低4位
    527              uint8 lowNibble = macAddr[i] & 0x0F;
   \   000082   8A82         MOV       DPL,R2
   \   000084   8B83         MOV       DPH,R3
   \   000086   E0           MOVX      A,@DPTR
   \   000087   540F         ANL       A,#0xf
   \   000089   F9           MOV       R1,A
    528              macStr[pos++] = (lowNibble < 10) ? ('0' + lowNibble) : ('A' + lowNibble - 10);
   \   00008A   88..         MOV       ?V1,R0
   \   00008C   7401         MOV       A,#0x1
   \   00008E   28           ADD       A,R0
   \   00008F   F8           MOV       R0,A
   \   000090   E9           MOV       A,R1
   \   000091   C3           CLR       C
   \   000092   940A         SUBB      A,#0xa
   \   000094   5004         JNC       ??zclZEM_ReadAndSendMAC_3
   \   000096   7430         MOV       A,#0x30
   \   000098   8002         SJMP      ??zclZEM_ReadAndSendMAC_4
   \                     ??zclZEM_ReadAndSendMAC_3:
   \   00009A   7437         MOV       A,#0x37
   \                     ??zclZEM_ReadAndSendMAC_4:
   \   00009C   29           ADD       A,R1
   \   00009D   F9           MOV       R1,A
   \   00009E   AA..         MOV       R2,?V1
   \   0000A0   7406         MOV       A,#0x6
   \   0000A2   12....       LCALL     ?XSTACK_DISP0_8
   \   0000A5   12....       LCALL     ?Subroutine10 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   0000A8   E9           MOV       A,R1
   \   0000A9   F0           MOVX      @DPTR,A
    529              
    530              // 添加冒号分隔符（最后一个字节后不加）
    531              if (i < 7) {
   \   0000AA   EC           MOV       A,R4
   \   0000AB   C3           CLR       C
   \   0000AC   9407         SUBB      A,#0x7
   \   0000AE   500C         JNC       ??zclZEM_ReadAndSendMAC_5
    532                macStr[pos++] = ':';
   \   0000B0   7406         MOV       A,#0x6
   \   0000B2   12....       LCALL     ?XSTACK_DISP0_8
   \   0000B5   12....       LCALL     ?Subroutine11 & 0xFFFF
    533              }
    534            }
   \                     ??CrossCallReturnLabel_11:
   \   0000B8   743A         MOV       A,#0x3a
   \   0000BA   F0           MOVX      @DPTR,A
   \   0000BB   08           INC       R0
   \                     ??zclZEM_ReadAndSendMAC_5:
   \   0000BC   0C           INC       R4
   \   0000BD   EC           MOV       A,R4
   \   0000BE   C3           CLR       C
   \   0000BF   9408         SUBB      A,#0x8
   \   0000C1   4082         JC        ??zclZEM_ReadAndSendMAC_0
    535            
    536            // 添加换行符
    537            macStr[pos++] = '\r';
   \   0000C3   E8           MOV       A,R0
   \   0000C4   FA           MOV       R2,A
   \   0000C5   7406         MOV       A,#0x6
   \   0000C7   12....       LCALL     ?XSTACK_DISP0_8
   \   0000CA   12....       LCALL     ?Subroutine10 & 0xFFFF
   \                     ??CrossCallReturnLabel_10:
   \   0000CD   740D         MOV       A,#0xd
   \   0000CF   F0           MOVX      @DPTR,A
   \   0000D0   08           INC       R0
    538            macStr[pos++] = '\n';
   \   0000D1   7406         MOV       A,#0x6
   \   0000D3   12....       LCALL     ?XSTACK_DISP0_8
   \   0000D6   12....       LCALL     ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_12:
   \   0000D9   740A         MOV       A,#0xa
   \   0000DB   F0           MOVX      @DPTR,A
    539            
    540            // Send MAC address via UART
    541            // 统一使用UART0端口（协调器配置）
    542            HalUARTWrite(HAL_UART_PORT_0, macStr, pos);
   \   0000DC                ; Setup parameters for call to function HalUARTWrite
   \   0000DC   7401         MOV       A,#0x1
   \   0000DE   28           ADD       A,R0
   \   0000DF   FC           MOV       R4,A
   \   0000E0   7D00         MOV       R5,#0x0
   \   0000E2   7406         MOV       A,#0x6
   \   0000E4   12....       LCALL     ?XSTACK_DISP101_8
   \   0000E7   7900         MOV       R1,#0x0
   \   0000E9   12....       LCALL     `??HalUARTWrite::?relay`; Banked call to: HalUARTWrite
    543          }
   \   0000EC   7438         MOV       A,#0x38
   \   0000EE   02....       LJMP      ?Subroutine0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   E582         MOV       A,DPL
   \   000002   28           ADD       A,R0
   \   000003   F582         MOV       DPL,A
   \   000005   E4           CLR       A
   \   000006   3583         ADDC      A,DPH
   \   000008   F583         MOV       DPH,A
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   E582         MOV       A,DPL
   \   000002   2A           ADD       A,R2
   \   000003   F582         MOV       DPL,A
   \   000005   E4           CLR       A
   \   000006   3583         ADDC      A,DPH
   \   000008   F583         MOV       DPH,A
   \   00000A   22           RET
    544          
    545          /*********************************************************************
    546           * @fn      zclZEM_UartCB
    547           *
    548           * @brief   UART callback function
    549           *
    550           * @param   port - UART port
    551           * @param   event - UART event
    552           *
    553           * @return  none
    554           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    555          static void zclZEM_UartCB(uint8 port, uint8 event)
   \                     zclZEM_UartCB:
    556          {
   \   000000   74F7         MOV       A,#-0x9
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    557            // 获取当前串口接收缓冲区有多少字节的数据
    558            uint8 rxLen = Hal_UART_RxBufLen(HAL_UART_PORT_0); 
   \   000005                ; Setup parameters for call to function Hal_UART_RxBufLen
   \   000005   7900         MOV       R1,#0x0
   \   000007   12....       LCALL     `??Hal_UART_RxBufLen::?relay`; Banked call to: Hal_UART_RxBufLen
   \   00000A   EA           MOV       A,R2
    559            if(rxLen != 0) // 如果字节数数量不等于0 
   \   00000B   601A         JZ        ??zclZEM_UartCB_0
    560            {
    561              // 从串口缓冲区中读取数据
    562              HalUARTRead(HAL_UART_PORT_0, zclZEM_UartBuf, rxLen);
   \   00000D   FE           MOV       R6,A
   \   00000E                ; Setup parameters for call to function HalUARTRead
   \   00000E   FC           MOV       R4,A
   \   00000F   7D00         MOV       R5,#0x0
   \   000011   7A..         MOV       R2,#zclZEM_UartBuf & 0xff
   \   000013   7B..         MOV       R3,#(zclZEM_UartBuf >> 8) & 0xff
   \   000015   7900         MOV       R1,#0x0
   \   000017   12....       LCALL     `??HalUARTRead::?relay`; Banked call to: HalUARTRead
    563              // 通过串口发送数据，例如把数据发送到串口助手
    564              HalUARTWrite(HAL_UART_PORT_0, zclZEM_UartBuf, rxLen);  
   \   00001A                ; Setup parameters for call to function HalUARTWrite
   \   00001A   EE           MOV       A,R6
   \   00001B   FC           MOV       R4,A
   \   00001C   7D00         MOV       R5,#0x0
   \   00001E   7A..         MOV       R2,#zclZEM_UartBuf & 0xff
   \   000020   7B..         MOV       R3,#(zclZEM_UartBuf >> 8) & 0xff
   \   000022   7900         MOV       R1,#0x0
   \   000024   12....       LCALL     `??HalUARTWrite::?relay`; Banked call to: HalUARTWrite
    565            }
    566          }
   \                     ??zclZEM_UartCB_0:
   \   000027                REQUIRE ?Subroutine1
   \   000027                ; // Fall through to label ?Subroutine1

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7F01         MOV       R7,#0x1
   \   000002   02....       LJMP      ?BANKED_LEAVE_XDATA
    567          
    568          /*********************************************************************
    569           * @fn      zclZEM_HandleKeys
    570           *
    571           * @brief   Handles all key events for this device.
    572           *
    573           * @param   shift - true if in shift/alt.
    574           * @param   keys - bit field for key events. Valid entries:
    575           *                 HAL_KEY_SW_5
    576           *                 HAL_KEY_SW_4
    577           *                 HAL_KEY_SW_3
    578           *                 HAL_KEY_SW_2
    579           *                 HAL_KEY_SW_1
    580           *
    581           * @return  none
    582           */
    583          static void zclZEM_HandleKeys( byte shift, byte keys )
    584          {
    585          }
    586          
    587          /*********************************************************************
    588           * @fn      zclZEM_LcdDisplayMainMode
    589           *
    590           * @brief   Called to display the main screen on the LCD.
    591           *
    592           * @param   none
    593           *
    594           * @return  none
    595           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    596          static void zclZEM_ProcessCommissioningStatus(bdbCommissioningModeMsg_t* bdbCommissioningModeMsg)
   \                     zclZEM_ProcessCommissioningStatus:
    597          {
   \   000000   C082         PUSH      DPL
   \   000002   C083         PUSH      DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 114
   \   000004   748E         MOV       A,#-0x72
   \   000006   12....       LCALL     ?ALLOC_XSTACK8
    598              switch(bdbCommissioningModeMsg->bdbCommissioningMode)
   \   000009   8A82         MOV       DPL,R2
   \   00000B   8B83         MOV       DPH,R3
   \   00000D   A3           INC       DPTR
   \   00000E   E0           MOVX      A,@DPTR
   \   00000F   14           DEC       A
   \   000010   605F         JZ        ??zclZEM_ProcessCommissioningStatus_0
   \   000012   14           DEC       A
   \   000013   707A         JNZ       ??zclZEM_ProcessCommissioningStatus_1
    599              {
    600                case BDB_COMMISSIONING_FORMATION:
    601                  if(bdbCommissioningModeMsg->bdbCommissioningStatus == BDB_COMMISSIONING_SUCCESS)
   \   000015   8A82         MOV       DPL,R2
   \   000017   8B83         MOV       DPH,R3
   \   000019   E0           MOVX      A,@DPTR
   \   00001A   7022         JNZ       ??zclZEM_ProcessCommissioningStatus_2
    602                  {
    603                    //After formation, perform nwk steering again plus the remaining commissioning modes that has not been process yet
    604                    bdb_StartCommissioning(BDB_COMMISSIONING_MODE_NWK_STEERING | bdbCommissioningModeMsg->bdbRemainingCommissioningModes);
   \   00001C                ; Setup parameters for call to function bdb_StartCommissioning
   \   00001C   A3           INC       DPTR
   \   00001D   A3           INC       DPTR
   \   00001E   E0           MOVX      A,@DPTR
   \   00001F   4402         ORL       A,#0x2
   \   000021   F9           MOV       R1,A
   \   000022   12....       LCALL     `??bdb_StartCommissioning::?relay`; Banked call to: bdb_StartCommissioning
    605                    // 网络形成成功
    606                    #ifdef ZDO_COORDINATOR
    607                    uint8 successMsg[] = "Network formation successful!\r\n";
   \   000025   90....       MOV       DPTR,#`?<Constant "Network formation suc...">`
   \   000028   7452         MOV       A,#0x52
   \   00002A   12....       LCALL     ?XSTACK_DISP102_8
   \   00002D   7420         MOV       A,#0x20
   \   00002F   12....       LCALL     ?MOVE_LONG8_XDATA_XDATA
    608                    HalUARTWrite(HAL_UART_PORT_0, successMsg, sizeof(successMsg)-1);
   \   000032                ; Setup parameters for call to function HalUARTWrite
   \   000032   7C1F         MOV       R4,#0x1f
   \   000034   FD           MOV       R5,A
   \   000035   7452         MOV       A,#0x52
   \   000037   12....       LCALL     ?XSTACK_DISP101_8
   \   00003A   7900         MOV       R1,#0x0
   \   00003C   804E         SJMP      ??zclZEM_ProcessCommissioningStatus_3
    609                    #endif
    610                  }
    611                  else
    612                  {
    613                    //Want to try other channels?
    614                    //try with bdb_setChannelAttribute
    615                    // 网络形成失败
    616                    #ifdef ZDO_COORDINATOR
    617                    uint8 failMsg[] = "Network formation failed! Retrying in 5 seconds...\r\n";
   \                     ??zclZEM_ProcessCommissioningStatus_2:
   \   00003E   90....       MOV       DPTR,#`?<Constant "Network formation fai...">_1`
   \   000041   741D         MOV       A,#0x1d
   \   000043   12....       LCALL     ?XSTACK_DISP102_8
   \   000046   7435         MOV       A,#0x35
   \   000048   12....       LCALL     ?MOVE_LONG8_XDATA_XDATA
    618                    HalUARTWrite(HAL_UART_PORT_0, failMsg, sizeof(failMsg)-1);
   \   00004B                ; Setup parameters for call to function HalUARTWrite
   \   00004B   7C34         MOV       R4,#0x34
   \   00004D   FD           MOV       R5,A
   \   00004E   741D         MOV       A,#0x1d
   \   000050   12....       LCALL     ?XSTACK_DISP101_8
   \   000053   7900         MOV       R1,#0x0
   \   000055   12....       LCALL     `??HalUARTWrite::?relay`; Banked call to: HalUARTWrite
    619                    
    620                    // 无限重试网络形成 - 确保每次失败后都重新设置定时器
    621                    osal_start_timerEx(zclZEM_TaskID, ZEM_RETRY_FORMATION_EVT, 5000);
   \   000058                ; Setup parameters for call to function osal_start_timerEx
   \   000058   90....       MOV       DPTR,#__Constant_1388
   \   00005B   12....       LCALL     ?PUSH_XSTACK8_X_FOUR
   \   00005E   7A00         MOV       R2,#0x0
   \   000060   7B02         MOV       R3,#0x2
   \   000062   90....       MOV       DPTR,#zclZEM_TaskID
   \   000065   E0           MOVX      A,@DPTR
   \   000066   F9           MOV       R1,A
   \   000067   12....       LCALL     `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   00006A   7404         MOV       A,#0x4
   \   00006C   12....       LCALL     ?DEALLOC_XSTACK8
   \   00006F   801E         SJMP      ??zclZEM_ProcessCommissioningStatus_1
    622                    #endif
    623                  }
    624                break;
    625                case BDB_COMMISSIONING_NWK_STEERING:
    626                  if(bdbCommissioningModeMsg->bdbCommissioningStatus == BDB_COMMISSIONING_SUCCESS)
   \                     ??zclZEM_ProcessCommissioningStatus_0:
   \   000071   8A82         MOV       DPL,R2
   \   000073   8B83         MOV       DPH,R3
   \   000075   E0           MOVX      A,@DPTR
   \   000076   7017         JNZ       ??zclZEM_ProcessCommissioningStatus_1
    627                  {
    628                    //YOUR JOB:
    629                    //We are on the nwk, what now?
    630                    // 网络引导成功
    631                    #ifdef ZDO_COORDINATOR
    632                    uint8 deviceJoinedMsg[] = "Device joined the network!\r\n";
   \   000078   90....       MOV       DPTR,#`?<Constant "Device joined the net...">`
   \   00007B   AC..         MOV       R4,?XSP + 0
   \   00007D   AD..         MOV       R5,?XSP + 1
   \   00007F   741D         MOV       A,#0x1d
   \   000081   12....       LCALL     ?MOVE_LONG8_XDATA_XDATA
    633                    HalUARTWrite(HAL_UART_PORT_0, deviceJoinedMsg, sizeof(deviceJoinedMsg)-1);
   \   000084                ; Setup parameters for call to function HalUARTWrite
   \   000084   7C1C         MOV       R4,#0x1c
   \   000086   FD           MOV       R5,A
   \   000087   AA..         MOV       R2,?XSP + 0
   \   000089   AB..         MOV       R3,?XSP + 1
   \   00008B   F9           MOV       R1,A
   \                     ??zclZEM_ProcessCommissioningStatus_3:
   \   00008C   12....       LCALL     `??HalUARTWrite::?relay`; Banked call to: HalUARTWrite
    634                    #endif
    635                  }
    636                  else
    637                  {
    638                    // 网络引导失败
    639                    #ifdef ZDO_COORDINATOR
    640                    /* 协调器 */
    641                    #else
    642                    /* 路由器或者终端 */
    643                    uint8 failMsg[] = "Network steering failed! Retrying in 1 second...\r\n";
    644                    HalUARTWrite(HAL_UART_PORT_0, failMsg, sizeof(failMsg)-1);
    645                    
    646                    /* 无限重试网络引导 */
    647                    osal_start_timerEx(zclZEM_TaskID, 
    648                                              ZEM_REJOIN_EVT, 
    649                                              ZEM_REJOIN_PERIOD);
    650                    #endif
    651                  }
    652                  break;
    653                case BDB_COMMISSIONING_FINDING_BINDING:
    654                  if(bdbCommissioningModeMsg->bdbCommissioningStatus == BDB_COMMISSIONING_SUCCESS)
    655                  {
    656                    //YOUR JOB:
    657                  }
    658                  else
    659                  {
    660                    //YOUR JOB:
    661                    //retry?, wait for user interaction?
    662                  }
    663                break;
    664                case BDB_COMMISSIONING_INITIALIZATION:
    665                  //Initialization notification can only be successful. Failure on initialization 
    666                  //only happens for ZED and is notified as BDB_COMMISSIONING_PARENT_LOST notification
    667                  
    668                  //YOUR JOB:
    669                  //We are on a network, what now?
    670                  
    671                break;
    672          #if ZG_BUILD_ENDDEVICE_TYPE    
    673              case BDB_COMMISSIONING_PARENT_LOST:
    674                if(bdbCommissioningModeMsg->bdbCommissioningStatus == BDB_COMMISSIONING_NETWORK_RESTORED)
    675                {
    676                  //We did recover from losing parent
    677                }
    678                else
    679                {
    680                  //Parent not found, attempt to rejoin again after a fixed delay
    681                  //osal_start_timerEx(zclZEM_TaskID, SAMPLEAPP_END_DEVICE_REJOIN_EVT, SAMPLEAPP_END_DEVICE_REJOIN_DELAY);
    682                  
    683                  /* 协调器 */
    684          #ifdef ZDO_COORDINATOR
    685                  /* 路由器或者终端 */
    686          #else
    687                /* 启动重新加入事件 */
    688                osal_start_timerEx(zclZEM_TaskID, 
    689                                  ZEM_REJOIN_EVT, 
    690                                  ZEM_REJOIN_PERIOD);
    691          #endif
    692                }
    693              break;
    694          #endif 
    695              }
    696          
    697          }
   \                     ??zclZEM_ProcessCommissioningStatus_1:
   \   00008F   7472         MOV       A,#0x72
   \   000091   12....       LCALL     ?DEALLOC_XSTACK8
   \   000094                REQUIRE ?Subroutine2
   \   000094                ; // Fall through to label ?Subroutine2

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   D083         POP       DPH
   \   000002   D082         POP       DPL
   \   000004   02....       LJMP      ?BRET
    698          
    699          /*********************************************************************
    700           * @fn      zclZEM_BasicResetCB
    701           *
    702           * @brief   Callback from the ZCL General Cluster Library
    703           *          to set all the Basic Cluster attributes to default values.
    704           *
    705           * @param   none
    706           *
    707           * @return  none
    708           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    709          static void zclZEM_BasicResetCB( void )
   \                     zclZEM_BasicResetCB:
    710          {
   \   000000   C082         PUSH      DPL
   \   000002   C083         PUSH      DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    711            zclZEM_ResetAttributesToDefaultValues();
   \   000004                ; Setup parameters for call to function zclZEM_ResetAttributesToDefaultValues
   \   000004   12....       LCALL     `??zclZEM_ResetAttributesToDefaultValues::?relay`; Banked call to: zclZEM_ResetAttributesToDefaultValues
    712            
    713          }
   \   000007   80..         SJMP      ?Subroutine2
    714          
    715          /*********************************************************************
    716           * @fn      zclSampleApp_BatteryWarningCB
    717           *
    718           * @brief   Called to handle battery-low situation.
    719           *
    720           * @param   voltLevel - level of severity
    721           *
    722           * @return  none
    723           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    724          void zclSampleApp_BatteryWarningCB( uint8 voltLevel )
   \                     zclSampleApp_BatteryWarningCB:
    725          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    726            if ( voltLevel == VOLT_LEVEL_CAUTIOUS )
    727            {
    728              // Send warning message to the gateway and blink LED
    729            }
    730            else if ( voltLevel == VOLT_LEVEL_BAD )
    731            {
    732              // Shut down the system
    733            }
    734          }
   \   000000   02....       LJMP      ?BRET
    735          
    736          /******************************************************************************
    737           *
    738           *  Functions for processing ZCL Foundation incoming Command/Response messages
    739           *
    740           *****************************************************************************/
    741          
    742          /*********************************************************************
    743           * @fn      zclZEM_ProcessIncomingMsg
    744           *
    745           * @brief   Process ZCL Foundation incoming message
    746           *
    747           * @param   pInMsg - pointer to the received message
    748           *
    749           * @return  none
    750           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    751          static void zclZEM_ProcessIncomingMsg( zclIncomingMsg_t *pInMsg)
   \                     zclZEM_ProcessIncomingMsg:
    752          {
   \   000000   74F7         MOV       A,#-0x9
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    753            switch ( pInMsg->zclHdr.commandID )
   \   000005   EA           MOV       A,R2
   \   000006   2417         ADD       A,#0x17
   \   000008   12....       LCALL     ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_13:
   \   00000B   A3           INC       DPTR
   \   00000C   A3           INC       DPTR
   \   00000D   A3           INC       DPTR
   \   00000E   E0           MOVX      A,@DPTR
   \   00000F   14           DEC       A
   \   000010   6016         JZ        ??zclZEM_ProcessIncomingMsg_0
   \   000012   24FD         ADD       A,#-0x3
   \   000014   601F         JZ        ??zclZEM_ProcessIncomingMsg_1
   \   000016   24F7         ADD       A,#-0x9
   \   000018   602D         JZ        ??zclZEM_ProcessIncomingMsg_2
   \   00001A   24FB         ADD       A,#-0x5
   \   00001C   6024         JZ        ??zclZEM_ProcessIncomingMsg_3
   \   00001E   24FE         ADD       A,#-0x2
   \   000020   6020         JZ        ??zclZEM_ProcessIncomingMsg_3
   \   000022   24FE         ADD       A,#-0x2
   \   000024   6033         JZ        ??zclZEM_ProcessIncomingMsg_4
   \   000026   8043         SJMP      ??zclZEM_ProcessIncomingMsg_5
    754            {
    755          #ifdef ZCL_READ
    756              case ZCL_CMD_READ_RSP:
    757                zclZEM_ProcessInReadRspCmd( pInMsg );
   \                     ??zclZEM_ProcessIncomingMsg_0:
   \   000028   12....       LCALL     ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_5:
   \   00002B   E0           MOVX      A,@DPTR
   \   00002C   F9           MOV       R1,A
   \   00002D   E8           MOV       A,R0
   \   00002E   C3           CLR       C
   \   00002F   99           SUBB      A,R1
   \   000030   5039         JNC       ??zclZEM_ProcessIncomingMsg_5
   \   000032   08           INC       R0
   \   000033   80F6         SJMP      ??CrossCallReturnLabel_5
    758                break;
    759          #endif
    760          #ifdef ZCL_WRITE
    761              case ZCL_CMD_WRITE_RSP:
    762                zclZEM_ProcessInWriteRspCmd( pInMsg );
   \                     ??zclZEM_ProcessIncomingMsg_1:
   \   000035   12....       LCALL     ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   000038   E0           MOVX      A,@DPTR
   \   000039   F9           MOV       R1,A
   \   00003A   E8           MOV       A,R0
   \   00003B   C3           CLR       C
   \   00003C   99           SUBB      A,R1
   \   00003D   502C         JNC       ??zclZEM_ProcessIncomingMsg_5
   \   00003F   08           INC       R0
   \   000040   80F6         SJMP      ??CrossCallReturnLabel_6
    763                break;
    764          #endif
    765          #ifdef ZCL_REPORT
    766              // See ZCL Test Applicaiton (zcl_testapp.c) for sample code on Attribute Reporting
    767              case ZCL_CMD_CONFIG_REPORT:
    768                //zclZEM_ProcessInConfigReportCmd( pInMsg );
    769                break;
    770                case ZCL_CMD_READ_REPORT_CFG:
    771                //zclZEM_ProcessInReadReportCfgCmd( pInMsg );
    772                break;
    773              case ZCL_CMD_CONFIG_REPORT_RSP:
    774                //zclZEM_ProcessInConfigReportRspCmd( pInMsg );
    775                break;
    776              case ZCL_CMD_READ_REPORT_CFG_RSP:
    777                //zclZEM_ProcessInReadReportCfgRspCmd( pInMsg );
    778                break;
    779          
    780              case ZCL_CMD_REPORT:
    781                //zclZEM_ProcessInReportCmd( pInMsg );
    782                break;
    783          #endif
    784              case ZCL_CMD_DEFAULT_RSP:
    785                zclZEM_ProcessInDefaultRspCmd( pInMsg );
    786                break;
    787          #ifdef ZCL_DISCOVER
    788              case ZCL_CMD_DISCOVER_CMDS_RECEIVED_RSP:
    789                zclZEM_ProcessInDiscCmdsRspCmd( pInMsg );
   \                     ??zclZEM_ProcessIncomingMsg_3:
   \   000042                ; Setup parameters for call to function zclZEM_ProcessInDiscCmdsRspCmd
    790                break;
    791          
    792              case ZCL_CMD_DISCOVER_CMDS_GEN_RSP:
    793                zclZEM_ProcessInDiscCmdsRspCmd( pInMsg );
   \   000042                ; Setup parameters for call to function zclZEM_ProcessInDiscCmdsRspCmd
   \   000042   12....       LCALL     `??zclZEM_ProcessInDiscCmdsRspCmd::?relay`; Banked call to: zclZEM_ProcessInDiscCmdsRspCmd
    794                break;
   \   000045   8024         SJMP      ??zclZEM_ProcessIncomingMsg_5
    795          
    796              case ZCL_CMD_DISCOVER_ATTRS_RSP:
    797                zclZEM_ProcessInDiscAttrsRspCmd( pInMsg );
   \                     ??zclZEM_ProcessIncomingMsg_2:
   \   000047   12....       LCALL     ?Subroutine8 & 0xFFFF
   \                     ??CrossCallReturnLabel_18:
   \   00004A   8882         MOV       DPL,R0
   \   00004C   8983         MOV       DPH,R1
   \   00004E   A3           INC       DPTR
   \   00004F   E0           MOVX      A,@DPTR
   \   000050   FB           MOV       R3,A
   \   000051   EA           MOV       A,R2
   \   000052   C3           CLR       C
   \   000053   9B           SUBB      A,R3
   \   000054   5015         JNC       ??zclZEM_ProcessIncomingMsg_5
   \   000056   0A           INC       R2
   \   000057   80F1         SJMP      ??CrossCallReturnLabel_18
    798                break;
    799          
    800              case ZCL_CMD_DISCOVER_ATTRS_EXT_RSP:
    801                zclZEM_ProcessInDiscAttrsExtRspCmd( pInMsg );
   \                     ??zclZEM_ProcessIncomingMsg_4:
   \   000059   12....       LCALL     ?Subroutine8 & 0xFFFF
    802                break;
    803          #endif
    804              default:
    805                break;
    806            }
   \                     ??CrossCallReturnLabel_19:
   \   00005C   8001         SJMP      ??zclZEM_ProcessIncomingMsg_6
   \                     ??zclZEM_ProcessIncomingMsg_7:
   \   00005E   0A           INC       R2
   \                     ??zclZEM_ProcessIncomingMsg_6:
   \   00005F   8882         MOV       DPL,R0
   \   000061   8983         MOV       DPH,R1
   \   000063   A3           INC       DPTR
   \   000064   E0           MOVX      A,@DPTR
   \   000065   FB           MOV       R3,A
   \   000066   EA           MOV       A,R2
   \   000067   C3           CLR       C
   \   000068   9B           SUBB      A,R3
   \   000069   40F3         JC        ??zclZEM_ProcessIncomingMsg_7
    807          
    808            if ( pInMsg->attrCmd )
   \                     ??zclZEM_ProcessIncomingMsg_5:
   \   00006B   8E82         MOV       DPL,R6
   \   00006D   8F83         MOV       DPH,R7
   \   00006F   E0           MOVX      A,@DPTR
   \   000070   FA           MOV       R2,A
   \   000071   A3           INC       DPTR
   \   000072   E0           MOVX      A,@DPTR
   \   000073   FB           MOV       R3,A
   \   000074   EA           MOV       A,R2
   \   000075   4B           ORL       A,R3
   \   000076   6003         JZ        ??zclZEM_ProcessIncomingMsg_8
    809            {
    810              osal_mem_free( pInMsg->attrCmd );
   \   000078                ; Setup parameters for call to function osal_mem_free
   \   000078   12....       LCALL     `??osal_mem_free::?relay`; Banked call to: osal_mem_free
    811            }
    812          }
   \                     ??zclZEM_ProcessIncomingMsg_8:
   \   00007B   02....       LJMP      ?Subroutine1 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   8E82         MOV       DPL,R6
   \   000002   8F83         MOV       DPH,R7
   \   000004                REQUIRE ??Subroutine15_0
   \   000004                ; // Fall through to label ??Subroutine15_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine15_0:
   \   000000   E0           MOVX      A,@DPTR
   \   000001   F8           MOV       R0,A
   \   000002   A3           INC       DPTR
   \   000003   E0           MOVX      A,@DPTR
   \   000004   F9           MOV       R1,A
   \   000005   7A00         MOV       R2,#0x0
   \   000007   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   8E82         MOV       DPL,R6
   \   000002   8F83         MOV       DPH,R7
   \   000004   E0           MOVX      A,@DPTR
   \   000005   F8           MOV       R0,A
   \   000006   A3           INC       DPTR
   \   000007   E0           MOVX      A,@DPTR
   \   000008   F9           MOV       R1,A
   \   000009   8882         MOV       DPL,R0
   \   00000B   8983         MOV       DPH,R1
   \   00000D   7800         MOV       R0,#0x0
   \   00000F   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine12:
   \   000000   F8           MOV       R0,A
   \   000001   E4           CLR       A
   \   000002   3B           ADDC      A,R3
   \   000003   F9           MOV       R1,A
   \   000004   E8           MOV       A,R0
   \   000005   FE           MOV       R6,A
   \   000006   E9           MOV       A,R1
   \   000007   FF           MOV       R7,A
   \   000008   8A82         MOV       DPL,R2
   \   00000A   8B83         MOV       DPH,R3
   \   00000C   A3           INC       DPTR
   \   00000D   A3           INC       DPTR
   \   00000E   A3           INC       DPTR
   \   00000F   A3           INC       DPTR
   \   000010   22           RET
    813          
    814          #ifdef ZCL_READ
    815          /*********************************************************************
    816           * @fn      zclZEM_ProcessInReadRspCmd
    817           *
    818           * @brief   Process the "Profile" Read Response Command
    819           *
    820           * @param   pInMsg - incoming message to process
    821           *
    822           * @return  none
    823           */
    824          static uint8 zclZEM_ProcessInReadRspCmd( zclIncomingMsg_t *pInMsg )
    825          {
    826            zclReadRspCmd_t *readRspCmd;
    827            uint8 i;
    828          
    829            readRspCmd = (zclReadRspCmd_t *)pInMsg->attrCmd;
    830            for ( i = 0; i < readRspCmd->numAttr; i++ )
    831            {
    832              // Notify the originator of the results of the original read attributes
    833              // attempt and, for each successfull request, the value of the requested
    834              // attribute
    835            }
    836          
    837            return ( TRUE );
    838          }
    839          #endif // ZCL_READ
    840          
    841          #ifdef ZCL_WRITE
    842          /*********************************************************************
    843           * @fn      zclZEM_ProcessInWriteRspCmd
    844           *
    845           * @brief   Process the "Profile" Write Response Command
    846           *
    847           * @param   pInMsg - incoming message to process
    848           *
    849           * @return  none
    850           */
    851          static uint8 zclZEM_ProcessInWriteRspCmd( zclIncomingMsg_t *pInMsg )
    852          {
    853            zclWriteRspCmd_t *writeRspCmd;
    854            uint8 i;
    855          
    856            writeRspCmd = (zclWriteRspCmd_t *)pInMsg->attrCmd;
    857            for ( i = 0; i < writeRspCmd->numAttr; i++ )
    858            {
    859              // Notify the device of the results of the its original write attributes
    860              // command.
    861            }
    862          
    863            return ( TRUE );
    864          }
    865          #endif // ZCL_WRITE
    866          
    867          /*********************************************************************
    868           * @fn      zclZEM_ProcessInDefaultRspCmd
    869           *
    870           * @brief   Process the "Profile" Default Response Command
    871           *
    872           * @param   pInMsg - incoming message to process
    873           *
    874           * @return  none
    875           */
    876          static uint8 zclZEM_ProcessInDefaultRspCmd( zclIncomingMsg_t *pInMsg )
    877          {
    878            // zclDefaultRspCmd_t *defaultRspCmd = (zclDefaultRspCmd_t *)pInMsg->attrCmd;
    879          
    880            // Device is notified of the Default Response command.
    881            (void)pInMsg;
    882          
    883            return ( TRUE );
    884          }
    885          
    886          #ifdef ZCL_DISCOVER
    887          /*********************************************************************
    888           * @fn      zclZEM_ProcessInDiscCmdsRspCmd
    889           *
    890           * @brief   Process the Discover Commands Response Command
    891           *
    892           * @param   pInMsg - incoming message to process
    893           *
    894           * @return  none
    895           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    896          static uint8 zclZEM_ProcessInDiscCmdsRspCmd( zclIncomingMsg_t *pInMsg )
   \                     zclZEM_ProcessInDiscCmdsRspCmd:
    897          {
   \   000000   C082         PUSH      DPL
   \   000002   C083         PUSH      DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    898            zclDiscoverCmdsCmdRsp_t *discoverRspCmd;
    899            uint8 i;
    900          
    901            discoverRspCmd = (zclDiscoverCmdsCmdRsp_t *)pInMsg->attrCmd;
   \   000004   EA           MOV       A,R2
   \   000005   2417         ADD       A,#0x17
   \   000007   F582         MOV       DPL,A
   \   000009   E4           CLR       A
   \   00000A   3B           ADDC      A,R3
   \   00000B   F583         MOV       DPH,A
   \   00000D   12....       LCALL     ??Subroutine15_0 & 0xFFFF
    902            for ( i = 0; i < discoverRspCmd->numCmd; i++ )
   \                     ??CrossCallReturnLabel_17:
   \   000010   8001         SJMP      ??zclZEM_ProcessInDiscCmdsRspCmd_0
   \                     ??zclZEM_ProcessInDiscCmdsRspCmd_1:
   \   000012   0A           INC       R2
   \                     ??zclZEM_ProcessInDiscCmdsRspCmd_0:
   \   000013   8882         MOV       DPL,R0
   \   000015   8983         MOV       DPH,R1
   \   000017   A3           INC       DPTR
   \   000018   A3           INC       DPTR
   \   000019   E0           MOVX      A,@DPTR
   \   00001A   FB           MOV       R3,A
   \   00001B   EA           MOV       A,R2
   \   00001C   C3           CLR       C
   \   00001D   9B           SUBB      A,R3
   \   00001E   40F2         JC        ??zclZEM_ProcessInDiscCmdsRspCmd_1
    903            {
    904              // Device is notified of the result of its attribute discovery command.
    905            }
    906          
    907            return ( TRUE );
   \   000020   7901         MOV       R1,#0x1
   \   000022   02....       LJMP      ?Subroutine2 & 0xFFFF
    908          }
    909          
    910          /*********************************************************************
    911           * @fn      zclZEM_ProcessInDiscAttrsRspCmd
    912           *
    913           * @brief   Process the "Profile" Discover Attributes Response Command
    914           *
    915           * @param   pInMsg - incoming message to process
    916           *
    917           * @return  none
    918           */
    919          static uint8 zclZEM_ProcessInDiscAttrsRspCmd( zclIncomingMsg_t *pInMsg )
    920          {
    921            zclDiscoverAttrsRspCmd_t *discoverRspCmd;
    922            uint8 i;
    923          
    924            discoverRspCmd = (zclDiscoverAttrsRspCmd_t *)pInMsg->attrCmd;
    925            for ( i = 0; i < discoverRspCmd->numAttr; i++ )
    926            {
    927              // Device is notified of the result of its attribute discovery command.
    928            }
    929          
    930            return ( TRUE );
    931          }
    932          
    933          /*********************************************************************
    934           * @fn      zclZEM_ProcessInDiscAttrsExtRspCmd
    935           *
    936           * @brief   Process the "Profile" Discover Attributes Extended Response Command
    937           *
    938           * @param   pInMsg - incoming message to process
    939           *
    940           * @return  none
    941           */
    942          static uint8 zclZEM_ProcessInDiscAttrsExtRspCmd( zclIncomingMsg_t *pInMsg )
    943          {
    944            zclDiscoverAttrsExtRsp_t *discoverRspCmd;
    945            uint8 i;
    946          
    947            discoverRspCmd = (zclDiscoverAttrsExtRsp_t *)pInMsg->attrCmd;
    948            for ( i = 0; i < discoverRspCmd->numAttr; i++ )
    949            {
    950              // Device is notified of the result of its attribute discovery command.
    951            }
    952          
    953            return ( TRUE );
    954          }
    955          #endif // ZCL_DISCOVER
    956          
    957          
    958          
    959          
    960          /*********************************************************************
    961           * @fn      zclZEM_AF_P2P
    962           *
    963           * @brief   点对点发送函数
    964           *
    965           * @param   destNwkAddr - 目标设备的网络地址
    966           * @param   cid - Cluster ID，后续课程将会详细讲解
    967           * @param   len - 数据长度
    968           * @param   data - 数据内容
    969           *
    970           * @return  none
    971           */
    972          static void zclZEM_AF_P2P(
    973              uint16 destNwkAddr,
    974              uint16 cid,
    975              uint8 len,
    976              uint8 *data)
    977          {
    978              afAddrType_t dstAddr; //寻址信息配置

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    979              static uint8 transferId = 0;//传输ID，是数据包的标识符
   \                     ??transferId:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    980              
    981              /* Destination */
    982              dstAddr.addrMode = afAddr16Bit;// 设置目标地址模式为16位网络地址，表示使用P2P的通信方式
    983              dstAddr.addr.shortAddr = destNwkAddr;//目标设备的网络地址
    984              dstAddr.endPoint = ZEM_ENDPOINT;//目标设备的端点号
    985              
    986              transferId++;
    987              
    988              AF_DataRequest(&dstAddr,
    989                  &ZEM_AppEp,//应用程序端点描述符
    990                  cid,
    991                  len,
    992                  data,
    993                  &transferId,
    994                  AF_DISCV_ROUTE,//进行路由扫描操作，用于建立发送数据报文的通信路径。关于这个参数，暂时保持例程默认的代码就可以了
    995                  AF_DEFAULT_RADIUS);//指定最大的路由跳转级数
    996          }
    997          
    998          /*********************************************************************
    999           * @fn      zclZEM_AF_Broadcast
   1000           *
   1001           * @brief   广播发送函数
   1002           *
   1003           * @param   cid - Cluster ID
   1004           * @param   len - 待发送数据的长度
   1005           * @param   data - 待发送数据的内容
   1006           *
   1007           * @return  none
   1008           */
   1009          static void zclZEM_AF_Broadcast(
   1010              uint16 cid,
   1011              uint8 len,
   1012              uint8 *data)
   1013          {
   1014              afAddrType_t dstAddr;

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
   1015              static uint8 transferId = 0;
   1016              
   1017              /* Destination */
   1018              dstAddr.addrMode = afAddrBroadcast;   // 使用广播模式
   1019              dstAddr.addr.shortAddr = 0xFFFF; // 广播地址
   1020              dstAddr.endPoint = ZEM_ENDPOINT; // 目标设备的端点号
   1021              
   1022              /* Transfer id */
   1023              transferId++;
   1024              
   1025              /* Send */
   1026              AF_DataRequest(&dstAddr,
   1027                  &ZEM_AppEp,//应用程序端点描述符
   1028                  cid,
   1029                  len,
   1030                  data,
   1031                  &transferId,
   1032                  AF_TX_OPTIONS_NONE,
   1033                  AF_DEFAULT_RADIUS );//指定了最大的路由跳转级数
   1034          }
   1035          
   1036          /*********************************************************************
   1037           * @fn      zclZEM_AF_Groupcast
   1038           *
   1039           * @brief   组播发送函数
   1040           *
   1041           * @param   groupId - 组ID
   1042           * @param   cid - ClusterID，后续章节将会详细讲解
   1043           * @param   len - 待发送数据的长度
   1044           * @param   data - 待发送数据的内容
   1045           *
   1046           * @return  none
   1047           */
   1048          static void zclZEM_AF_Groupcast(
   1049              uint16 groupId,
   1050              uint16 cid,
   1051              uint8 len,
   1052              uint8 *data)
   1053          {
   1054              afAddrType_t dstAddr;

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   1055              static uint8 transferId = 0;
   \                     ??transferId_2:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
   1056              
   1057              /* Destination */
   1058              dstAddr.addrMode = afAddrGroup;//使用组播通信模式
   1059              dstAddr.addr.shortAddr = groupId;
   1060              dstAddr.endPoint = ZEM_ENDPOINT;//组中的设备的端点号
   1061              
   1062              /* Transfer id */
   1063              transferId++;
   1064              
   1065              /* Send */
   1066              AF_DataRequest(&dstAddr,
   1067                  &ZEM_AppEp,//应用程序端点描述符
   1068                  cid,
   1069                  len,
   1070                  data,
   1071                  &transferId,
   1072                  AF_TX_OPTIONS_NONE,
   1073                  AF_DEFAULT_RADIUS );//指定最大的路由跳转级数，暂时可忽略
   1074          }
   1075          
   1076          /*********************************************************************
   1077           * @fn      zclZEM_AF_RxProc
   1078           *
   1079           * @brief   接收数据处理函数
   1080           *
   1081           * @param   MSGpkt - 接收到数据
   1082           *
   1083           * @return  none
   1084           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1085          static void zclZEM_AF_RxProc(afIncomingMSGPacket_t *MSGpkt)
   \                     zclZEM_AF_RxProc:
   1086          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000                REQUIRE ?V4
   \   000000                REQUIRE ?V5
   \   000000                REQUIRE ?V6
   \   000000                REQUIRE ?V8
   \   000000                REQUIRE ?V9
   \   000000                REQUIRE ?V10
   \   000000   74ED         MOV       A,#-0x13
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 19
   \   000005                ; Auto size: 64
   \   000005   74C0         MOV       A,#-0x40
   \   000007   12....       LCALL     ?ALLOC_XSTACK8
   1087              /*计数器，记录接收到的点对点通信数据包个数*/
   1088              static uint8 p2pCnt = 0;
   1089              /*计数器，记录接收到的广播通信数据包个数*/
   1090              static uint8 bcCnt = 0;
   1091              /*计数器，记录接收到的组播通信数据包个数*/
   1092              static uint8 gcCnt = 0;
   1093              
   1094              switch( MSGpkt->clusterId )  // 判断接收到的数据包的Cluster ID
   \   00000A   75....       MOV       ?V4,#`?<Constant " Count: ">` & 0xff
   \   00000D   75....       MOV       ?V5,#(`?<Constant " Count: ">` >> 8) & 0xff
   \   000010   75..00       MOV       ?V6,#0x0
   \   000013   EA           MOV       A,R2
   \   000014   2422         ADD       A,#0x22
   \   000016   F5..         MOV       ?V0,A
   \   000018   E4           CLR       A
   \   000019   3B           ADDC      A,R3
   \   00001A   F5..         MOV       ?V1,A
   \   00001C   EA           MOV       A,R2
   \   00001D   2420         ADD       A,#0x20
   \   00001F   12....       LCALL     ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_14:
   \   000022   E0           MOVX      A,@DPTR
   \   000023   F5..         MOV       ?V2,A
   \   000025   A3           INC       DPTR
   \   000026   E0           MOVX      A,@DPTR
   \   000027   F5..         MOV       ?V3,A
   \   000029   78..         MOV       R0,#?V2
   \   00002B   12....       LCALL     ?US_SWITCH_DENSE
   \                     `?<Jumptable for zclZEM_AF_RxProc>_0`:
   \   00002E   0000         DW        0
   \   000030   02           DB        2
   \   000031   ....         DW        ??zclZEM_AF_RxProc_0
   \   000033   ....         DW        ??zclZEM_AF_RxProc_1
   \   000035   ....         DW        ??zclZEM_AF_RxProc_2
   \   000037   ....         DW        ??zclZEM_AF_RxProc_3
   1095              {
   1096                  case CLUSTER_P2P:
   1097                      p2pCnt++;  // 接收到P2P数据包，进行计数
   \                     ??zclZEM_AF_RxProc_1:
   \   000039   90....       MOV       DPTR,#??p2pCnt
   \   00003C   E0           MOVX      A,@DPTR
   \   00003D   04           INC       A
   \   00003E   F0           MOVX      @DPTR,A
   1098                      // 通过串口输出接收到的数据和计数器值
   1099                      {
   1100                          uint8 p2pMsg[64];
   1101                          osal_memcpy(p2pMsg, "P2P Data: ", 10);
   \   00003F                ; Setup parameters for call to function osal_memcpy
   \   00003F   75....       MOV       ?V8,#`?<Constant "P2P Data: ">` & 0xff
   \   000042   75....       MOV       ?V9,#(`?<Constant "P2P Data: ">` >> 8) & 0xff
   \   000045   75..00       MOV       ?V10,#0x0
   \   000048   78..         MOV       R0,#?V8
   \   00004A   12....       LCALL     ?PUSH_XSTACK_I_THREE
   \   00004D   7C0A         MOV       R4,#0xa
   \   00004F   7D00         MOV       R5,#0x0
   \   000051   7403         MOV       A,#0x3
   \   000053   12....       LCALL     ?XSTACK_DISP101_8
   \   000056   12....       LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   000059   7403         MOV       A,#0x3
   \   00005B   12....       LCALL     ?DEALLOC_XSTACK8
   1102                          osal_memcpy(p2pMsg + 10, MSGpkt->cmd.Data, MSGpkt->cmd.DataLength);
   \   00005E                ; Setup parameters for call to function osal_memcpy
   \   00005E   12....       LCALL     ?Subroutine4 & 0xFFFF
   \                     ??CrossCallReturnLabel_0:
   \   000061   12....       LCALL     ?PUSH_XSTACK_I_THREE
   \   000064   8E82         MOV       DPL,R6
   \   000066   8F83         MOV       DPH,R7
   \   000068   E0           MOVX      A,@DPTR
   \   000069   FC           MOV       R4,A
   \   00006A   A3           INC       DPTR
   \   00006B   E0           MOVX      A,@DPTR
   \   00006C   FD           MOV       R5,A
   \   00006D   740D         MOV       A,#0xd
   \   00006F   12....       LCALL     ?XSTACK_DISP0_8
   \   000072   AA82         MOV       R2,DPL
   \   000074   AB83         MOV       R3,DPH
   \   000076   12....       LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   000079   7403         MOV       A,#0x3
   \   00007B   12....       LCALL     ?DEALLOC_XSTACK8
   1103                          osal_memcpy(p2pMsg + 10 + MSGpkt->cmd.DataLength, " Count: ", 8);
   \   00007E                ; Setup parameters for call to function osal_memcpy
   \   00007E   78..         MOV       R0,#?V4
   \   000080   12....       LCALL     ?PUSH_XSTACK_I_THREE
   \   000083   7C08         MOV       R4,#0x8
   \   000085   7D00         MOV       R5,#0x0
   \   000087   8E82         MOV       DPL,R6
   \   000089   8F83         MOV       DPH,R7
   \   00008B   7403         MOV       A,#0x3
   \   00008D   12....       LCALL     ?XSTACK_DISP100_8
   \   000090   89..         MOV       ?V1,R1
   \   000092   12....       LCALL     ??Subroutine16_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_20:
   \   000095   240A         ADD       A,#0xa
   \   000097   FA           MOV       R2,A
   \   000098   E4           CLR       A
   \   000099   39           ADDC      A,R1
   \   00009A   FB           MOV       R3,A
   \   00009B   12....       LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   00009E   7403         MOV       A,#0x3
   \   0000A0   12....       LCALL     ?DEALLOC_XSTACK8
   1104                          p2pMsg[18 + MSGpkt->cmd.DataLength] = '0' + p2pCnt;
   \   0000A3   90....       MOV       DPTR,#??p2pCnt
   \   0000A6   E0           MOVX      A,@DPTR
   \   0000A7   2430         ADD       A,#0x30
   \   0000A9   C0E0         PUSH      A
   \   0000AB   12....       LCALL     ?Subroutine6 & 0xFFFF
   1105                          p2pMsg[19 + MSGpkt->cmd.DataLength] = '\r';
   1106                          p2pMsg[20 + MSGpkt->cmd.DataLength] = '\n';
   1107                          HalUARTWrite(HAL_UART_PORT_0, p2pMsg, 21 + MSGpkt->cmd.DataLength);
   1108                      }
   \                     ??CrossCallReturnLabel_21:
   \   0000AE   2412         ADD       A,#0x12
   \   0000B0   F582         MOV       DPL,A
   \   0000B2   E4           CLR       A
   \   0000B3   39           ADDC      A,R1
   \   0000B4   F583         MOV       DPH,A
   \   0000B6   D0E0         POP       A
   \   0000B8   12....       LCALL     ??Subroutine17_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_27:
   \   0000BB   2413         ADD       A,#0x13
   \   0000BD   12....       LCALL     ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_25:
   \   0000C0   2414         ADD       A,#0x14
   \   0000C2   12....       LCALL     ?Subroutine13 & 0xFFFF
   \                     ??CrossCallReturnLabel_15:
   \   0000C5   2415         ADD       A,#0x15
   \   0000C7   02....       LJMP      ??zclZEM_AF_RxProc_4 & 0xFFFF
   1109                      break;
   1110                  case CLUSTER_BROADCAST:
   1111                      bcCnt++;  // 接收到广播数据包，进行计数
   \                     ??zclZEM_AF_RxProc_2:
   \   0000CA   90....       MOV       DPTR,#??bcCnt
   \   0000CD   E0           MOVX      A,@DPTR
   \   0000CE   04           INC       A
   \   0000CF   F0           MOVX      @DPTR,A
   1112                      // 通过串口输出接收到的数据和计数器值
   1113                      {
   1114                          uint8 bcMsg[64];
   1115                          osal_memcpy(bcMsg, "Broadcast Data: ", 16);
   \   0000D0                ; Setup parameters for call to function osal_memcpy
   \   0000D0   75....       MOV       ?V8,#`?<Constant "Broadcast Data: ">` & 0xff
   \   0000D3   75....       MOV       ?V9,#(`?<Constant "Broadcast Data: ">` >> 8) & 0xff
   \   0000D6   75..00       MOV       ?V10,#0x0
   \   0000D9   78..         MOV       R0,#?V8
   \   0000DB   12....       LCALL     ?PUSH_XSTACK_I_THREE
   \   0000DE   7C10         MOV       R4,#0x10
   \   0000E0   7D00         MOV       R5,#0x0
   \   0000E2   7403         MOV       A,#0x3
   \   0000E4   12....       LCALL     ?XSTACK_DISP101_8
   \   0000E7   12....       LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   0000EA   7403         MOV       A,#0x3
   \   0000EC   12....       LCALL     ?DEALLOC_XSTACK8
   1116                          osal_memcpy(bcMsg + 16, MSGpkt->cmd.Data, MSGpkt->cmd.DataLength);
   \   0000EF                ; Setup parameters for call to function osal_memcpy
   \   0000EF   12....       LCALL     ?Subroutine4 & 0xFFFF
   \                     ??CrossCallReturnLabel_1:
   \   0000F2   12....       LCALL     ?PUSH_XSTACK_I_THREE
   \   0000F5   8E82         MOV       DPL,R6
   \   0000F7   8F83         MOV       DPH,R7
   \   0000F9   E0           MOVX      A,@DPTR
   \   0000FA   FC           MOV       R4,A
   \   0000FB   A3           INC       DPTR
   \   0000FC   E0           MOVX      A,@DPTR
   \   0000FD   FD           MOV       R5,A
   \   0000FE   7413         MOV       A,#0x13
   \   000100   12....       LCALL     ?XSTACK_DISP0_8
   \   000103   AA82         MOV       R2,DPL
   \   000105   AB83         MOV       R3,DPH
   \   000107   12....       LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   00010A   7403         MOV       A,#0x3
   \   00010C   12....       LCALL     ?DEALLOC_XSTACK8
   1117                          osal_memcpy(bcMsg + 16 + MSGpkt->cmd.DataLength, " Count: ", 8);
   \   00010F                ; Setup parameters for call to function osal_memcpy
   \   00010F   78..         MOV       R0,#?V4
   \   000111   12....       LCALL     ?PUSH_XSTACK_I_THREE
   \   000114   7C08         MOV       R4,#0x8
   \   000116   7D00         MOV       R5,#0x0
   \   000118   8E82         MOV       DPL,R6
   \   00011A   8F83         MOV       DPH,R7
   \   00011C   7403         MOV       A,#0x3
   \   00011E   12....       LCALL     ?XSTACK_DISP100_8
   \   000121   12....       LCALL     ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_3:
   \   000124   12....       LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   000127   7403         MOV       A,#0x3
   \   000129   12....       LCALL     ?DEALLOC_XSTACK8
   1118                          bcMsg[24 + MSGpkt->cmd.DataLength] = '0' + bcCnt;
   \   00012C   90....       MOV       DPTR,#??bcCnt
   \   00012F   8065         SJMP      ??zclZEM_AF_RxProc_5
   1119                          bcMsg[25 + MSGpkt->cmd.DataLength] = '\r';
   1120                          bcMsg[26 + MSGpkt->cmd.DataLength] = '\n';
   1121                          HalUARTWrite(HAL_UART_PORT_0, bcMsg, 27 + MSGpkt->cmd.DataLength);
   1122                      }
   1123                      break;
   1124                  case CLUSTER_GROUPCAST:
   1125                      gcCnt++;  // 接收到组播数据包，进行计数
   \                     ??zclZEM_AF_RxProc_3:
   \   000131   90....       MOV       DPTR,#??gcCnt
   \   000134   E0           MOVX      A,@DPTR
   \   000135   04           INC       A
   \   000136   F0           MOVX      @DPTR,A
   1126                      // 通过串口输出接收到的数据和计数器值
   1127                      {
   1128                          uint8 gcMsg[64];
   1129                          osal_memcpy(gcMsg, "Groupcast Data: ", 16);
   \   000137                ; Setup parameters for call to function osal_memcpy
   \   000137   75....       MOV       ?V8,#`?<Constant "Groupcast Data: ">` & 0xff
   \   00013A   75....       MOV       ?V9,#(`?<Constant "Groupcast Data: ">` >> 8) & 0xff
   \   00013D   75..00       MOV       ?V10,#0x0
   \   000140   78..         MOV       R0,#?V8
   \   000142   12....       LCALL     ?PUSH_XSTACK_I_THREE
   \   000145   7C10         MOV       R4,#0x10
   \   000147   7D00         MOV       R5,#0x0
   \   000149   7403         MOV       A,#0x3
   \   00014B   12....       LCALL     ?XSTACK_DISP101_8
   \   00014E   12....       LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   000151   7403         MOV       A,#0x3
   \   000153   12....       LCALL     ?DEALLOC_XSTACK8
   1130                          osal_memcpy(gcMsg + 16, MSGpkt->cmd.Data, MSGpkt->cmd.DataLength);
   \   000156                ; Setup parameters for call to function osal_memcpy
   \   000156   12....       LCALL     ?Subroutine4 & 0xFFFF
   \                     ??CrossCallReturnLabel_2:
   \   000159   12....       LCALL     ?PUSH_XSTACK_I_THREE
   \   00015C   8E82         MOV       DPL,R6
   \   00015E   8F83         MOV       DPH,R7
   \   000160   E0           MOVX      A,@DPTR
   \   000161   FC           MOV       R4,A
   \   000162   A3           INC       DPTR
   \   000163   E0           MOVX      A,@DPTR
   \   000164   FD           MOV       R5,A
   \   000165   7413         MOV       A,#0x13
   \   000167   12....       LCALL     ?XSTACK_DISP0_8
   \   00016A   AA82         MOV       R2,DPL
   \   00016C   AB83         MOV       R3,DPH
   \   00016E   12....       LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   000171   7403         MOV       A,#0x3
   \   000173   12....       LCALL     ?DEALLOC_XSTACK8
   1131                          osal_memcpy(gcMsg + 16 + MSGpkt->cmd.DataLength, " Count: ", 8);
   \   000176                ; Setup parameters for call to function osal_memcpy
   \   000176   78..         MOV       R0,#?V4
   \   000178   12....       LCALL     ?PUSH_XSTACK_I_THREE
   \   00017B   7C08         MOV       R4,#0x8
   \   00017D   7D00         MOV       R5,#0x0
   \   00017F   8E82         MOV       DPL,R6
   \   000181   8F83         MOV       DPH,R7
   \   000183   7403         MOV       A,#0x3
   \   000185   12....       LCALL     ?XSTACK_DISP100_8
   \   000188   12....       LCALL     ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_4:
   \   00018B   12....       LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   00018E   7403         MOV       A,#0x3
   \   000190   12....       LCALL     ?DEALLOC_XSTACK8
   1132                          gcMsg[24 + MSGpkt->cmd.DataLength] = '0' + gcCnt;
   \   000193   90....       MOV       DPTR,#??gcCnt
   \                     ??zclZEM_AF_RxProc_5:
   \   000196   E0           MOVX      A,@DPTR
   \   000197   2430         ADD       A,#0x30
   \   000199   C0E0         PUSH      A
   1133                          gcMsg[25 + MSGpkt->cmd.DataLength] = '\r';
   1134                          gcMsg[26 + MSGpkt->cmd.DataLength] = '\n';
   1135                          HalUARTWrite(HAL_UART_PORT_0, gcMsg, 27 + MSGpkt->cmd.DataLength);
   1136                      }
   \   00019B   12....       LCALL     ?Subroutine6 & 0xFFFF
   \                     ??CrossCallReturnLabel_22:
   \   00019E   2418         ADD       A,#0x18
   \   0001A0   F582         MOV       DPL,A
   \   0001A2   E4           CLR       A
   \   0001A3   39           ADDC      A,R1
   \   0001A4   F583         MOV       DPH,A
   \   0001A6   D0E0         POP       A
   \   0001A8   12....       LCALL     ??Subroutine17_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_28:
   \   0001AB   2419         ADD       A,#0x19
   \   0001AD   12....       LCALL     ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_26:
   \   0001B0   241A         ADD       A,#0x1a
   \   0001B2   12....       LCALL     ?Subroutine13 & 0xFFFF
   \                     ??CrossCallReturnLabel_16:
   \   0001B5   241B         ADD       A,#0x1b
   \                     ??zclZEM_AF_RxProc_4:
   \   0001B7   FC           MOV       R4,A
   \   0001B8   A3           INC       DPTR
   \   0001B9   E0           MOVX      A,@DPTR
   \   0001BA   3400         ADDC      A,#0x0
   \   0001BC   FD           MOV       R5,A
   \   0001BD   AA..         MOV       R2,?XSP + 0
   \   0001BF   AB..         MOV       R3,?XSP + 1
   \   0001C1   7900         MOV       R1,#0x0
   \   0001C3   12....       LCALL     `??HalUARTWrite::?relay`; Banked call to: HalUARTWrite
   1137                      break;
   1138                  default:
   1139                      break;
   1140              }
   1141          }
   \                     ??zclZEM_AF_RxProc_0:
   \   0001C6   7440         MOV       A,#0x40
   \   0001C8   12....       LCALL     ?DEALLOC_XSTACK8
   \   0001CB   7F0B         MOV       R7,#0xb
   \   0001CD   02....       LJMP      ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine13:
   \   000000   F582         MOV       DPL,A
   \   000002   E4           CLR       A
   \   000003   39           ADDC      A,R1
   \   000004   F583         MOV       DPH,A
   \   000006   740A         MOV       A,#0xa
   \   000008   F0           MOVX      @DPTR,A
   \   000009                ; Setup parameters for call to function HalUARTWrite
   \   000009                ; Setup parameters for call to function HalUARTWrite
   \   000009   8E82         MOV       DPL,R6
   \   00000B   8F83         MOV       DPH,R7
   \   00000D   E0           MOVX      A,@DPTR
   \   00000E   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   8E82         MOV       DPL,R6
   \   000002   8F83         MOV       DPH,R7
   \   000004   A8..         MOV       R0,?XSP + 0
   \   000006   88..         MOV       ?V0,R0
   \   000008                REQUIRE ??Subroutine16_0
   \   000008                ; // Fall through to label ??Subroutine16_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine16_0:
   \   000000   12....       LCALL     ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_24:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine14:
   \   000000   E0           MOVX      A,@DPTR
   \   000001   28           ADD       A,R0
   \   000002   F8           MOV       R0,A
   \   000003   A3           INC       DPTR
   \   000004   E0           MOVX      A,@DPTR
   \   000005   35..         ADDC      A,?V1
   \   000007   F9           MOV       R1,A
   \   000008   E8           MOV       A,R0
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   89..         MOV       ?V1,R1
   \   000002   12....       LCALL     ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_23:
   \   000005   2410         ADD       A,#0x10
   \   000007   FA           MOV       R2,A
   \   000008   E4           CLR       A
   \   000009   39           ADDC      A,R1
   \   00000A   FB           MOV       R3,A
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   85..82       MOV       DPL,?V0
   \   000003   85..83       MOV       DPH,?V1
   \   000006   E0           MOVX      A,@DPTR
   \   000007   F5..         MOV       ?V0,A
   \   000009   A3           INC       DPTR
   \   00000A   E0           MOVX      A,@DPTR
   \   00000B   F5..         MOV       ?V1,A
   \   00000D   75..00       MOV       ?V2,#0x0
   \   000010   78..         MOV       R0,#?V0
   \   000012   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   F582         MOV       DPL,A
   \   000002   E4           CLR       A
   \   000003   39           ADDC      A,R1
   \   000004   F583         MOV       DPH,A
   \   000006   740D         MOV       A,#0xd
   \   000008                REQUIRE ??Subroutine17_0
   \   000008                ; // Fall through to label ??Subroutine17_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine17_0:
   \   000000   F0           MOVX      @DPTR,A
   \   000001   8E82         MOV       DPL,R6
   \   000003   8F83         MOV       DPH,R7
   \   000005   E0           MOVX      A,@DPTR
   \   000006   25..         ADD       A,?V0
   \   000008   F8           MOV       R0,A
   \   000009   A3           INC       DPTR
   \   00000A   E0           MOVX      A,@DPTR
   \   00000B   35..         ADDC      A,?V1
   \   00000D   F9           MOV       R1,A
   \   00000E   E8           MOV       A,R0
   \   00000F   22           RET

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??p2pCnt:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??bcCnt:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??gcCnt:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   E0           MOVX      A,@DPTR
   \   000001   04           INC       A
   \   000002   F0           MOVX      @DPTR,A
   \   000003                ; Setup parameters for call to function AF_DataRequest
   \   000003                ; Setup parameters for call to function AF_DataRequest
   \   000003   75..1E       MOV       ?V0,#0x1e
   \   000006   78..         MOV       R0,#?V0
   \   000008   22           RET

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for ZEM_AppEp>`:
   \   000000   08           DB 8
   \   000001   00           DB 0
   \   000002   ....         DW zclZEM_TaskID
   \   000004   ....         DW zclZEM_SimpleDesc
   \   000006   00           DB 0

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for reportableChange>`:
   \   000000   2C           DB 44
   \   000001   01           DB 1
   \   000002   00           DB 0
   \   000003   00           DB 0

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zclZEM_CmdCallbacks>`:
   \   000000   ....         DW `??zclZEM_BasicResetCB::?relay`
   \   000002   0000         DW 0H
   \   000004   0000         DW 0H
   \   000006   0000         DW 0H
   \   000008   0000         DW 0H
   \   00000A   0000         DW 0H
   \   00000C   0000         DW 0H
   \   00000E   0000         DW 0H
   \   000010   0000         DW 0H

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclZEM_Init::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclZEM_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclZEM_event_loop::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclZEM_event_loop

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclZEM_ReadAndSendMAC::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclZEM_ReadAndSendMAC

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclZEM_UartCB::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclZEM_UartCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclZEM_ProcessCommissioningStatus::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclZEM_ProcessCommissioningStatus

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclZEM_BasicResetCB::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclZEM_BasicResetCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclSampleApp_BatteryWarningCB::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleApp_BatteryWarningCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclZEM_ProcessIncomingMsg::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclZEM_ProcessIncomingMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclZEM_ProcessInDiscCmdsRspCmd::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclZEM_ProcessInDiscCmdsRspCmd

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclZEM_AF_RxProc::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclZEM_AF_RxProc

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "ZEMAPP_EVT\\344\\272\\213\\344\\273\\266`:
   \   000000   5A454D41     DB "ZEMAPP_EVT\344\272\213\344\273\266\350\247\246\345\217\221\357\274\214\345\274\200\345\247\213LED\351\227\252\347\203\201...\015\012"
   \            50505F45
   \            5654E4BA
   \            8BE4BBB6
   \            E8A7A6E5
   \            8F91EFBC
   \            8CE5BC80
   \            E5A78B4C
   \            4544E997
   \            AAE78381
   \            2E2E2E0D
   \            0A00    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "LED\\351\\227\\252\\347\\203\\201\\345\\22`:
   \   000000   4C4544E9     DB 4CH, 45H, 44H, 0E9H, 97H, 0AAH, 0E7H, 83H
   \            97AAE783
   \   000008   81E591BD     DB 81H, 0E5H, 91H, 0BDH, 0E4H, 0BBH, 0A4H, 0E5H
   \            E4BBA4E5
   \   000010   B7B2E58F     DB 0B7H, 0B2H, 0E5H, 8FH, 91H, 0E9H, 80H, 81H
   \            91E98081
   \   000018   EFBC8CE8     DB 0EFH, 0BCH, 8CH, 0E8H, 0AEH, 0BEH, 0E7H, 0BDH
   \            AEBEE7BD
   \   000020   AEE4B88B     DB 0AEH, 0E4H, 0B8H, 8BH, 0E4H, 0B8H, 80H, 0E6H
   \            E4B880E6
   \   000028   ACA1E5AE     DB 0ACH, 0A1H, 0E5H, 0AEH, 9AH, 0E6H, 97H, 0B6H
   \            9AE697B6
   \   000030   E599A82E     DB 0E5H, 99H, 0A8H, 2EH, 2EH, 2EH, 0DH, 0AH
   \            2E2E0D0A
   \   000038   00           DB 0

   \                                 In  segment XDATA_ROM_C, align 1
   \   000000   42726F61     DB "Broadcast"
   \            64636173
   \            7400    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Groupcast">`:
   \   000000   47726F75     DB "Groupcast"
   \            70636173
   \            7400    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "P2P">`:
   \   000000   50325000     DB "P2P"

   \                                 In  segment XDATA_ROM_C, align 1
   \   000000   4E657477     DB "Network formation failed! Retrying...\015\012"
   \            6F726B20
   \            666F726D
   \            6174696F
   \            6E206661
   \            696C6564
   \            21205265
   \            74727969
   \            6E672E2E
   \            2E0D0A00

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "MAC: ">`:
   \   000000   4D41433A     DB "MAC: "
   \            2000    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Network formation suc...">`:
   \   000000   4E657477     DB "Network formation successful!\015\012"
   \            6F726B20
   \            666F726D
   \            6174696F
   \            6E207375
   \            63636573
   \            7366756C
   \            210D0A00

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Network formation fai...">_1`:
   \   000000   4E657477     DB 4EH, 65H, 74H, 77H, 6FH, 72H, 6BH, 20H
   \            6F726B20
   \   000008   666F726D     DB 66H, 6FH, 72H, 6DH, 61H, 74H, 69H, 6FH
   \            6174696F
   \   000010   6E206661     DB 6EH, 20H, 66H, 61H, 69H, 6CH, 65H, 64H
   \            696C6564
   \   000018   21205265     DB 21H, 20H, 52H, 65H, 74H, 72H, 79H, 69H
   \            74727969
   \   000020   6E672069     DB 6EH, 67H, 20H, 69H, 6EH, 20H, 35H, 20H
   \            6E203520
   \   000028   7365636F     DB 73H, 65H, 63H, 6FH, 6EH, 64H, 73H, 2EH
   \            6E64732E
   \   000030   2E2E0D0A     DB 2EH, 2EH, 0DH, 0AH, 0
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Device joined the net...">`:
   \   000000   44657669     DB "Device joined the network!\015\012"
   \            6365206A
   \            6F696E65
   \            64207468
   \            65206E65
   \            74776F72
   \            6B210D0A
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "P2P Data: ">`:
   \   000000   50325020     DB "P2P Data: "
   \            44617461
   \            3A2000  

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant " Count: ">`:
   \   000000   20436F75     DB " Count: "
   \            6E743A20
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Broadcast Data: ">`:
   \   000000   42726F61     DB "Broadcast Data: "
   \            64636173
   \            74204461
   \            74613A20
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Groupcast Data: ">`:
   \   000000   47726F75     DB "Groupcast Data: "
   \            70636173
   \            74204461
   \            74613A20
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3e8:
   \   000000   E8030000     DD 1000

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_bb8:
   \   000000   B80B0000     DD 3000

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_2710:
   \   000000   10270000     DD 10000

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_1388:
   \   000000   88130000     DD 5000
   1142          
   1143          /****************************************************************************
   1144          ****************************************************************************/
   1145          
   1146          

   Maximum stack usage in bytes:

   ISTACK XSTACK Function
   ------ ------ --------
      0      0   zclSampleApp_BatteryWarningCB
      1    227   zclZEM_AF_RxProc
        0     83   -> HalUARTWrite
        0     86   -> osal_memcpy
      2      0   zclZEM_BasicResetCB
        2      0   -> zclZEM_ResetAttributesToDefaultValues
      0     45   zclZEM_Init
        0     39   -> HalUARTOpen
        0     39   -> NLME_PermitJoiningRequest
        0     39   -> RegisterForKeys
        0     39   -> RegisterVoltageWarningCB
        0     39   -> bdb_RegisterCommissioningStatusCB
        0     39   -> bdb_RegisterSimpleDescriptor
        0     45   -> bdb_RepAddAttrCfgRecordDefaultToList
        0     39   -> bdb_StartCommissioning
        0     43   -> osal_start_timerEx
        0     39   -> zclGeneral_RegisterCmdCallbacks
        0     39   -> zclZEM_ReadAndSendMAC
        0     39   -> zclZEM_ResetAttributesToDefaultValues
        0     39   -> zcl_registerAttrList
        0     39   -> zcl_registerForMsg
      2    118   zclZEM_ProcessCommissioningStatus
        2    114   -> HalUARTWrite
        2    114   -> bdb_StartCommissioning
        2    118   -> osal_start_timerEx
      2      9   zclZEM_ProcessInDiscCmdsRspCmd
      0    150   zclZEM_ProcessIncomingMsg
        0      9   -> osal_mem_free
        0      9   -> zclZEM_ProcessInDiscCmdsRspCmd
      1    110   zclZEM_ReadAndSendMAC
        0     68   -> HalUARTWrite
        0     68   -> NLME_GetExtAddr
        0     71   -> osal_memcpy
      0      9   zclZEM_UartCB
        0      9   -> HalUARTRead
        0      9   -> HalUARTWrite
        0      9   -> Hal_UART_RxBufLen
      0    150   zclZEM_event_loop
        0    150   -> AF_DataRequest
        0    141   -> HalLedBlink
        0    141   -> HalUARTWrite
        0    141   -> osal_msg_deallocate
        0    141   -> osal_msg_receive
        0    145   -> osal_start_timerEx
        0    141   -> zclZEM_AF_RxProc
        0    141   -> zclZEM_ProcessIncomingMsg


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
       9  ?<Constant " Count: ">
      17  ?<Constant "Broadcast Data: ">
      10  ?<Constant "Broadcast">
      29  ?<Constant "Device joined the net...">
      17  ?<Constant "Groupcast Data: ">
      10  ?<Constant "Groupcast">
      57  ?<Constant "LED\351\227\252\347\203\201\345\22
       6  ?<Constant "MAC: ">
      40  ?<Constant "Network formation fai...">
      53  ?<Constant "Network formation fai...">_1
      32  ?<Constant "Network formation suc...">
      11  ?<Constant "P2P Data: ">
       4  ?<Constant "P2P">
      46  ?<Constant "ZEMAPP_EVT\344\272\213\344\273\266
       7  ?<Initializer for ZEM_AppEp>
       4  ?<Initializer for reportableChange>
      18  ?<Initializer for zclZEM_CmdCallbacks>
       8  ??Subroutine15_0
       4  ??Subroutine16_0
      16  ??Subroutine17_0
       8  ?Subroutine0
       5  ?Subroutine1
      11  ?Subroutine10
      11  ?Subroutine11
      17  ?Subroutine12
      15  ?Subroutine13
      10  ?Subroutine14
       7  ?Subroutine2
       8  ?Subroutine3
      19  ?Subroutine4
      12  ?Subroutine5
       8  ?Subroutine6
      16  ?Subroutine7
       4  ?Subroutine8
       9  ?Subroutine9
       1  P1DIR
       1  P1SEL
       1  PERCFG
       7  ZEM_AppEp
       4  __Constant_1388
       4  __Constant_2710
       4  __Constant_3e8
       4  __Constant_bb8
       1  bcCnt
       1  gcCnt
       1  p2pCnt
       4  reportableChange
       1  transferId
       1  transferId
       1  transferId
       3  zclSampleApp_BatteryWarningCB
       6  zclSampleApp_BatteryWarningCB::?relay
     464  zclZEM_AF_RxProc
       6  zclZEM_AF_RxProc::?relay
       9  zclZEM_BasicResetCB
       6  zclZEM_BasicResetCB::?relay
      18  zclZEM_CmdCallbacks
     330  zclZEM_Init
       6  zclZEM_Init::?relay
       1  zclZEM_NwkState
     148  zclZEM_ProcessCommissioningStatus
       6  zclZEM_ProcessCommissioningStatus::?relay
      37  zclZEM_ProcessInDiscCmdsRspCmd
       6  zclZEM_ProcessInDiscCmdsRspCmd::?relay
     126  zclZEM_ProcessIncomingMsg
       6  zclZEM_ProcessIncomingMsg::?relay
     241  zclZEM_ReadAndSendMAC
       6  zclZEM_ReadAndSendMAC::?relay
       1  zclZEM_TaskID
      64  zclZEM_UartBuf
      39  zclZEM_UartCB
       6  zclZEM_UartCB::?relay
     519  zclZEM_event_loop
       6  zclZEM_event_loop::?relay

 
 2 104 bytes in segment BANKED_CODE
    60 bytes in segment BANK_RELAYS
     3 bytes in segment SFR_AN
    29 bytes in segment XDATA_I
    29 bytes in segment XDATA_ID
   357 bytes in segment XDATA_ROM_C
    72 bytes in segment XDATA_Z
 
    89 bytes of CODE     memory
   341 bytes of CONST    memory (+ 16 bytes shared)
     0 bytes of DATA     memory (+  3 bytes shared)
 2 104 bytes of HUGECODE memory
   101 bytes of XDATA    memory

Errors: none
Warnings: 1
