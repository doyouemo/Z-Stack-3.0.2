###############################################################################
#
# IAR C/C++ Compiler V10.10.1.4655 for 8051               12/Nov/2024  16:24:09
# Copyright 2004-2017 IAR Systems AB.
# Standalone license - IAR Embedded Workbench for 8051
#
#    Core               =  plain
#    Code model         =  banked
#    Data model         =  large
#    Calling convention =  xdata reentrant
#    Constant location  =  data_rom
#    Dptr setup         =  1,16
#                          
#    Source file        =  
#        D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\Source\zcl_samplesw.c
#    Command line       =  
#        -f C:\Users\ASUS\AppData\Local\Temp\EW3285.tmp ("D:\Z-Stack
#        3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\Source\zcl_samplesw.c"
#        -D SECURE=1 -D TC_LINKKEY_JOIN -D NV_INIT -D NV_RESTORE -D
#        xPOWER_SAVING -D NWK_AUTO_POLL -D xZTOOL_P1 -D xMT_TASK -D
#        xMT_APP_FUNC -D xMT_SYS_FUNC -D xMT_ZDO_FUNC -D xMT_ZDO_MGMT -D
#        xMT_APP_CNF_FUNC -D LCD_SUPPORTED=DEBUG -D MULTICAST_ENABLED=FALSE -D
#        ZCL_READ -D ZCL_DISCOVER -D ZCL_WRITE -D ZCL_BASIC -D ZCL_IDENTIFY -D
#        ZCL_ON_OFF -D ZCL_GROUPS -D ZCL_REPORTING_DEVICE -lC "D:\Z-Stack
#        3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\EndDeviceEB\List"
#        -lA "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\EndDeviceEB\List"
#        --diag_suppress Pe001,Pa010 -o "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\EndDeviceEB\Obj"
#        -e --debug --core=plain --dptr=16,1 --data_model=large
#        --code_model=banked --calling_convention=xdata_reentrant
#        --place_constants=data_rom --nr_virtual_regs 16 -f "D:\Z-Stack
#        3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\Tools\CC2530DB\f8wEndev.cfg"
#        (-DCPU32MHZ -DROOT=__near_func -DMAC_CFG_TX_DATA_MAX=3
#        -DMAC_CFG_TX_MAX=6 -DMAC_CFG_RX_MAX=3) -f "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\Tools\CC2530DB\f8wConfig.cfg"
#        (-DZIGBEEPRO -DSECURE=1 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR
#        -DDEFAULT_CHANLIST=0x00000800 -DZDAPP_CONFIG_PAN_ID=0x1234
#        -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MASK=0x007F
#        -DBEACON_REQUEST_DELAY=100 -DBEACON_REQ_DELAY_MASK=0x00FF
#        -DLINK_STATUS_JITTER_MASK=0x007F -DROUTE_EXPIRY_TIME=30
#        -DAPSC_ACK_WAIT_DURATION_POLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7
#        -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3
#        -DNWK_MAX_DATA_RETRIES=2 -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9
#        -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40 -DNWK_MAX_BINDING_ENTRIES=4
#        -DMAX_BINDING_CLUSTER_IDS=4 -DDEFAULT_KEY={0} -DMAC_MAX_FRAME_SIZE=116
#        -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const __code"
#        -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000
#        -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100 -DREJOIN_POLL_RATE=440
#        -DREJOIN_BACKOFF=900000 -DREJOIN_SCAN=900000 -DENABLE_LED4_DISABLE_S1)
#        -f "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\Tools\CC2530DB\f8wZCL.cfg"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\" -I
#        "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\Source\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\Source\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\ZMain\TI2530DB\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\hal\include\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\hal\target\CC2530EB\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\mac\include\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\mac\high_level\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\single_chip\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\mt\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\osal\include\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\services\saddr\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\services\sdata\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\af\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\bdb\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\gp\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\nwk\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\sapi\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\sec\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\sys\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\zcl\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\stack\zdo\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\zmac\"
#        -I "D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\Components\zmac\f8w\"
#        -Ohz --require_prototypes)
#    Locale             =  Chinese (Simplified)_China.936
#    List file          =  
#        D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\EndDeviceEB\List\zcl_samplesw.lst
#    Object file        =  
#        D:\Z-Stack 3.0.2\Z-Stack
#        3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\CC2530DB\EndDeviceEB\Obj\zcl_samplesw.r51
#
###############################################################################

D:\Z-Stack 3.0.2\Z-Stack 3.0.2\Projects\zstack\HomeAutomation\SampleSwitch\Source\zcl_samplesw.c
      1          /**************************************************************************************************
      2            Filename:       zcl_samplesw.c
      3            Revised:        $Date: 2015-08-19 17:11:00 -0700 (Wed, 19 Aug 2015) $
      4            Revision:       $Revision: 44460 $
      5          
      6            Description:    Zigbee Cluster Library - sample switch application.
      7          
      8          
      9            Copyright 2006-2013 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED AS IS? WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /*********************************************************************
     41            This application implements a ZigBee On/Off Switch, based on Z-Stack 3.0.
     42          
     43            This application is based on the common sample-application user interface. Please see the main
     44            comment in zcl_sampleapp_ui.c. The rest of this comment describes only the content specific for
     45            this sample applicetion.
     46            
     47            Application-specific UI peripherals being used:
     48          
     49            - none (LED1 is currently unused by this application).
     50          
     51            Application-specific menu system:
     52          
     53              <TOGGLE LIGHT> Send an On, Off or Toggle command targeting appropriate devices from the binding table.
     54                Pressing / releasing [OK] will have the following functionality, depending on the value of the 
     55                zclSampleSw_OnOffSwitchActions attribute:
     56                - OnOffSwitchActions == 0: pressing [OK] will send ON command, releasing it will send OFF command;
     57                - OnOffSwitchActions == 1: pressing [OK] will send OFF command, releasing it will send ON command;
     58                - OnOffSwitchActions == 2: pressing [OK] will send TOGGLE command, releasing it will not send any command.
     59          
     60          *********************************************************************/
     61          
     62          #if ! defined ZCL_ON_OFF
     63          #error ZCL_ON_OFF must be defined for this project.
     64          #endif
     65          
     66          /*********************************************************************
     67           * INCLUDES
     68           */
     69          #include <stdio.h>
     70          #include "ZComDef.h"
     71          #include "OSAL.h"
     72          #include "AF.h"
     73          #include "ZDApp.h"
     74          #include "ZDObject.h"
     75          #include "ZDProfile.h"
     76          #include "MT_SYS.h"
     77          
     78          #include "zcl.h"
     79          #include "zcl_general.h"
     80          #include "zcl_ha.h"
     81          #include "zcl_samplesw.h"
     82          #include "zcl_diagnostic.h"
     83          
     84          #include "onboard.h"
     85          
     86          /* HAL */
     87          #include "hal_lcd.h"
     88          #include "hal_led.h"
     89          #include "hal_key.h"
     90          
     91          #if defined (OTA_CLIENT) && (OTA_CLIENT == TRUE)
     92          #include "zcl_ota.h"
     93          #include "hal_ota.h"
     94          #endif
     95          
     96          #include "bdb.h"
     97          #include "bdb_interface.h"
     98          
     99          #include "zcl_sampleapps_ui.h"
    100          
    101          /*********************************************************************
    102           * MACROS
    103           */
    104          #define UI_STATE_TOGGLE_LIGHT 1 //UI_STATE_BACK_FROM_APP_MENU is item #0, so app item numbers should start from 1
    105          
    106          #define APP_TITLE "TI Sample Switch"
    107          
    108          /*********************************************************************
    109           * TYPEDEFS
    110           */
    111          #define CLUSTER_P2P             0
    112          #define CLUSTER_BROADCAST       1
    113          #define CLUSTER_GROUPCAST       2
    114          /*********************************************************************
    115           * GLOBAL VARIABLES
    116           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    117          byte zclSampleSw_TaskID;
   \                     zclSampleSw_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    118          
    119          // 在适当的头文件或源文件中添加

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    120          uint16 zclSampleSw_TestAddr;  // 确保定义类型与实际使用一致
   \                     zclSampleSw_TestAddr:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    121          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    122          uint8 zclSampleSwSeqNum;
   \                     zclSampleSwSeqNum:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    123          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    124          uint8 zclSampleSw_OnOffSwitchType = ON_OFF_SWITCH_TYPE_MOMENTARY;
   \                     zclSampleSw_OnOffSwitchType:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for zclSampleSw_OnOffSwitchType>`
   \   000001                REQUIRE __INIT_XDATA_I
    125          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    126          uint8 zclSampleSw_OnOffSwitchActions;
   \                     zclSampleSw_OnOffSwitchActions:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    127          
    128          /*********************************************************************
    129           * GLOBAL FUNCTIONS
    130           */
    131          
    132          /*********************************************************************
    133           * LOCAL VARIABLES
    134           */
    135          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    136          afAddrType_t zclSampleSw_DstAddr;
   \                     zclSampleSw_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z
    137          // GroupId
    138          #define GROUP_ID                21
    139          // Endpoint to allow SYS_APP_MSGs

   \                                 In  segment XDATA_I, align 1, keep-with-next
    140          static endPointDesc_t sampleSw_TestEp =
   \                     sampleSw_TestEp:
   \   000000                DS 7
   \   000007                REQUIRE `?<Initializer for sampleSw_TestEp>`
   \   000007                REQUIRE __INIT_XDATA_I
    141          {
    142            SAMPLESW_ENDPOINT,                  // endpoint
    143            0,
    144            &zclSampleSw_TaskID,
    145            (SimpleDescriptionFormat_t *)NULL,  // No Simple description for this test endpoint
    146            (afNetworkLatencyReq_t)0            // No Network Latency req
    147          };
    148          
    149          
    150          /*
    151          * @param destNwkAddr 目标设备的网络地址
    152          * @param cid Cluster ID，后续课程将会详细讲解
    153          * @param len 数据长度
    154          * @param data 数据内容
    155          */
    156          static void zclSampleSw_AF_P2P(
    157          	uint16 destNwkAddr, 
    158          	uint16 cid, 
    159          	uint8 len, 
    160          	uint8 *data)
    161          {    
    162          	afAddrType_t dstAddr; //寻址信息配置 

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    163          	static uint8 transferId = 0;//传输ID，是数据包的标识符
    164          
    165          	/* Destination */    
    166          	dstAddr.addrMode = afAddr16Bit;// 设置目标地址模式为16位网络地址，表示使用P2P的通信方式
    167          	dstAddr.addr.shortAddr = destNwkAddr;//目标设备的网络地址  
    168          	dstAddr.endPoint = SAMPLESW_ENDPOINT;//目标设备的端点号
    169          
    170          	 transferId++;    
    171          	AF_DataRequest(&dstAddr, 
    172          		&sampleSw_TestEp,//已经创建好的简单描述符
    173          		cid,    
    174          		len, 
    175          		data,    
    176          		&transferId,
    177          		AF_DISCV_ROUTE,//进行路由扫描操作，用于建立发送数据报文的通信路径。关于这个参数，暂时保持例程默认的代码就可以了
    178          		AF_DEFAULT_RADIUS);//指定最大的路由跳转级数
    179          }
    180          
    181          /*
    182          * @param cid Cluster ID
    183          * @param len 待发送数据的长度
    184          * @param *data 待发送数据的内容
    185          */
    186          static void zclSampleSw_AF_Broadcast(
                             ^
Warning[Pe177]: function "zclSampleSw_AF_Broadcast" was declared but never
          referenced
    187          	uint16 cid,
    188          	uint8 len,
    189          	uint8 *data)
    190          {
    191          	afAddrType_t dstAddr;  
    192          	static uint8 transferId = 0;  
    193          
    194          	/* Destination */  
    195          	dstAddr.addrMode = afAddrBroadcast;   // 使用广播模式
    196          	dstAddr.addr.shortAddr = 0xFFFF; // 广播地址
    197          	dstAddr.endPoint = SAMPLESW_ENDPOINT; // 目标设备的端点号
    198          	
    199          	 /* Transfer id */  
    200          	transferId++;  
    201          	
    202          	/* Send */  
    203          	AF_DataRequest(
    204          		&dstAddr, 
    205          		&sampleSw_TestEp,//已经创建好的简单描述符
    206          		cid,  
    207          		len, 
    208          		data,  
    209          		&transferId,
    210          		AF_TX_OPTIONS_NONE,
    211          		AF_DEFAULT_RADIUS );//指定了最大的路由跳转级数
    212          }
    213          
    214          /*
    215          * @param groupId 组ID
    216          * @param cid ClusterID，后续章节将会详细讲解
    217          * @param len 待发送数据的长度
    218          * @param data 待发送数据的内容
    219          */
    220          static void zclSampleSw_AF_Groupcast(
                             ^
Warning[Pe177]: function "zclSampleSw_AF_Groupcast" was declared but never
          referenced
    221          	uint16 groupId,
    222          	uint16 cid,
    223          	uint8 len,
    224          	uint8 *data)
    225          {    
    226          	afAddrType_t dstAddr;    
    227          	static uint8 transferId = 0;    
    228          
    229          	/* Destination */    
    230              dstAddr.addrMode = afAddrGroup;//使用组播通信模式
    231          	dstAddr.addr.shortAddr = groupId;
    232          	dstAddr.endPoint = SAMPLESW_ENDPOINT;//组中的设备的端点号
    233          	
    234          	/* Transfer id */    
    235          	transferId++;   
    236           
    237          	/* Send */    
    238          	AF_DataRequest(&dstAddr, 
    239          		&sampleSw_TestEp,//已经创建好的简单描述符
    240          		cid, 
    241          		len, 
    242          		data,    
    243          		&transferId, 
    244          		AF_TX_OPTIONS_NONE,
    245          		AF_DEFAULT_RADIUS );//指定最大的路由跳转级数，暂时可忽略
    246          }
    247          
    248          /*
    249          * @param MSGpkt 接收到数据
    250          */
    251          static void zclSampleSw_AF_RxProc(afIncomingMSGPacket_t *MSGpkt)
    252          {
    253          	/*计数器，记录接收到的点对点通信数据包个数*/

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    254          	static uint8 p2pCnt = 0;
   \                     ??p2pCnt:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    255          
    256          	/*计数器，记录接收到的广播通信数据包个数*/

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    257          	static uint8 bcCnt = 0;
   \                     ??bcCnt:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    258          
    259          	/*计数器，记录接收到的组播通信数据包个数*/

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    260          	static uint8 gcCnt = 0;  
   \                     ??gcCnt:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    261          	
    262          	switch( MSGpkt->clusterId )  // 判断接收到的数据包的Cluster ID，后续章节将会详细讲解Cluster ID
    263          	{  
    264          		case CLUSTER_P2P:
    265          			p2pCnt++;  // 接收到P2P数据包，进行计数
    266          		
    267          			// 把接收到的数据和计数器的值显示在屏幕上
    268          			HalLcdWriteStringValue((char *)MSGpkt->cmd.Data,p2pCnt,10,3);
    269          			break;  
    270          		 
    271          		case CLUSTER_BROADCAST:  
    272          			bcCnt++;  // 接收到广播数据包，进行计数
    273          			HalLcdWriteStringValue((char *)MSGpkt->cmd.Data,bcCnt,10,3);  
    274          			break;  
    275          		 
    276          		case CLUSTER_GROUPCAST:  
    277          			gcCnt++;  // 接收到组播数据包，进行计数
    278          			HalLcdWriteStringValue((char *)MSGpkt->cmd.Data,gcCnt,10,4);  
    279          			break;  
    280          		
    281          		default:  
    282          			break;  
    283          	}  
    284          }
    285          static void zclSampleSw_ReadTest(void)  
                             ^
Warning[Pe177]: function "zclSampleSw_ReadTest" was declared but never
          referenced
    286          {  
    287              afAddrType_t destAddr;  
    288              zclReadCmd_t *readCmd;  
    289              static uint8 txID = 0;  
    290                
    291              destAddr.endPoint = SAMPLESW_ENDPOINT;  
    292              destAddr.addrMode = afAddr16Bit;  
    293              destAddr.addr.shortAddr = zclSampleSw_TestAddr;  
    294            
    295               //申请一个动态内存
    296             readCmd = (zclReadCmd_t *)osal_mem_alloc(sizeof(zclReadCmd_t) +                                                sizeof(uint16));
    297          
    298             if(readCmd == NULL)//判断是否成功申请到内存
    299                return;  
    300          
    301              readCmd->numAttr = 1;//待读取的属性数量为1
    302              readCmd->attrID[0] = ATTRID_ON_OFF_SWITCH_ACTIONS;//待读取的属性ID
    303                
    304              zcl_SendRead(SAMPLESW_ENDPOINT,  
    305                           &destAddr,  
    306                           ZCL_CLUSTER_ID_GEN_ON_OFF_SWITCH_CONFIG,//Cluster ID  
    307                           readCmd,  
    308                           ZCL_FRAME_CLIENT_SERVER_DIR,//通信方向是由客户端到服务器端
    309                           TRUE,
    310                           txID++);  
    311               osal_mem_free(readCmd);//释放内存
    312          }
    313          
    314          
    315          static void zclSampleSw_WriteTest(void)  
                             ^
Warning[Pe177]: function "zclSampleSw_WriteTest" was declared but never
          referenced
    316          {  
    317              afAddrType_t destAddr;  
    318              zclWriteCmd_t *writeCmd;  
    319              static uint8 txID = 0;  
    320                
    321              destAddr.endPoint = SAMPLESW_ENDPOINT;  
    322              destAddr.addrMode = afAddr16Bit;  
    323              destAddr.addr.shortAddr = zclSampleSw_TestAddr;  
    324                
    325              writeCmd=(zclWriteCmd_t *)osal_mem_alloc(sizeof(zclWriteCmd_t) +                                             sizeof(zclWriteRec_t));//申请一个动态内存
    326              if(writeCmd == NULL)//判断动态内存是否申请成功
    327                  return;  
    328                
    329              writeCmd->attrList[0].attrData=(uint8*)osal_mem_alloc(sizeof(uint8));//申请一个动态内存    
    330              if(writeCmd->attrList[0].attrData == NULL)//判断动态内存是否申请成功  
    331                  return;  
    332                
    333              writeCmd->numAttr = 1;//待写入的属性数量
    334              writeCmd->attrList[0].attrID =ATTRID_ON_OFF_SWITCH_ACTIONS;//待写入的属性的ID
    335              writeCmd->attrList[0].dataType = ZCL_DATATYPE_ENUM8;//属性值的类型
    336              *(writeCmd->attrList[0].attrData) = txID;//属性值
    337          
    338              HalLcdWriteStringValue("Write:", txID, 10, 4);  
    339              
    340              zcl_SendWrite(SAMPLESW_ENDPOINT,  
    341                  &destAddr,  
    342                  ZCL_CLUSTER_ID_GEN_ON_OFF_SWITCH_CONFIG,//Cluster ID 
    343                  writeCmd,  
    344                  ZCL_FRAME_CLIENT_SERVER_DIR,//通信方向是由客户端到服务器端
    345                  TRUE,
    346                  txID++);  
    347          
    348              osal_mem_free(writeCmd->attrList[0].attrData); // 释放内存
    349              osal_mem_free(writeCmd);  // 释放内存 
    350          }
    351          
    352          #ifdef ZDO_COORDINATOR
    353          static void zclSampleSw_processZDOMgs(zdoIncomingMsg_t *pMsg)
    354          {
    355            switch (pMsg->clusterID)
    356            {
    357              case Device_annce:
    358              {
    359                zclSampleSw_TestAddr = pMsg->srcAddr.addr.shortAddr;
    360                HalLcdWriteStringValue("Node:",pMsg->srcAddr.addr.shortAddr,10,0);
    361                HalLcdWriteString("Test...",4);
    362          
    363                osal_start_timerEx(zclSampleSw_TaskID,
    364                                    SAMPLEAPP_READ_EVT,
    365                                    SAMPLEAPP_READ_PERIOD);
    366              }
    367              break;
    368              default:
    369              break;
    370            }
    371          }
    372          #endif
    373          
    374          /*
    375           * 数据上报事件的处理函数，用于上报数据
    376           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    377          static void zclSampleSw_ReportTest(void)
   \                     zclSampleSw_ReportTest:
    378          {  
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000   74F4         MOV       A,#-0xc
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 12
   \   000005   74F4         MOV       A,#-0xc
   \   000007   12....       LCALL     ?ALLOC_XSTACK8
    379              static uint8 seqNum = 0;  
    380              zclReportCmd_t *reportCmd;  
    381          
    382              //目标设备的地址信息
    383              afAddrType_t destAddr;  
    384              destAddr.addrMode = afAddr16Bit;
   \   00000A   7408         MOV       A,#0x8
   \   00000C   12....       LCALL     ?XSTACK_DISP0_8
   \   00000F   7402         MOV       A,#0x2
   \   000011   F0           MOVX      @DPTR,A
    385              destAddr.endPoint = SAMPLESW_ENDPOINT;
   \   000012   7409         MOV       A,#0x9
   \   000014   12....       LCALL     ?XSTACK_DISP0_8
   \   000017   7408         MOV       A,#0x8
   \   000019   F0           MOVX      @DPTR,A
    386              destAddr.addr.shortAddr = 0x0000;//0x0000表示协调器的网络地址
   \   00001A   85..82       MOV       DPL,?XSP + 0
   \   00001D   85..83       MOV       DPH,?XSP + 1
   \   000020   E4           CLR       A
   \   000021   F0           MOVX      @DPTR,A
   \   000022   A3           INC       DPTR
   \   000023   F0           MOVX      @DPTR,A
    387          
    388          reportCmd = (zclReportCmd_t *)osal_mem_alloc(sizeof(zclReportCmd_t)+sizeof(zclReport_t));//申请内存空间
   \   000024                ; Setup parameters for call to function osal_mem_alloc
   \   000024   7A06         MOV       R2,#0x6
   \   000026   FB           MOV       R3,A
   \   000027   12....       LCALL     `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
   \   00002A   8A..         MOV       ?V0,R2
   \   00002C   8B..         MOV       ?V1,R3
    389          
    390              if(reportCmd == NULL)//判断内存空间是否申请成功
   \   00002E   EA           MOV       A,R2
   \   00002F   45..         ORL       A,?V1
   \   000031   7003         JNZ       $+5
   \   000033   02....       LJMP      ??zclSampleSw_ReportTest_0 & 0xFFFF
    391                   return;  
    392          
    393              reportCmd->attrList[0].attrData = (uint8 *)osal_mem_alloc(sizeof(uint8));//申请内存空间
   \   000036                ; Setup parameters for call to function osal_mem_alloc
   \   000036   7A01         MOV       R2,#0x1
   \   000038   7B00         MOV       R3,#0x0
   \   00003A   12....       LCALL     `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
   \   00003D   E5..         MOV       A,?V0
   \   00003F   2404         ADD       A,#0x4
   \   000041   F8           MOV       R0,A
   \   000042   E4           CLR       A
   \   000043   35..         ADDC      A,?V1
   \   000045   F9           MOV       R1,A
   \   000046   E8           MOV       A,R0
   \   000047   FE           MOV       R6,A
   \   000048   E9           MOV       A,R1
   \   000049   FF           MOV       R7,A
   \   00004A   EA           MOV       A,R2
   \   00004B   F8           MOV       R0,A
   \   00004C   EB           MOV       A,R3
   \   00004D   F9           MOV       R1,A
   \   00004E   8E82         MOV       DPL,R6
   \   000050   8F83         MOV       DPH,R7
   \   000052   E8           MOV       A,R0
   \   000053   F0           MOVX      @DPTR,A
   \   000054   A3           INC       DPTR
   \   000055   E9           MOV       A,R1
   \   000056   F0           MOVX      @DPTR,A
    394          
    395              if(reportCmd->attrList[0].attrData == NULL)//判断内存空间是否申请成功
   \   000057   EA           MOV       A,R2
   \   000058   4B           ORL       A,R3
   \   000059   7003         JNZ       $+5
   \   00005B   02....       LJMP      ??zclSampleSw_ReportTest_0 & 0xFFFF
    396                  return;  
    397          
    398              reportCmd->numAttr = 1;//属性数量为1
   \   00005E   85..82       MOV       DPL,?V0
   \   000061   85..83       MOV       DPH,?V1
   \   000064   7401         MOV       A,#0x1
   \   000066   F0           MOVX      @DPTR,A
    399              reportCmd->attrList[0].attrID = ATTRID_ON_OFF_SWITCH_TYPE;//属性ID
   \   000067   A3           INC       DPTR
   \   000068   E4           CLR       A
   \   000069   F0           MOVX      @DPTR,A
   \   00006A   A3           INC       DPTR
   \   00006B   F0           MOVX      @DPTR,A
    400              reportCmd->attrList[0].dataType = ZCL_DATATYPE_ENUM8;//数据类型
   \   00006C   85..82       MOV       DPL,?V0
   \   00006F   85..83       MOV       DPH,?V1
   \   000072   A3           INC       DPTR
   \   000073   A3           INC       DPTR
   \   000074   A3           INC       DPTR
   \   000075   7430         MOV       A,#0x30
   \   000077   F0           MOVX      @DPTR,A
    401              *((uint8 *)(reportCmd->attrList[0].attrData)) = seqNum;//属性值
   \   000078   90....       MOV       DPTR,#??seqNum
   \   00007B   E0           MOVX      A,@DPTR
   \   00007C   C0E0         PUSH      A
   \   00007E   8E82         MOV       DPL,R6
   \   000080   8F83         MOV       DPH,R7
   \   000082   12....       LCALL     ?Subroutine4 & 0xFFFF
   \                     ??CrossCallReturnLabel_0:
   \   000085   D0E0         POP       A
   \   000087   F0           MOVX      @DPTR,A
    402          
    403              //上报数据
    404              zcl_SendReportCmd(SAMPLESW_ENDPOINT,//源端点号
    405                  &destAddr,//地址信息
    406                  ZCL_CLUSTER_ID_GEN_ON_OFF_SWITCH_CONFIG,//Cluster ID
    407                  reportCmd,
    408                  ZCL_FRAME_CLIENT_SERVER_DIR,//通信方向为从客户端到服务端
    409                  TRUE,//关闭默认响应（目标设备的响应）
    410                   seqNum++ );//数据包标号，每上报一次数据seqNum的值就会增加1
   \   000088   90....       MOV       DPTR,#??seqNum
   \   00008B   E0           MOVX      A,@DPTR
   \   00008C   F8           MOV       R0,A
   \   00008D   7401         MOV       A,#0x1
   \   00008F   28           ADD       A,R0
   \   000090   F0           MOVX      @DPTR,A
   \   000091                ; Setup parameters for call to function zcl_SendReportCmd
   \   000091   E8           MOV       A,R0
   \   000092   F5..         MOV       ?V2,A
   \   000094   78..         MOV       R0,#?V2
   \   000096   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000099   75..01       MOV       ?V2,#0x1
   \   00009C   78..         MOV       R0,#?V2
   \   00009E   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   0000A1   75..00       MOV       ?V2,#0x0
   \   0000A4   78..         MOV       R0,#?V2
   \   0000A6   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   0000A9   78..         MOV       R0,#?V0
   \   0000AB   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000AE   7C07         MOV       R4,#0x7
   \   0000B0   7D00         MOV       R5,#0x0
   \   0000B2   7405         MOV       A,#0x5
   \   0000B4   12....       LCALL     ?XSTACK_DISP101_8
   \   0000B7   7908         MOV       R1,#0x8
   \   0000B9   12....       LCALL     `??zcl_SendReportCmd::?relay`; Banked call to: zcl_SendReportCmd
   \   0000BC   7405         MOV       A,#0x5
   \   0000BE   12....       LCALL     ?DEALLOC_XSTACK8
    411          
    412              HalLcdWriteStringValue("Report: ", (seqNum-1), 10, 4);//显示
   \   0000C1                ; Setup parameters for call to function HalLcdWriteStringValue
   \   0000C1   75..04       MOV       ?V2,#0x4
   \   0000C4   78..         MOV       R0,#?V2
   \   0000C6   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   0000C9   790A         MOV       R1,#0xa
   \   0000CB   90....       MOV       DPTR,#??seqNum
   \   0000CE   E0           MOVX      A,@DPTR
   \   0000CF   24FF         ADD       A,#-0x1
   \   0000D1   FC           MOV       R4,A
   \   0000D2   E4           CLR       A
   \   0000D3   34FF         ADDC      A,#-0x1
   \   0000D5   FD           MOV       R5,A
   \   0000D6   7A..         MOV       R2,#`?<Constant "Report: ">` & 0xff
   \   0000D8   7B..         MOV       R3,#(`?<Constant "Report: ">` >> 8) & 0xff
   \   0000DA   12....       LCALL     `??HalLcdWriteStringValue::?relay`; Banked call to: HalLcdWriteStringValue
   \   0000DD   7401         MOV       A,#0x1
   \   0000DF   12....       LCALL     ?DEALLOC_XSTACK8
    413          
    414              // 释放内存空间！
    415              osal_mem_free(reportCmd->attrList[0].attrData);  
   \   0000E2                ; Setup parameters for call to function osal_mem_free
   \   0000E2   8E82         MOV       DPL,R6
   \   0000E4   8F83         MOV       DPH,R7
   \   0000E6   E0           MOVX      A,@DPTR
   \   0000E7   FA           MOV       R2,A
   \   0000E8   A3           INC       DPTR
   \   0000E9   E0           MOVX      A,@DPTR
   \   0000EA   FB           MOV       R3,A
   \   0000EB   12....       LCALL     `??osal_mem_free::?relay`; Banked call to: osal_mem_free
    416              osal_mem_free(reportCmd);
   \   0000EE                ; Setup parameters for call to function osal_mem_free
   \   0000EE   AA..         MOV       R2,?V0
   \   0000F0   AB..         MOV       R3,?V1
   \   0000F2   12....       LCALL     `??osal_mem_free::?relay`; Banked call to: osal_mem_free
    417          }
   \                     ??zclSampleSw_ReportTest_0:
   \   0000F5   740C         MOV       A,#0xc
   \   0000F7   12....       LCALL     ?DEALLOC_XSTACK8
   \   0000FA                REQUIRE ?Subroutine0
   \   0000FA                ; // Fall through to label ?Subroutine0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   7F04         MOV       R7,#0x4
   \   000002   02....       LJMP      ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   E0           MOVX      A,@DPTR
   \   000001   F8           MOV       R0,A
   \   000002   A3           INC       DPTR
   \   000003   E0           MOVX      A,@DPTR
   \   000004   F583         MOV       DPH,A
   \   000006   8882         MOV       DPL,R0
   \   000008   22           RET

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??seqNum:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    418          
    419          
    420          //static uint8 aProcessCmd[] = { 1, 0, 0, 0 }; // used for reset command, { length + cmd0 + cmd1 + data }
    421          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    422          devStates_t zclSampleSw_NwkState = DEV_INIT;
   \                     zclSampleSw_NwkState:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for zclSampleSw_NwkState>`
   \   000001                REQUIRE __INIT_XDATA_I
    423          
    424          #if defined (OTA_CLIENT) && (OTA_CLIENT == TRUE)
    425          #define DEVICE_POLL_RATE                 8000   // Poll rate for end device
    426          #endif
    427          
    428          #define SAMPLESW_TOGGLE_TEST_EVT   0x1000
    429          /*********************************************************************
    430           * LOCAL FUNCTIONS
    431           */
    432          static void zclSampleSw_HandleKeys( byte shift, byte keys );
    433          static void zclSampleSw_BasicResetCB( void );
    434          
    435          static void zclSampleSw_ProcessCommissioningStatus(bdbCommissioningModeMsg_t *bdbCommissioningModeMsg);
    436          
    437          
    438          // Functions to process ZCL Foundation incoming Command/Response messages
    439          static void zclSampleSw_ProcessIncomingMsg( zclIncomingMsg_t *msg );
    440          #ifdef ZCL_READ
    441          static uint8 zclSampleSw_ProcessInReadRspCmd( zclIncomingMsg_t *pInMsg );
    442          #endif
    443          #ifdef ZCL_WRITE
    444          static uint8 zclSampleSw_ProcessInWriteRspCmd( zclIncomingMsg_t *pInMsg );
    445          #endif
    446          static uint8 zclSampleSw_ProcessInDefaultRspCmd( zclIncomingMsg_t *pInMsg );
    447          #ifdef ZCL_DISCOVER
    448          static uint8 zclSampleSw_ProcessInDiscCmdsRspCmd( zclIncomingMsg_t *pInMsg );
    449          static uint8 zclSampleSw_ProcessInDiscAttrsRspCmd( zclIncomingMsg_t *pInMsg );
    450          static uint8 zclSampleSw_ProcessInDiscAttrsExtRspCmd( zclIncomingMsg_t *pInMsg );
    451          #endif
    452          
    453          #if defined (OTA_CLIENT) && (OTA_CLIENT == TRUE)
    454          static void zclSampleSw_ProcessOTAMsgs( zclOTA_CallbackMsg_t* pMsg );
    455          #endif
    456          
    457          void zclSampleSw_UiActionToggleLight(uint16 keys);
    458          void zclSampleSw_UiUpdateLcd(uint8 uiCurrentState, char * line[3]);
    459          
    460          static void zclSampleApp_BatteryWarningCB( uint8 voltLevel);
    461          
    462          
    463          /*********************************************************************
    464           * CONSTANTS
    465           */

   \                                 In  segment XDATA_ROM_C, align 1
    466            const uiState_t zclSampleSw_UiStatesMain[] = 
   \                     zclSampleSw_UiStatesMain:
   \   000000   FE           DB 254
   \   000001   01           DB 1
   \   000002   0400         DW 4
   \   000004   ....         DW `??UI_ActionBackFromAppMenu::?relay`
   \   000006   00           DB 0
   \   000007   FE           DB 254
   \   000008   0404         DW 1028
   \   00000A   ....         DW `??zclSampleSw_UiActionToggleLight::?relay`
    467            {
    468              /*  UI_STATE_BACK_FROM_APP_MENU  */   {UI_STATE_DEFAULT_MOVE,       UI_STATE_TOGGLE_LIGHT,  UI_KEY_SW_5_PRESSED, &UI_ActionBackFromAppMenu}, //do not change this line, except for the second item, which should point to the last entry in this menu
    469              /*  UI_STATE_TOGGLE_LIGHT        */   {UI_STATE_BACK_FROM_APP_MENU, UI_STATE_DEFAULT_MOVE,  UI_KEY_SW_5_PRESSED | UI_KEY_SW_5_RELEASED, &zclSampleSw_UiActionToggleLight},
    470            };
    471            
    472          /*********************************************************************
    473           * REFERENCED EXTERNALS
    474           */
    475          extern int16 zdpExternalStateTaskID;
    476          
    477          /*********************************************************************
    478           * ZCL General Profile Callback table
    479           */

   \                                 In  segment XDATA_I, align 1, keep-with-next
    480          static zclGeneral_AppCallbacks_t zclSampleSw_CmdCallbacks =
   \                     zclSampleSw_CmdCallbacks:
   \   000000                DS 18
   \   000012                REQUIRE `?<Initializer for zclSampleSw_CmdCallbacks>`
   \   000012                REQUIRE __INIT_XDATA_I
    481          {
    482            zclSampleSw_BasicResetCB,               // Basic Cluster Reset command
    483            NULL,                                   // Identify Trigger Effect command
    484            NULL,                                   // On/Off cluster commands
    485            NULL,                                   // On/Off cluster enhanced command Off with Effect
    486            NULL,                                   // On/Off cluster enhanced command On with Recall Global Scene
    487            NULL,                                   // On/Off cluster enhanced command On with Timed Off
    488          #ifdef ZCL_LEVEL_CTRL
    489            NULL,                                   // Level Control Move to Level command
    490            NULL,                                   // Level Control Move command
    491            NULL,                                   // Level Control Step command
    492            NULL,                                   // Level Control Stop command
    493          #endif
    494          #ifdef ZCL_GROUPS
    495            NULL,                                   // Group Response commands
    496          #endif
    497          #ifdef ZCL_SCENES
    498            NULL,                                   // Scene Store Request command
    499            NULL,                                   // Scene Recall Request command
    500            NULL,                                   // Scene Response command
    501          #endif
    502          #ifdef ZCL_ALARMS
    503            NULL,                                   // Alarm (Response) commands
    504          #endif
    505          #ifdef SE_UK_EXT
    506            NULL,                                   // Get Event Log command
    507            NULL,                                   // Publish Event Log command
    508          #endif
    509            NULL,                                   // RSSI Location command
    510            NULL                                    // RSSI Location Response command
    511          };
    512          
    513          
    514          
    515          /*********************************************************************
    516           * @fn          zclSampleSw_Init
    517           *
    518           * @brief       Initialization function for the zclGeneral layer.
    519           *
    520           * @param       none
    521           *
    522           * @return      none
    523           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    524          void zclSampleSw_Init( byte task_id )
   \                     zclSampleSw_Init:
    525          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000   74F6         MOV       A,#-0xa
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 18
   \   000005   74EE         MOV       A,#-0x12
   \   000007   12....       LCALL     ?ALLOC_XSTACK8
   \   00000A   E9           MOV       A,R1
   \   00000B   FE           MOV       R6,A
    526          #ifdef ZDO_COORDINATOR
    527            bdb_StartCommissioning( BDB_COMMISSIONING_MODE_NWK_FORMATION |
    528                                    BDB_COMMISSIONING_MODE_FINDING_BINDING );
    529          
    530            NLME_PermitJoiningRequest(255);
    531          #else
    532            bdb_StartCommissioning( BDB_COMMISSIONING_MODE_NWK_STEERING |
    533                                    BDB_COMMISSIONING_MODE_FINDING_BINDING );
   \   00000C                ; Setup parameters for call to function bdb_StartCommissioning
   \   00000C   790A         MOV       R1,#0xa
   \   00000E   12....       LCALL     `??bdb_StartCommissioning::?relay`; Banked call to: bdb_StartCommissioning
    534          #endif
    535            zclSampleSw_TaskID = task_id;
   \   000011   EE           MOV       A,R6
   \   000012   90....       MOV       DPTR,#zclSampleSw_TaskID
   \   000015   F0           MOVX      @DPTR,A
    536          
    537            // Set destination address to indirect
    538            zclSampleSw_DstAddr.addrMode = (afAddrMode_t)AddrNotPresent;
   \   000016   90....       MOV       DPTR,#zclSampleSw_DstAddr + 8
   \   000019   E4           CLR       A
   \   00001A   F0           MOVX      @DPTR,A
    539            zclSampleSw_DstAddr.endPoint = 0;
   \   00001B   A3           INC       DPTR
   \   00001C   F0           MOVX      @DPTR,A
    540            zclSampleSw_DstAddr.addr.shortAddr = 0;
   \   00001D   90....       MOV       DPTR,#zclSampleSw_DstAddr
   \   000020   F0           MOVX      @DPTR,A
   \   000021   A3           INC       DPTR
   \   000022   F0           MOVX      @DPTR,A
    541          
    542            // Register the Simple Descriptor for this application
    543            bdb_RegisterSimpleDescriptor( &zclSampleSw_SimpleDesc );
   \   000023                ; Setup parameters for call to function bdb_RegisterSimpleDescriptor
   \   000023   7A..         MOV       R2,#zclSampleSw_SimpleDesc & 0xff
   \   000025   7B..         MOV       R3,#(zclSampleSw_SimpleDesc >> 8) & 0xff
   \   000027   12....       LCALL     `??bdb_RegisterSimpleDescriptor::?relay`; Banked call to: bdb_RegisterSimpleDescriptor
    544          
    545            // Register the ZCL General Cluster Library callback functions
    546            zclGeneral_RegisterCmdCallbacks( SAMPLESW_ENDPOINT, &zclSampleSw_CmdCallbacks );
   \   00002A                ; Setup parameters for call to function zclGeneral_RegisterCmdCallbacks
   \   00002A   7A..         MOV       R2,#zclSampleSw_CmdCallbacks & 0xff
   \   00002C   7B..         MOV       R3,#(zclSampleSw_CmdCallbacks >> 8) & 0xff
   \   00002E   7908         MOV       R1,#0x8
   \   000030   12....       LCALL     `??zclGeneral_RegisterCmdCallbacks::?relay`; Banked call to: zclGeneral_RegisterCmdCallbacks
    547          
    548            zclSampleSw_ResetAttributesToDefaultValues();
   \   000033                ; Setup parameters for call to function zclSampleSw_ResetAttributesToDefaultValues
   \   000033   12....       LCALL     `??zclSampleSw_ResetAttributesToDefaultValues::?`; Banked call to: zclSampleSw_ResetAttributesToDefaultValues
    549            
    550            // Register the application's attribute list
    551            zcl_registerAttrList( SAMPLESW_ENDPOINT, zclSampleSw_NumAttributes, zclSampleSw_Attrs );
   \   000036                ; Setup parameters for call to function zcl_registerAttrList
   \   000036   7C..         MOV       R4,#zclSampleSw_Attrs & 0xff
   \   000038   7D..         MOV       R5,#(zclSampleSw_Attrs >> 8) & 0xff
   \   00003A   90....       MOV       DPTR,#zclSampleSw_NumAttributes
   \   00003D   E4           CLR       A
   \   00003E   93           MOVC      A,@A+DPTR
   \   00003F   FA           MOV       R2,A
   \   000040   7908         MOV       R1,#0x8
   \   000042   12....       LCALL     `??zcl_registerAttrList::?relay`; Banked call to: zcl_registerAttrList
    552          
    553            // Register the Application to receive the unprocessed Foundation command/response messages
    554            zcl_registerForMsg( zclSampleSw_TaskID );
   \   000045                ; Setup parameters for call to function zcl_registerForMsg
   \   000045   90....       MOV       DPTR,#zclSampleSw_TaskID
   \   000048   E0           MOVX      A,@DPTR
   \   000049   F9           MOV       R1,A
   \   00004A   12....       LCALL     `??zcl_registerForMsg::?relay`; Banked call to: zcl_registerForMsg
    555            
    556            // Register low voltage NV memory protection application callback
    557            RegisterVoltageWarningCB( zclSampleApp_BatteryWarningCB );
   \   00004D                ; Setup parameters for call to function RegisterVoltageWarningCB
   \   00004D   7A..         MOV       R2,#`??zclSampleApp_BatteryWarningCB::?relay` & 0xff
   \   00004F   7B..         MOV       R3,#(`??zclSampleApp_BatteryWarningCB::?relay` >> 8) & 0xff
   \   000051   12....       LCALL     `??RegisterVoltageWarningCB::?relay`; Banked call to: RegisterVoltageWarningCB
    558          
    559            // Register for all key events - This app will handle all key events
    560            RegisterForKeys( zclSampleSw_TaskID );
   \   000054                ; Setup parameters for call to function RegisterForKeys
   \   000054   90....       MOV       DPTR,#zclSampleSw_TaskID
   \   000057   E0           MOVX      A,@DPTR
   \   000058   F9           MOV       R1,A
   \   000059   12....       LCALL     `??RegisterForKeys::?relay`; Banked call to: RegisterForKeys
    561            
    562            bdb_RegisterCommissioningStatusCB( zclSampleSw_ProcessCommissioningStatus );
   \   00005C                ; Setup parameters for call to function bdb_RegisterCommissioningStatusCB
   \   00005C   7A..         MOV       R2,#`??zclSampleSw_ProcessCommissioningStatus::?rela` & 0xff
   \   00005E   7B..         MOV       R3,#(`??zclSampleSw_ProcessCommissioningStatus::?rela` >> 8) & 0xff
   \   000060   12....       LCALL     `??bdb_RegisterCommissioningStatusCB::?relay`; Banked call to: bdb_RegisterCommissioningStatusCB
    563          
    564            // Register for a test endpoint
    565            afRegister( &sampleSw_TestEp );
   \   000063                ; Setup parameters for call to function afRegister
   \   000063   7A..         MOV       R2,#sampleSw_TestEp & 0xff
   \   000065   7B..         MOV       R3,#(sampleSw_TestEp >> 8) & 0xff
   \   000067   12....       LCALL     `??afRegister::?relay`; Banked call to: afRegister
    566            
    567            osal_start_timerEx(zclSampleSw_TaskID, 
    568              SAMPLEAPP_REPORT_EVT,//事件
    569              SAMPLEAPP_REPORT_PERIOD);//延迟处理事件的时间长度
   \   00006A                ; Setup parameters for call to function osal_start_timerEx
   \   00006A   90....       MOV       DPTR,#__Constant_bb8
   \   00006D   12....       LCALL     ?PUSH_XSTACK8_X_FOUR
   \   000070   7A40         MOV       R2,#0x40
   \   000072   7B00         MOV       R3,#0x0
   \   000074   90....       MOV       DPTR,#zclSampleSw_TaskID
   \   000077   E0           MOVX      A,@DPTR
   \   000078   F9           MOV       R1,A
   \   000079   12....       LCALL     `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   00007C   7404         MOV       A,#0x4
   \   00007E   12....       LCALL     ?DEALLOC_XSTACK8
    570            
    571          #ifdef ZCL_DIAGNOSTIC
    572            // Register the application's callback function to read/write attribute data.
    573            // This is only required when the attribute data format is unknown to ZCL.
    574            zcl_registerReadWriteCB( SAMPLESW_ENDPOINT, zclDiagnostic_ReadWriteAttrCB, NULL );
    575          
    576            if ( zclDiagnostic_InitStats() == ZSuccess )
    577            {
    578              // Here the user could start the timer to save Diagnostics to NV
    579            }
    580          #endif
    581          
    582          #if defined (OTA_CLIENT) && (OTA_CLIENT == TRUE)
    583            // Register for callback events from the ZCL OTA
    584            zclOTA_Register(zclSampleSw_TaskID);
    585          #endif
    586          
    587            zdpExternalStateTaskID = zclSampleSw_TaskID;
   \   000081   90....       MOV       DPTR,#zclSampleSw_TaskID
   \   000084   E0           MOVX      A,@DPTR
   \   000085   90....       MOV       DPTR,#zdpExternalStateTaskID
   \   000088   F0           MOVX      @DPTR,A
   \   000089   A3           INC       DPTR
   \   00008A   E4           CLR       A
   \   00008B   F0           MOVX      @DPTR,A
    588          
    589            UI_Init(zclSampleSw_TaskID, SAMPLEAPP_LCD_AUTO_UPDATE_EVT, SAMPLEAPP_KEY_AUTO_REPEAT_EVT, &zclSampleSw_IdentifyTime, APP_TITLE, &zclSampleSw_UiUpdateLcd, zclSampleSw_UiStatesMain);
   \   00008C                ; Setup parameters for call to function UI_Init
   \   00008C   75....       MOV       ?V0,#zclSampleSw_UiStatesMain & 0xff
   \   00008F   75....       MOV       ?V1,#(zclSampleSw_UiStatesMain >> 8) & 0xff
   \   000092   78..         MOV       R0,#?V0
   \   000094   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000097   75....       MOV       ?V0,#`??zclSampleSw_UiUpdateLcd::?relay` & 0xff
   \   00009A   75....       MOV       ?V1,#(`??zclSampleSw_UiUpdateLcd::?relay` >> 8) & 0xff
   \   00009D   78..         MOV       R0,#?V0
   \   00009F   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000A2   75....       MOV       ?V0,#`?<Constant "TI Sample Switch">` & 0xff
   \   0000A5   75....       MOV       ?V1,#(`?<Constant "TI Sample Switch">` >> 8) & 0xff
   \   0000A8   78..         MOV       R0,#?V0
   \   0000AA   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000AD   75....       MOV       ?V0,#zclSampleSw_IdentifyTime & 0xff
   \   0000B0   75....       MOV       ?V1,#(zclSampleSw_IdentifyTime >> 8) & 0xff
   \   0000B3   78..         MOV       R0,#?V0
   \   0000B5   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000B8   7C20         MOV       R4,#0x20
   \   0000BA   7D00         MOV       R5,#0x0
   \   0000BC   7A10         MOV       R2,#0x10
   \   0000BE   7B00         MOV       R3,#0x0
   \   0000C0   90....       MOV       DPTR,#zclSampleSw_TaskID
   \   0000C3   E0           MOVX      A,@DPTR
   \   0000C4   F9           MOV       R1,A
   \   0000C5   12....       LCALL     `??UI_Init::?relay`; Banked call to: UI_Init
   \   0000C8   7408         MOV       A,#0x8
   \   0000CA   12....       LCALL     ?DEALLOC_XSTACK8
    590          
    591            UI_UpdateLcd();
   \   0000CD                ; Setup parameters for call to function UI_UpdateLcd
   \   0000CD   12....       LCALL     `??UI_UpdateLcd::?relay`; Banked call to: UI_UpdateLcd
    592          
    593          #ifdef ZDO_COORDINATOR
    594            bdb_StartCommissioning( BDB_COMMISSIONING_MODE_NWK_FORMATION |
    595                                    BDB_COMMISSIONING_MODE_FINDING_BINDING );
    596            
    597            NLME_PermitJoiningRequest(255);
    598            
    599            // Broadcast
    600            osal_start_timerEx(zclSampleSw_TaskID, 
    601                               SAMPLEAPP_BROADCAST_EVT, 
    602                               SAMPLEAPP_BROADCAST_PERIOD);
    603            // groupcast
    604            osal_start_timerEx(zclSampleSw_TaskID, 
    605                               SAMPLEAPP_GROUPCAST_EVT, 
    606                               SAMPLEAPP_GROUPCAST_PERIOD);
    607          #else
    608            bdb_StartCommissioning( BDB_COMMISSIONING_MODE_NWK_STEERING |
    609                                    BDB_COMMISSIONING_MODE_FINDING_BINDING );
   \   0000D0                ; Setup parameters for call to function bdb_StartCommissioning
   \   0000D0   790A         MOV       R1,#0xa
   \   0000D2   12....       LCALL     `??bdb_StartCommissioning::?relay`; Banked call to: bdb_StartCommissioning
    610            // Add group
    611            aps_Group_t group = {
    612              .ID = GROUP_ID,
    613              .name = "",
    614            };
   \   0000D5   90....       MOV       DPTR,#`?<Constant {21, ""}>`
   \   0000D8   AC..         MOV       R4,?XSP + 0
   \   0000DA   AD..         MOV       R5,?XSP + 1
   \   0000DC   7412         MOV       A,#0x12
   \   0000DE   12....       LCALL     ?MOVE_LONG8_XDATA_XDATA
    615            aps_AddGroup(SAMPLESW_ENDPOINT, &group);
   \   0000E1                ; Setup parameters for call to function aps_AddGroup
   \   0000E1   AA..         MOV       R2,?XSP + 0
   \   0000E3   AB..         MOV       R3,?XSP + 1
   \   0000E5   7908         MOV       R1,#0x8
   \   0000E7   12....       LCALL     `??aps_AddGroup::?relay`; Banked call to: aps_AddGroup
    616            
    617            // P2P
    618            osal_start_timerEx(zclSampleSw_TaskID, 
    619                               SAMPLEAPP_P2P_EVT, 
    620                               SAMPLEAPP_P2P_PERIOD);
   \   0000EA                ; Setup parameters for call to function osal_start_timerEx
   \   0000EA   90....       MOV       DPTR,#__Constant_3e8
   \   0000ED   12....       LCALL     ?PUSH_XSTACK8_X_FOUR
   \   0000F0   7A00         MOV       R2,#0x0
   \   0000F2   7B01         MOV       R3,#0x1
   \   0000F4   90....       MOV       DPTR,#zclSampleSw_TaskID
   \   0000F7   E0           MOVX      A,@DPTR
   \   0000F8   F9           MOV       R1,A
   \   0000F9   12....       LCALL     `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   0000FC   7404         MOV       A,#0x4
   \   0000FE   12....       LCALL     ?DEALLOC_XSTACK8
    621          #endif
    622          }
   \   000101   7412         MOV       A,#0x12
   \   000103   12....       LCALL     ?DEALLOC_XSTACK8
   \   000106                REQUIRE ?Subroutine1
   \   000106                ; // Fall through to label ?Subroutine1

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7F02         MOV       R7,#0x2
   \   000002   02....       LJMP      ?BANKED_LEAVE_XDATA

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant {21, ""}>`:
   \   000000   1500         DW 21
   \   000002   00           DB ""
   \   000003   00000000     DB 0, 0, 0, 0, 0, 0, 0, 0
   \            00000000
   \   00000B   00000000     DB 0, 0, 0, 0, 0, 0, 0
   \            000000  
    623          
    624          /*********************************************************************
    625           * @fn          zclSample_event_loop
    626           *
    627           * @brief       Event Loop Processor for zclGeneral.
    628           *
    629           * @param       none
    630           *
    631           * @return      none
    632           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    633          uint16 zclSampleSw_event_loop( uint8 task_id, uint16 events )
   \                     zclSampleSw_event_loop:
    634          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000   74F4         MOV       A,#-0xc
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV       A,R2
   \   000006   FE           MOV       R6,A
   \   000007   EB           MOV       A,R3
   \   000008   FF           MOV       R7,A
    635            afIncomingMSGPacket_t *MSGpkt;
    636            (void)task_id;  // Intentionally unreferenced parameter
    637          
    638            //Send toggle every 500ms
    639            if( events & SAMPLESW_TOGGLE_TEST_EVT )
   \   000009   5410         ANL       A,#0x10
   \   00000B   6064         JZ        ??zclSampleSw_event_loop_0
    640            {
    641              osal_start_timerEx(zclSampleSw_TaskID,SAMPLESW_TOGGLE_TEST_EVT,500);
   \   00000D                ; Setup parameters for call to function osal_start_timerEx
   \   00000D   90....       MOV       DPTR,#__Constant_1f4
   \   000010   12....       LCALL     ?PUSH_XSTACK8_X_FOUR
   \   000013   7A00         MOV       R2,#0x0
   \   000015   7B10         MOV       R3,#0x10
   \   000017   90....       MOV       DPTR,#zclSampleSw_TaskID
   \   00001A   E0           MOVX      A,@DPTR
   \   00001B   F9           MOV       R1,A
   \   00001C   12....       LCALL     `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   00001F   7404         MOV       A,#0x4
   \   000021   12....       LCALL     ?DEALLOC_XSTACK8
    642              zclGeneral_SendOnOff_CmdToggle( SAMPLESW_ENDPOINT, &zclSampleSw_DstAddr, FALSE, 0 );
   \   000024                ; Setup parameters for call to function zcl_SendCommand
   \   000024   E4           CLR       A
   \   000025   F5..         MOV       ?V0,A
   \   000027   F5..         MOV       ?V1,A
   \   000029   78..         MOV       R0,#?V0
   \   00002B   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   00002E   78..         MOV       R0,#?V0
   \   000030   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000033   78..         MOV       R0,#?V0
   \   000035   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000038   78..         MOV       R0,#?V0
   \   00003A   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   00003D   78..         MOV       R0,#?V0
   \   00003F   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000042   78..         MOV       R0,#?V0
   \   000044   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000047   75..01       MOV       ?V0,#0x1
   \   00004A   78..         MOV       R0,#?V0
   \   00004C   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   00004F   75..02       MOV       ?V0,#0x2
   \   000052   78..         MOV       R0,#?V0
   \   000054   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000057   7C06         MOV       R4,#0x6
   \   000059   7D00         MOV       R5,#0x0
   \   00005B   7A..         MOV       R2,#zclSampleSw_DstAddr & 0xff
   \   00005D   7B..         MOV       R3,#(zclSampleSw_DstAddr >> 8) & 0xff
   \   00005F   7908         MOV       R1,#0x8
   \   000061   12....       LCALL     `??zcl_SendCommand::?relay`; Banked call to: zcl_SendCommand
   \   000064   740B         MOV       A,#0xb
   \   000066   12....       LCALL     ?DEALLOC_XSTACK8
    643              
    644              // return unprocessed events
    645              return (events ^ SAMPLESW_TOGGLE_TEST_EVT);
   \   000069   EE           MOV       A,R6
   \   00006A   FA           MOV       R2,A
   \   00006B   EF           MOV       A,R7
   \   00006C   6410         XRL       A,#0x10
   \   00006E   02....       LJMP      ??zclSampleSw_event_loop_1 & 0xFFFF
    646            }
    647            
    648            
    649            if ( events & SYS_EVENT_MSG )
   \                     ??zclSampleSw_event_loop_0:
   \   000071   EF           MOV       A,R7
   \   000072   5480         ANL       A,#0x80
   \   000074   701E         JNZ       ??zclSampleSw_event_loop_2
    650            {
    651              while ( (MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( zclSampleSw_TaskID )) )
    652              {
    653                switch ( MSGpkt->hdr.event )
    654                {
    655                  case AF_INCOMING_MSG_CMD:
    656                  zclSampleSw_AF_RxProc(MSGpkt);
    657                  break;
    658          
    659                  case ZCL_INCOMING_MSG:
    660                    // Incoming ZCL Foundation command/response messages
    661                    zclSampleSw_ProcessIncomingMsg( (zclIncomingMsg_t *)MSGpkt );
    662                    break;
    663          
    664                  case KEY_CHANGE:
    665                    zclSampleSw_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
    666                    break;
    667          
    668                  case ZDO_STATE_CHANGE:
    669                    UI_DeviceStateUpdated((devStates_t)(MSGpkt->hdr.status));
    670                    break;
    671          
    672          #if defined (OTA_CLIENT) && (OTA_CLIENT == TRUE)
    673                  case ZCL_OTA_CALLBACK_IND:
    674                    zclSampleSw_ProcessOTAMsgs( (zclOTA_CallbackMsg_t*)MSGpkt  );
    675                    break;
    676          #endif
    677          
    678                  default:
    679                    break;
    680                }
    681          
    682                // Release the memory
    683                osal_msg_deallocate( (uint8 *)MSGpkt );
    684              }
    685          
    686              // return unprocessed events
    687              return (events ^ SYS_EVENT_MSG);
    688            }
    689          
    690          #if ZG_BUILD_ENDDEVICE_TYPE    
    691            if ( events & SAMPLEAPP_END_DEVICE_REJOIN_EVT )
   \   000076   EE           MOV       A,R6
   \   000077   A2E0         MOV       C,0xE0 /* A   */.0
   \   000079   4003         JC        $+5
   \   00007B   02....       LJMP      ??zclSampleSw_event_loop_3 & 0xFFFF
    692            {
    693              bdb_ZedAttemptRecoverNwk();
   \   00007E                ; Setup parameters for call to function bdb_ZedAttemptRecoverNwk
   \   00007E   12....       LCALL     `??bdb_ZedAttemptRecoverNwk::?relay`; Banked call to: bdb_ZedAttemptRecoverNwk
    694              return ( events ^ SAMPLEAPP_END_DEVICE_REJOIN_EVT );
   \   000081   EE           MOV       A,R6
   \   000082   6401         XRL       A,#0x1
   \   000084   02....       LJMP      ??zclSampleSw_event_loop_4 & 0xFFFF
    695            }
   \                     ??zclSampleSw_event_loop_5:
   \   000087                ; Setup parameters for call to function UI_DeviceStateUpdated
   \   000087   A3           INC       DPTR
   \   000088   E0           MOVX      A,@DPTR
   \   000089   F9           MOV       R1,A
   \   00008A   12....       LCALL     `??UI_DeviceStateUpdated::?relay`; Banked call to: UI_DeviceStateUpdated
   \                     ??zclSampleSw_event_loop_6:
   \   00008D                ; Setup parameters for call to function osal_msg_deallocate
   \   00008D   AA..         MOV       R2,?V0
   \   00008F   AB..         MOV       R3,?V1
   \   000091   12....       LCALL     `??osal_msg_deallocate::?relay`; Banked call to: osal_msg_deallocate
   \                     ??zclSampleSw_event_loop_2:
   \   000094                ; Setup parameters for call to function osal_msg_receive
   \   000094   90....       MOV       DPTR,#zclSampleSw_TaskID
   \   000097   E0           MOVX      A,@DPTR
   \   000098   F9           MOV       R1,A
   \   000099   12....       LCALL     `??osal_msg_receive::?relay`; Banked call to: osal_msg_receive
   \   00009C   8A..         MOV       ?V0,R2
   \   00009E   8B..         MOV       ?V1,R3
   \   0000A0   EA           MOV       A,R2
   \   0000A1   45..         ORL       A,?V1
   \   0000A3   7003         JNZ       $+5
   \   0000A5   02....       LJMP      ??zclSampleSw_event_loop_7 & 0xFFFF
   \   0000A8   8A82         MOV       DPL,R2
   \   0000AA   8B83         MOV       DPH,R3
   \   0000AC   E0           MOVX      A,@DPTR
   \   0000AD   24E6         ADD       A,#-0x1a
   \   0000AF   600E         JZ        ??zclSampleSw_event_loop_8
   \   0000B1   24E6         ADD       A,#-0x1a
   \   0000B3   6075         JZ        ??zclSampleSw_event_loop_9
   \   0000B5   2474         ADD       A,#0x74
   \   0000B7   6077         JZ        ??zclSampleSw_event_loop_10
   \   0000B9   24EF         ADD       A,#-0x11
   \   0000BB   60CA         JZ        ??zclSampleSw_event_loop_5
   \   0000BD   80CE         SJMP      ??zclSampleSw_event_loop_6
   \                     ??zclSampleSw_event_loop_8:
   \   0000BF   A3           INC       DPTR
   \   0000C0   A3           INC       DPTR
   \   0000C1   A3           INC       DPTR
   \   0000C2   A3           INC       DPTR
   \   0000C3   E0           MOVX      A,@DPTR
   \   0000C4   F5..         MOV       ?V2,A
   \   0000C6   A3           INC       DPTR
   \   0000C7   E0           MOVX      A,@DPTR
   \   0000C8   F5..         MOV       ?V3,A
   \   0000CA   78..         MOV       R0,#?V2
   \   0000CC   12....       LCALL     ?US_SWITCH_DENSE
   \                     `?<Jumptable for zclSampleSw_event_loop>_0`:
   \   0000CF   0000         DW        0
   \   0000D1   02           DB        2
   \   0000D2   ....         DW        ??zclSampleSw_event_loop_6
   \   0000D4   ....         DW        ??zclSampleSw_event_loop_11
   \   0000D6   ....         DW        ??zclSampleSw_event_loop_12
   \   0000D8   ....         DW        ??zclSampleSw_event_loop_13
   \                     ??zclSampleSw_event_loop_13:
   \   0000DA   90....       MOV       DPTR,#??gcCnt
   \   0000DD   E0           MOVX      A,@DPTR
   \   0000DE   04           INC       A
   \   0000DF   F0           MOVX      @DPTR,A
   \   0000E0                ; Setup parameters for call to function HalLcdWriteStringValue
   \   0000E0   75..04       MOV       ?V2,#0x4
   \   0000E3   78..         MOV       R0,#?V2
   \   0000E5   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   0000E8   790A         MOV       R1,#0xa
   \   0000EA   90....       MOV       DPTR,#??gcCnt
   \                     ??zclSampleSw_event_loop_14:
   \   0000ED   E0           MOVX      A,@DPTR
   \   0000EE   FC           MOV       R4,A
   \   0000EF   7D00         MOV       R5,#0x0
   \   0000F1   EA           MOV       A,R2
   \   0000F2   2422         ADD       A,#0x22
   \   0000F4   F582         MOV       DPL,A
   \   0000F6   E4           CLR       A
   \   0000F7   35..         ADDC      A,?V1
   \   0000F9   F583         MOV       DPH,A
   \   0000FB   E0           MOVX      A,@DPTR
   \   0000FC   FA           MOV       R2,A
   \   0000FD   A3           INC       DPTR
   \   0000FE   E0           MOVX      A,@DPTR
   \   0000FF   FB           MOV       R3,A
   \   000100   12....       LCALL     `??HalLcdWriteStringValue::?relay`; Banked call to: HalLcdWriteStringValue
   \   000103   7401         MOV       A,#0x1
   \   000105   12....       LCALL     ?DEALLOC_XSTACK8
   \   000108   8083         SJMP      ??zclSampleSw_event_loop_6
   \                     ??zclSampleSw_event_loop_12:
   \   00010A   90....       MOV       DPTR,#??bcCnt
   \   00010D   12....       LCALL     ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_2:
   \   000110   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000113   790A         MOV       R1,#0xa
   \   000115   90....       MOV       DPTR,#??bcCnt
   \   000118   80D3         SJMP      ??zclSampleSw_event_loop_14
   \                     ??zclSampleSw_event_loop_11:
   \   00011A   90....       MOV       DPTR,#??p2pCnt
   \   00011D   12....       LCALL     ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_3:
   \   000120   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000123   790A         MOV       R1,#0xa
   \   000125   90....       MOV       DPTR,#??p2pCnt
   \   000128   80C3         SJMP      ??zclSampleSw_event_loop_14
   \                     ??zclSampleSw_event_loop_9:
   \   00012A                ; Setup parameters for call to function zclSampleSw_ProcessIncomingMsg
   \   00012A   12....       LCALL     `??zclSampleSw_ProcessIncomingMsg::?relay`; Banked call to: zclSampleSw_ProcessIncomingMsg
   \   00012D   02....       LJMP      ??zclSampleSw_event_loop_6 & 0xFFFF
   \                     ??zclSampleSw_event_loop_10:
   \   000130                ; Setup parameters for call to function UI_MainStateMachine
   \   000130   A3           INC       DPTR
   \   000131   A3           INC       DPTR
   \   000132   A3           INC       DPTR
   \   000133   E0           MOVX      A,@DPTR
   \   000134   FA           MOV       R2,A
   \   000135   7B00         MOV       R3,#0x0
   \   000137   12....       LCALL     `??UI_MainStateMachine::?relay`; Banked call to: UI_MainStateMachine
   \   00013A   02....       LJMP      ??zclSampleSw_event_loop_6 & 0xFFFF
   \                     ??zclSampleSw_event_loop_7:
   \   00013D   EE           MOV       A,R6
   \   00013E   FA           MOV       R2,A
   \   00013F   EF           MOV       A,R7
   \   000140   6480         XRL       A,#0x80
   \   000142   8052         SJMP      ??zclSampleSw_event_loop_1
    696          #endif
    697            
    698            if ( events & SAMPLEAPP_LCD_AUTO_UPDATE_EVT )
   \                     ??zclSampleSw_event_loop_3:
   \   000144   5410         ANL       A,#0x10
   \   000146   6008         JZ        ??zclSampleSw_event_loop_15
    699            {
    700              UI_UpdateLcd();
   \   000148                ; Setup parameters for call to function UI_UpdateLcd
   \   000148   12....       LCALL     `??UI_UpdateLcd::?relay`; Banked call to: UI_UpdateLcd
    701              return ( events ^ SAMPLEAPP_LCD_AUTO_UPDATE_EVT );
   \   00014B   EE           MOV       A,R6
   \   00014C   6410         XRL       A,#0x10
   \   00014E   8044         SJMP      ??zclSampleSw_event_loop_4
    702            }
    703          
    704            if ( events & SAMPLEAPP_KEY_AUTO_REPEAT_EVT )
   \                     ??zclSampleSw_event_loop_15:
   \   000150   EE           MOV       A,R6
   \   000151   5420         ANL       A,#0x20
   \   000153   600C         JZ        ??zclSampleSw_event_loop_16
    705            {
    706              UI_MainStateMachine(UI_KEY_AUTO_PRESSED);
   \   000155                ; Setup parameters for call to function UI_MainStateMachine
   \   000155   7AFF         MOV       R2,#-0x1
   \   000157   7BFF         MOV       R3,#-0x1
   \   000159   12....       LCALL     `??UI_MainStateMachine::?relay`; Banked call to: UI_MainStateMachine
    707              return ( events ^ SAMPLEAPP_KEY_AUTO_REPEAT_EVT );
   \   00015C   EE           MOV       A,R6
   \   00015D   6420         XRL       A,#0x20
   \   00015F   8033         SJMP      ??zclSampleSw_event_loop_4
    708            }
    709            // Discard unknown events
    710            
    711          #ifdef ZDO_COORDINATOR
    712            if ( events & SAMPLEAPP_READ_EVT )//如是读命令事件
    713            {
    714              zclSampleSw_ReadTest();//读命令事件处理函数
    715              
    716              //启动一个写命令事件
    717              osal_start_timerEx(zclSampleSw_TaskID, 
    718                                 SAMPLEAPP_WRITE_EVT, 
    719                                 SAMPLEAPP_WRITE_PERIOD);
    720              
    721              return ( events ^ SAMPLEAPP_READ_EVT );
    722            }
    723            if ( events & SAMPLEAPP_WRITE_EVT )//如果是写命令事件
    724            {
    725              zclSampleSw_WriteTest();//写命令处理函数
    726              
    727              osal_start_timerEx(zclSampleSw_TaskID,//启动一个读命令事件
    728                                 SAMPLEAPP_READ_EVT, 
    729                                 SAMPLEAPP_READ_PERIOD);
    730              
    731              return ( events ^ SAMPLEAPP_WRITE_EVT );
    732            }
    733            // Broadcast event
    734            if ( events & SAMPLEAPP_BROADCAST_EVT )
    735            {
    736              zclSampleSw_AF_Broadcast(CLUSTER_BROADCAST,
    737                                       10, "Broadcast");
    738              
    739              osal_start_timerEx(zclSampleSw_TaskID, 
    740                               SAMPLEAPP_BROADCAST_EVT, 
    741                               SAMPLEAPP_BROADCAST_PERIOD);
    742              
    743              return ( events ^ SAMPLEAPP_BROADCAST_EVT );
    744            }
    745            
    746            // Groupcast event
    747            if ( events & SAMPLEAPP_GROUPCAST_EVT )
    748            {
    749              zclSampleSw_AF_Groupcast(GROUP_ID,
    750                                       CLUSTER_GROUPCAST,
    751                                       10, "Groupcast");
    752              
    753              osal_start_timerEx(zclSampleSw_TaskID, 
    754                               SAMPLEAPP_GROUPCAST_EVT, 
    755                               SAMPLEAPP_GROUPCAST_PERIOD);
    756              
    757              return ( events ^ SAMPLEAPP_GROUPCAST_EVT );
    758            }
    759          
    760          #else
    761            if ( events & SAMPLEAPP_REJOIN_EVT )//如果事件类型为重新加入网络事件
   \                     ??zclSampleSw_event_loop_16:
   \   000161   EF           MOV       A,R7
   \   000162   5401         ANL       A,#0x1
   \   000164   600C         JZ        ??zclSampleSw_event_loop_17
    762            {
    763                 /* 重新加入网络 */
    764                 bdb_StartCommissioning(BDB_COMMISSIONING_MODE_NWK_STEERING |
    765                                             BDB_COMMISSIONING_MODE_FINDING_BINDING );
   \   000166                ; Setup parameters for call to function bdb_StartCommissioning
   \   000166   790A         MOV       R1,#0xa
   \   000168   12....       LCALL     `??bdb_StartCommissioning::?relay`; Banked call to: bdb_StartCommissioning
    766              
    767              return ( events ^ SAMPLEAPP_REJOIN_EVT );
   \   00016B   EE           MOV       A,R6
   \   00016C   FA           MOV       R2,A
   \   00016D   EF           MOV       A,R7
   \   00016E   6401         XRL       A,#0x1
   \   000170   8024         SJMP      ??zclSampleSw_event_loop_1
    768            }
    769              // P2P Event
    770            if ( events & SAMPLEAPP_P2P_EVT )
    771            {
    772              zclSampleSw_AF_P2P(0x0000,
    773                                 CLUSTER_P2P,
    774                                 4, "P2P");
    775              
    776              osal_start_timerEx(zclSampleSw_TaskID, 
    777                               SAMPLEAPP_P2P_EVT, 
    778                               SAMPLEAPP_P2P_PERIOD);
    779              
    780              return ( events ^ SAMPLEAPP_P2P_EVT );
    781            }
    782            if ( events & SAMPLEAPP_REPORT_EVT )
   \                     ??zclSampleSw_event_loop_17:
   \   000172   EE           MOV       A,R6
   \   000173   5440         ANL       A,#0x40
   \   000175   6022         JZ        ??zclSampleSw_event_loop_18
    783              {
    784                  zclSampleSw_ReportTest();//属性上报事件的处理函数
   \   000177                ; Setup parameters for call to function zclSampleSw_ReportTest
   \   000177   12....       LCALL     `??zclSampleSw_ReportTest::?relay`; Banked call to: zclSampleSw_ReportTest
    785              
    786                  //启动下一个属性上报事件
    787                  osal_start_timerEx(zclSampleSw_TaskID,
    788                               SAMPLEAPP_REPORT_EVT, 
    789                               SAMPLEAPP_REPORT_PERIOD);
   \   00017A                ; Setup parameters for call to function osal_start_timerEx
   \   00017A   90....       MOV       DPTR,#__Constant_bb8
   \   00017D   12....       LCALL     ?PUSH_XSTACK8_X_FOUR
   \   000180   7A40         MOV       R2,#0x40
   \   000182   7B00         MOV       R3,#0x0
   \   000184   90....       MOV       DPTR,#zclSampleSw_TaskID
   \   000187   E0           MOVX      A,@DPTR
   \   000188   F9           MOV       R1,A
   \   000189   12....       LCALL     `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   00018C   7404         MOV       A,#0x4
   \   00018E   12....       LCALL     ?DEALLOC_XSTACK8
    790                
    791                return ( events ^ SAMPLEAPP_REPORT_EVT );
   \   000191   EE           MOV       A,R6
   \   000192   6440         XRL       A,#0x40
   \                     ??zclSampleSw_event_loop_4:
   \   000194   FA           MOV       R2,A
   \   000195   EF           MOV       A,R7
   \                     ??zclSampleSw_event_loop_1:
   \   000196   FB           MOV       R3,A
   \   000197   8004         SJMP      ??zclSampleSw_event_loop_19
    792            }
    793          #endif
    794            return 0;
   \                     ??zclSampleSw_event_loop_18:
   \   000199   7A00         MOV       R2,#0x0
   \   00019B   7B00         MOV       R3,#0x0
   \                     ??zclSampleSw_event_loop_19:
   \   00019D   02....       LJMP      ?Subroutine0 & 0xFFFF
    795          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   E0           MOVX      A,@DPTR
   \   000001   04           INC       A
   \   000002   F0           MOVX      @DPTR,A
   \   000003                ; Setup parameters for call to function HalLcdWriteStringValue
   \   000003                ; Setup parameters for call to function HalLcdWriteStringValue
   \   000003   75..03       MOV       ?V2,#0x3
   \   000006   78..         MOV       R0,#?V2
   \   000008   22           RET
    796          
    797          /*********************************************************************
    798           * @fn      zclSampleSw_HandleKeys
    799           *
    800           * @brief   Handles all key events for this device.
    801           *
    802           * @param   shift - true if in shift/alt.
    803           * @param   keys - bit field for key events. Valid entries:
    804           *                 HAL_KEY_SW_5
    805           *                 HAL_KEY_SW_4
    806           *                 HAL_KEY_SW_2
    807           *                 HAL_KEY_SW_1
    808           *
    809           * @return  none
    810           */
    811          static void zclSampleSw_HandleKeys( byte shift, byte keys )
    812          {
    813            UI_MainStateMachine(keys);
    814          }
    815          
    816          
    817          /*********************************************************************
    818           * @fn      zclSampleSw_ProcessCommissioningStatus
    819           *
    820           * @brief   Callback in which the status of the commissioning process are reported
    821           *
    822           * @param   bdbCommissioningModeMsg - Context message of the status of a commissioning process
    823           *
    824           * @return  none
    825           */
    826          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    827          static void zclSampleSw_ProcessCommissioningStatus(bdbCommissioningModeMsg_t *bdbCommissioningModeMsg)
   \                     zclSampleSw_ProcessCommissioningStatus:
    828          {
   \   000000   74F7         MOV       A,#-0x9
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EA           MOV       A,R2
   \   000006   FE           MOV       R6,A
   \   000007   EB           MOV       A,R3
   \   000008   FF           MOV       R7,A
    829            switch(bdbCommissioningModeMsg->bdbCommissioningMode)
   \   000009   8E82         MOV       DPL,R6
   \   00000B   8F83         MOV       DPH,R7
   \   00000D   A3           INC       DPTR
   \   00000E   E0           MOVX      A,@DPTR
   \   00000F   14           DEC       A
   \   000010   6022         JZ        ??zclSampleSw_ProcessCommissioningStatus_0
   \   000012   14           DEC       A
   \   000013   6009         JZ        ??zclSampleSw_ProcessCommissioningStatus_1
   \   000015   14           DEC       A
   \   000016   602C         JZ        ??zclSampleSw_ProcessCommissioningStatus_2
   \   000018   24FE         ADD       A,#-0x2
   \   00001A   603B         JZ        ??zclSampleSw_ProcessCommissioningStatus_3
   \   00001C   8059         SJMP      ??zclSampleSw_ProcessCommissioningStatus_4
    830            {
    831              case BDB_COMMISSIONING_FORMATION:
    832                if(bdbCommissioningModeMsg->bdbCommissioningStatus == BDB_COMMISSIONING_SUCCESS)
   \                     ??zclSampleSw_ProcessCommissioningStatus_1:
   \   00001E   8E82         MOV       DPL,R6
   \   000020   8F83         MOV       DPH,R7
   \   000022   E0           MOVX      A,@DPTR
   \   000023   7026         JNZ       ??zclSampleSw_ProcessCommissioningStatus_5
    833                {
    834                  //After formation, perform nwk steering again plus the remaining commissioning modes that has not been processed yet
    835                  bdb_StartCommissioning(BDB_COMMISSIONING_MODE_NWK_STEERING | bdbCommissioningModeMsg->bdbRemainingCommissioningModes);
   \   000025                ; Setup parameters for call to function bdb_StartCommissioning
   \   000025   A3           INC       DPTR
   \   000026   A3           INC       DPTR
   \   000027   E0           MOVX      A,@DPTR
   \   000028   4402         ORL       A,#0x2
   \   00002A   F9           MOV       R1,A
   \   00002B   12....       LCALL     `??bdb_StartCommissioning::?relay`; Banked call to: bdb_StartCommissioning
    836                  printf("successful, 202211672332");
   \   00002E                ; Setup parameters for call to function printf
   \   00002E   7A..         MOV       R2,#`?<Constant "successful, 202211672332">` & 0xff
   \   000030   7B..         MOV       R3,#(`?<Constant "successful, 202211672332">` >> 8) & 0xff
   \   000032   800B         SJMP      ??zclSampleSw_ProcessCommissioningStatus_6
    837                }
    838                else
    839                {
    840                  //printf("faild");
    841                  /* 协调器 */
    842                  #ifdef ZDO_COORDINATOR
    843                  /* 路由器或者终端 */
    844                  #else
    845                      /* 启动重新加入事件 */
    846                  osal_start_timerEx(zclSampleSw_TaskID, 
    847                                             SAMPLEAPP_REJOIN_EVT, 
    848                                             SAMPLEAPP_REJOIN_PERIOD);
    849                  #endif
    850          
    851                  //Want to try other channels?
    852                  //try with bdb_setChannelAttribute
    853                }
    854              break;
    855              case BDB_COMMISSIONING_NWK_STEERING:
    856                if(bdbCommissioningModeMsg->bdbCommissioningStatus == BDB_COMMISSIONING_SUCCESS)
   \                     ??zclSampleSw_ProcessCommissioningStatus_0:
   \   000034   8E82         MOV       DPL,R6
   \   000036   8F83         MOV       DPH,R7
   \   000038   E0           MOVX      A,@DPTR
   \   000039   7010         JNZ       ??zclSampleSw_ProcessCommissioningStatus_5
    857                {
    858                  printf("successful, 202211672332, 周世盛");
   \   00003B                ; Setup parameters for call to function printf
   \   00003B   7A..         MOV       R2,#`?<Constant "successful, 202211672...">` & 0xff
   \   00003D   7B..         MOV       R3,#(`?<Constant "successful, 202211672...">` >> 8) & 0xff
   \                     ??zclSampleSw_ProcessCommissioningStatus_6:
   \   00003F   12....       LCALL     `??printf::?relay`; Banked call to: printf
   \   000042   8033         SJMP      ??zclSampleSw_ProcessCommissioningStatus_4
    859                  //YOUR JOB:
    860                  //We are on the nwk, what now?
    861                }
    862                else
    863                {
    864                  /* 协调器 */
    865                  #ifdef ZDO_COORDINATOR
    866                  /* 路由器或者终端 */
    867                  #else
    868                  /* 启动重新加入事件 */
    869                  osal_start_timerEx(zclSampleSw_TaskID, 
    870                                     SAMPLEAPP_REJOIN_EVT, 
    871                                     SAMPLEAPP_REJOIN_PERIOD);
    872                  #endif
    873          
    874                  //See the possible errors for nwk steering procedure
    875                  //No suitable networks found
    876                  //Want to try other channels?
    877                  //try with bdb_setChannelAttribute
    878                }
    879              break;
    880              case BDB_COMMISSIONING_FINDING_BINDING:
    881                if(bdbCommissioningModeMsg->bdbCommissioningStatus == BDB_COMMISSIONING_SUCCESS)
   \                     ??zclSampleSw_ProcessCommissioningStatus_2:
   \   000044   8E82         MOV       DPL,R6
   \   000046   8F83         MOV       DPH,R7
   \   000048   E0           MOVX      A,@DPTR
   \   000049   602C         JZ        ??zclSampleSw_ProcessCommissioningStatus_4
    882                {
    883                  //YOUR JOB:
    884                }
    885                else
    886                {
    887                  /* 协调器 */
    888                  #ifdef ZDO_COORDINATOR
    889                  /* 路由器或者终端 */
    890                  #else
    891                      /* 启动重新加入事件 */
    892                  osal_start_timerEx(zclSampleSw_TaskID, 
    893                                             SAMPLEAPP_REJOIN_EVT, 
    894                                             SAMPLEAPP_REJOIN_PERIOD);
   \                     ??zclSampleSw_ProcessCommissioningStatus_5:
   \   00004B                ; Setup parameters for call to function osal_start_timerEx
   \   00004B   90....       MOV       DPTR,#__Constant_3e8
   \   00004E   12....       LCALL     ?PUSH_XSTACK8_X_FOUR
   \   000051   7A00         MOV       R2,#0x0
   \   000053   7B01         MOV       R3,#0x1
   \   000055   8013         SJMP      ??zclSampleSw_ProcessCommissioningStatus_7
    895                  #endif
    896          
    897                  //YOUR JOB:
    898                  //retry?, wait for user interaction?
    899                }
    900              break;
    901              case BDB_COMMISSIONING_INITIALIZATION:
    902                //Initialization notification can only be successful. Failure on initialization 
    903                //only happens for ZED and is notified as BDB_COMMISSIONING_PARENT_LOST notification
    904                
    905                //YOUR JOB:
    906                //We are on a network, what now?
    907                
    908              break;
    909          #if ZG_BUILD_ENDDEVICE_TYPE    
    910              case BDB_COMMISSIONING_PARENT_LOST:
    911                if(bdbCommissioningModeMsg->bdbCommissioningStatus == BDB_COMMISSIONING_NETWORK_RESTORED)
   \                     ??zclSampleSw_ProcessCommissioningStatus_3:
   \   000057   8E82         MOV       DPL,R6
   \   000059   8F83         MOV       DPH,R7
   \   00005B   E0           MOVX      A,@DPTR
   \   00005C   640D         XRL       A,#0xd
   \   00005E   6017         JZ        ??zclSampleSw_ProcessCommissioningStatus_4
    912                {
    913                  //We did recover from losing parent
    914                }
    915                else
    916                {
    917                  //Parent not found, attempt to rejoin again after a fixed delay
    918                  osal_start_timerEx(zclSampleSw_TaskID, SAMPLEAPP_END_DEVICE_REJOIN_EVT, SAMPLEAPP_END_DEVICE_REJOIN_DELAY);
   \   000060                ; Setup parameters for call to function osal_start_timerEx
   \   000060   90....       MOV       DPTR,#__Constant_2710
   \   000063   12....       LCALL     ?PUSH_XSTACK8_X_FOUR
   \   000066   7A01         MOV       R2,#0x1
   \   000068   7B00         MOV       R3,#0x0
   \                     ??zclSampleSw_ProcessCommissioningStatus_7:
   \   00006A   90....       MOV       DPTR,#zclSampleSw_TaskID
   \   00006D   E0           MOVX      A,@DPTR
   \   00006E   F9           MOV       R1,A
   \   00006F   12....       LCALL     `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   000072   7404         MOV       A,#0x4
   \   000074   12....       LCALL     ?DEALLOC_XSTACK8
    919                }
    920              break;
    921          #endif 
    922            }
    923            
    924            UI_UpdateComissioningStatus(bdbCommissioningModeMsg);
   \                     ??zclSampleSw_ProcessCommissioningStatus_4:
   \   000077                ; Setup parameters for call to function UI_UpdateComissioningStatus
   \   000077   EE           MOV       A,R6
   \   000078   FA           MOV       R2,A
   \   000079   EF           MOV       A,R7
   \   00007A   FB           MOV       R3,A
   \   00007B   12....       LCALL     `??UI_UpdateComissioningStatus::?relay`; Banked call to: UI_UpdateComissioningStatus
    925          }
   \   00007E   7F01         MOV       R7,#0x1
   \   000080   02....       LJMP      ?BANKED_LEAVE_XDATA
    926          
    927          /*********************************************************************
    928           * @fn      zclSampleSw_BasicResetCB
    929           *
    930           * @brief   Callback from the ZCL General Cluster Library
    931           *          to set all the Basic Cluster attributes to  default values.
    932           *
    933           * @param   none
    934           *
    935           * @return  none
    936           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    937          static void zclSampleSw_BasicResetCB( void )
   \                     zclSampleSw_BasicResetCB:
    938          {
   \   000000   C082         PUSH      DPL
   \   000002   C083         PUSH      DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    939            zclSampleSw_ResetAttributesToDefaultValues();
   \   000004                ; Setup parameters for call to function zclSampleSw_ResetAttributesToDefaultValues
   \   000004   12....       LCALL     `??zclSampleSw_ResetAttributesToDefaultValues::?`; Banked call to: zclSampleSw_ResetAttributesToDefaultValues
    940          
    941            // update the display
    942            UI_UpdateLcd( ); 
   \   000007                ; Setup parameters for call to function UI_UpdateLcd
   \   000007   12....       LCALL     `??UI_UpdateLcd::?relay`; Banked call to: UI_UpdateLcd
    943          }
   \   00000A                REQUIRE ?Subroutine2
   \   00000A                ; // Fall through to label ?Subroutine2

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   D083         POP       DPH
   \   000002   D082         POP       DPL
   \   000004   02....       LJMP      ?BRET
    944          
    945          /*********************************************************************
    946           * @fn      zclSampleApp_BatteryWarningCB
    947           *
    948           * @brief   Called to handle battery-low situation.
    949           *
    950           * @param   voltLevel - level of severity
    951           *
    952           * @return  none
    953           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    954          void zclSampleApp_BatteryWarningCB( uint8 voltLevel )
   \                     zclSampleApp_BatteryWarningCB:
    955          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    956            if ( voltLevel == VOLT_LEVEL_CAUTIOUS )
    957            {
    958              // Send warning message to the gateway and blink LED
    959            }
    960            else if ( voltLevel == VOLT_LEVEL_BAD )
    961            {
    962              // Shut down the system
    963            }
    964          }
   \   000000   02....       LJMP      ?BRET
    965          
    966          /******************************************************************************
    967           *
    968           *  Functions for processing ZCL Foundation incoming Command/Response messages
    969           *
    970           *****************************************************************************/
    971          
    972          /*********************************************************************
    973           * @fn      zclSampleSw_ProcessIncomingMsg
    974           *
    975           * @brief   Process ZCL Foundation incoming message
    976           *
    977           * @param   pInMsg - pointer to the received message
    978           *
    979           * @return  none
    980           */
    981          #ifdef ZCL_REPORT  
    982          static uint8 zclSampleSw_ProcessInReportCmd( zclIncomingMsg_t *pInMsg )  
    983          {  
    984              zclReportCmd_t *reportCmd;  
    985              uint8 i;  
    986          
    987              reportCmd = (zclReportCmd_t *)pInMsg->attrCmd;  
    988          
    989              for ( i = 0; i < reportCmd->numAttr; i++ )//reportCmd->numAttr为属性数量
    990              {  
    991                   if( pInMsg->clusterId == ZCL_CLUSTER_ID_GEN_ON_OFF_SWITCH_CONFIG//Cluster ID
    992          && reportCmd->attrList[i].attrID == ATTRID_ON_OFF_SWITCH_TYPE)//属性ID
    993                  {  
    994                      int8 attrDat = *(reportCmd->attrList[i].attrData);//读取属性值
    995                      HalLcdWriteStringValue("Rx Value:", attrDat, 10, 4);//显示属性值
    996                  }  
    997              }  
    998              return ( TRUE );  
    999          }  
   1000          #endif // ZCL_REPORT

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1001          static void zclSampleSw_ProcessIncomingMsg( zclIncomingMsg_t *pInMsg )
   \                     zclSampleSw_ProcessIncomingMsg:
   1002          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000                REQUIRE ?V4
   \   000000                REQUIRE ?V5
   \   000000   74F2         MOV       A,#-0xe
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   EA           MOV       A,R2
   \   000006   FE           MOV       R6,A
   \   000007   EB           MOV       A,R3
   \   000008   FF           MOV       R7,A
   1003            switch ( pInMsg->zclHdr.commandID )
   \   000009   EE           MOV       A,R6
   \   00000A   2417         ADD       A,#0x17
   \   00000C   F5..         MOV       ?V0,A
   \   00000E   E4           CLR       A
   \   00000F   3F           ADDC      A,R7
   \   000010   F5..         MOV       ?V1,A
   \   000012   8E82         MOV       DPL,R6
   \   000014   8F83         MOV       DPH,R7
   \   000016   A3           INC       DPTR
   \   000017   A3           INC       DPTR
   \   000018   A3           INC       DPTR
   \   000019   A3           INC       DPTR
   \   00001A   A3           INC       DPTR
   \   00001B   A3           INC       DPTR
   \   00001C   A3           INC       DPTR
   \   00001D   E0           MOVX      A,@DPTR
   \   00001E   14           DEC       A
   \   00001F   6026         JZ        ??zclSampleSw_ProcessIncomingMsg_0
   \   000021   24FD         ADD       A,#-0x3
   \   000023   7003         JNZ       $+5
   \   000025   02....       LJMP      ??zclSampleSw_ProcessIncomingMsg_1 & 0xFFFF
   \   000028   24F7         ADD       A,#-0x9
   \   00002A   7003         JNZ       $+5
   \   00002C   02....       LJMP      ??zclSampleSw_ProcessIncomingMsg_2 & 0xFFFF
   \   00002F   24FB         ADD       A,#-0x5
   \   000031   7003         JNZ       $+5
   \   000033   02....       LJMP      ??zclSampleSw_ProcessIncomingMsg_3 & 0xFFFF
   \   000036   24FE         ADD       A,#-0x2
   \   000038   7003         JNZ       $+5
   \   00003A   02....       LJMP      ??zclSampleSw_ProcessIncomingMsg_3 & 0xFFFF
   \   00003D   24FE         ADD       A,#-0x2
   \   00003F   7003         JNZ       $+5
   \   000041   02....       LJMP      ??zclSampleSw_ProcessIncomingMsg_4 & 0xFFFF
   \   000044   02....       LJMP      ??zclSampleSw_ProcessIncomingMsg_5 & 0xFFFF
   1004            {
   1005          #ifdef ZCL_READ
   1006              case ZCL_CMD_READ_RSP:
   1007                zclSampleSw_ProcessInReadRspCmd( pInMsg );
   \                     ??zclSampleSw_ProcessIncomingMsg_0:
   \   000047   85..82       MOV       DPL,?V0
   \   00004A   85..83       MOV       DPH,?V1
   \   00004D   E0           MOVX      A,@DPTR
   \   00004E   F5..         MOV       ?V2,A
   \   000050   A3           INC       DPTR
   \   000051   E0           MOVX      A,@DPTR
   \   000052   F5..         MOV       ?V3,A
   \   000054   75..00       MOV       ?V4,#0x0
   \                     ??zclSampleSw_ProcessIncomingMsg_6:
   \   000057   85..82       MOV       DPL,?V2
   \   00005A   85..83       MOV       DPH,?V3
   \   00005D   E0           MOVX      A,@DPTR
   \   00005E   F8           MOV       R0,A
   \   00005F   E5..         MOV       A,?V4
   \   000061   C3           CLR       C
   \   000062   98           SUBB      A,R0
   \   000063   4003         JC        $+5
   \   000065   02....       LJMP      ??zclSampleSw_ProcessIncomingMsg_5 & 0xFFFF
   \   000068   8E82         MOV       DPL,R6
   \   00006A   8F83         MOV       DPH,R7
   \   00006C   A3           INC       DPTR
   \   00006D   A3           INC       DPTR
   \   00006E   A3           INC       DPTR
   \   00006F   A3           INC       DPTR
   \   000070   A3           INC       DPTR
   \   000071   A3           INC       DPTR
   \   000072   A3           INC       DPTR
   \   000073   A3           INC       DPTR
   \   000074   E0           MOVX      A,@DPTR
   \   000075   6407         XRL       A,#0x7
   \   000077   7002         JNZ       ??zclSampleSw_ProcessIncomingMsg_7
   \   000079   A3           INC       DPTR
   \   00007A   E0           MOVX      A,@DPTR
   \                     ??zclSampleSw_ProcessIncomingMsg_7:
   \   00007B   7049         JNZ       ??zclSampleSw_ProcessIncomingMsg_8
   \   00007D   E5..         MOV       A,?V4
   \   00007F   75F006       MOV       B,#0x6
   \   000082   A4           MUL       AB
   \   000083   F8           MOV       R0,A
   \   000084   A9F0         MOV       R1,B
   \   000086   E5..         MOV       A,?V2
   \   000088   28           ADD       A,R0
   \   000089   F8           MOV       R0,A
   \   00008A   E5..         MOV       A,?V3
   \   00008C   39           ADDC      A,R1
   \   00008D   F9           MOV       R1,A
   \   00008E   E8           MOV       A,R0
   \   00008F   FA           MOV       R2,A
   \   000090   E9           MOV       A,R1
   \   000091   FB           MOV       R3,A
   \   000092   8A82         MOV       DPL,R2
   \   000094   8B83         MOV       DPH,R3
   \   000096   A3           INC       DPTR
   \   000097   E0           MOVX      A,@DPTR
   \   000098   6410         XRL       A,#0x10
   \   00009A   7002         JNZ       ??zclSampleSw_ProcessIncomingMsg_9
   \   00009C   A3           INC       DPTR
   \   00009D   E0           MOVX      A,@DPTR
   \                     ??zclSampleSw_ProcessIncomingMsg_9:
   \   00009E   7026         JNZ       ??zclSampleSw_ProcessIncomingMsg_8
   \   0000A0                ; Setup parameters for call to function HalLcdWriteStringValue
   \   0000A0   75..04       MOV       ?V5,#0x4
   \   0000A3   78..         MOV       R0,#?V5
   \   0000A5   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   0000A8   790A         MOV       R1,#0xa
   \   0000AA   8A82         MOV       DPL,R2
   \   0000AC   8B83         MOV       DPH,R3
   \   0000AE   A3           INC       DPTR
   \   0000AF   A3           INC       DPTR
   \   0000B0   A3           INC       DPTR
   \   0000B1   A3           INC       DPTR
   \   0000B2   A3           INC       DPTR
   \   0000B3   12....       LCALL     ?Subroutine4 & 0xFFFF
   \                     ??CrossCallReturnLabel_1:
   \   0000B6   E0           MOVX      A,@DPTR
   \   0000B7   FC           MOV       R4,A
   \   0000B8   7D00         MOV       R5,#0x0
   \   0000BA   7A..         MOV       R2,#`?<Constant "Read:">` & 0xff
   \   0000BC   7B..         MOV       R3,#(`?<Constant "Read:">` >> 8) & 0xff
   \   0000BE   12....       LCALL     `??HalLcdWriteStringValue::?relay`; Banked call to: HalLcdWriteStringValue
   \   0000C1   7401         MOV       A,#0x1
   \   0000C3   12....       LCALL     ?DEALLOC_XSTACK8
   \                     ??zclSampleSw_ProcessIncomingMsg_8:
   \   0000C6   05..         INC       ?V4
   \   0000C8   808D         SJMP      ??zclSampleSw_ProcessIncomingMsg_6
   1008                break;
   1009          #endif
   1010          #ifdef ZCL_WRITE
   1011              case ZCL_CMD_WRITE_RSP:
   1012                zclSampleSw_ProcessInWriteRspCmd( pInMsg );
   \                     ??zclSampleSw_ProcessIncomingMsg_1:
   \   0000CA   85..82       MOV       DPL,?V0
   \   0000CD   85..83       MOV       DPH,?V1
   \   0000D0   E0           MOVX      A,@DPTR
   \   0000D1   F8           MOV       R0,A
   \   0000D2   A3           INC       DPTR
   \   0000D3   E0           MOVX      A,@DPTR
   \   0000D4   F9           MOV       R1,A
   \   0000D5   8882         MOV       DPL,R0
   \   0000D7   8983         MOV       DPH,R1
   \   0000D9   7800         MOV       R0,#0x0
   \                     ??zclSampleSw_ProcessIncomingMsg_10:
   \   0000DB   E0           MOVX      A,@DPTR
   \   0000DC   F9           MOV       R1,A
   \   0000DD   E8           MOV       A,R0
   \   0000DE   C3           CLR       C
   \   0000DF   99           SUBB      A,R1
   \   0000E0   502C         JNC       ??zclSampleSw_ProcessIncomingMsg_5
   \   0000E2   08           INC       R0
   \   0000E3   80F6         SJMP      ??zclSampleSw_ProcessIncomingMsg_10
   1013                break;
   1014          #endif
   1015          #ifdef ZCL_REPORT
   1016          
   1017              // See ZCL Test Applicaiton (zcl_testapp.c) for sample code on Attribute Reporting
   1018              case ZCL_CMD_CONFIG_REPORT:
   1019                //zclSampleSw_ProcessInConfigReportCmd( pInMsg );
   1020                break;
   1021          
   1022              case ZCL_CMD_CONFIG_REPORT_RSP:
   1023                //zclSampleSw_ProcessInConfigReportRspCmd( pInMsg );
   1024                break;
   1025          
   1026              case ZCL_CMD_READ_REPORT_CFG:
   1027                //zclSampleSw_ProcessInReadReportCfgCmd( pInMsg );
   1028                break;
   1029          
   1030              case ZCL_CMD_READ_REPORT_CFG_RSP:
   1031                //zclSampleSw_ProcessInReadReportCfgRspCmd( pInMsg );
   1032                break;
   1033          
   1034              case ZCL_CMD_REPORT:
   1035                zclSampleSw_ProcessInReportCmd( pInMsg );
   1036                break;
   1037          #endif
   1038              case ZCL_CMD_DEFAULT_RSP:
   1039                zclSampleSw_ProcessInDefaultRspCmd( pInMsg );
   1040                break;
   1041          
   1042          #ifdef ZCL_DISCOVER
   1043              case ZCL_CMD_DISCOVER_CMDS_RECEIVED_RSP:
   1044                zclSampleSw_ProcessInDiscCmdsRspCmd( pInMsg );
   \                     ??zclSampleSw_ProcessIncomingMsg_3:
   \   0000E5                ; Setup parameters for call to function zclSampleSw_ProcessInDiscCmdsRspCmd
   1045                break;
   1046          
   1047              case ZCL_CMD_DISCOVER_CMDS_GEN_RSP:
   1048                zclSampleSw_ProcessInDiscCmdsRspCmd( pInMsg );
   \   0000E5                ; Setup parameters for call to function zclSampleSw_ProcessInDiscCmdsRspCmd
   \   0000E5   12....       LCALL     `??zclSampleSw_ProcessInDiscCmdsRspCmd::?relay`; Banked call to: zclSampleSw_ProcessInDiscCmdsRspCmd
   1049                break;
   \   0000E8   8024         SJMP      ??zclSampleSw_ProcessIncomingMsg_5
   1050          
   1051              case ZCL_CMD_DISCOVER_ATTRS_RSP:
   1052                zclSampleSw_ProcessInDiscAttrsRspCmd( pInMsg );
   \                     ??zclSampleSw_ProcessIncomingMsg_2:
   \   0000EA   12....       LCALL     ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_5:
   \   0000ED   8882         MOV       DPL,R0
   \   0000EF   8983         MOV       DPH,R1
   \   0000F1   A3           INC       DPTR
   \   0000F2   E0           MOVX      A,@DPTR
   \   0000F3   FB           MOV       R3,A
   \   0000F4   EA           MOV       A,R2
   \   0000F5   C3           CLR       C
   \   0000F6   9B           SUBB      A,R3
   \   0000F7   5015         JNC       ??zclSampleSw_ProcessIncomingMsg_5
   \   0000F9   0A           INC       R2
   \   0000FA   80F1         SJMP      ??CrossCallReturnLabel_5
   1053                break;
   1054          
   1055              case ZCL_CMD_DISCOVER_ATTRS_EXT_RSP:
   1056                zclSampleSw_ProcessInDiscAttrsExtRspCmd( pInMsg );
   \                     ??zclSampleSw_ProcessIncomingMsg_4:
   \   0000FC   12....       LCALL     ?Subroutine3 & 0xFFFF
   1057                break;
   1058          #endif
   1059              default:
   1060                break;
   1061            }
   \                     ??CrossCallReturnLabel_6:
   \   0000FF   8001         SJMP      ??zclSampleSw_ProcessIncomingMsg_11
   \                     ??zclSampleSw_ProcessIncomingMsg_12:
   \   000101   0A           INC       R2
   \                     ??zclSampleSw_ProcessIncomingMsg_11:
   \   000102   8882         MOV       DPL,R0
   \   000104   8983         MOV       DPH,R1
   \   000106   A3           INC       DPTR
   \   000107   E0           MOVX      A,@DPTR
   \   000108   FB           MOV       R3,A
   \   000109   EA           MOV       A,R2
   \   00010A   C3           CLR       C
   \   00010B   9B           SUBB      A,R3
   \   00010C   40F3         JC        ??zclSampleSw_ProcessIncomingMsg_12
   1062          
   1063            if ( pInMsg->attrCmd )
   \                     ??zclSampleSw_ProcessIncomingMsg_5:
   \   00010E   85..82       MOV       DPL,?V0
   \   000111   85..83       MOV       DPH,?V1
   \   000114   E0           MOVX      A,@DPTR
   \   000115   FA           MOV       R2,A
   \   000116   A3           INC       DPTR
   \   000117   E0           MOVX      A,@DPTR
   \   000118   FB           MOV       R3,A
   \   000119   EA           MOV       A,R2
   \   00011A   4B           ORL       A,R3
   \   00011B   6003         JZ        ??zclSampleSw_ProcessIncomingMsg_13
   1064              osal_mem_free( pInMsg->attrCmd );
   \   00011D                ; Setup parameters for call to function osal_mem_free
   \   00011D   12....       LCALL     `??osal_mem_free::?relay`; Banked call to: osal_mem_free
   1065          }
   \                     ??zclSampleSw_ProcessIncomingMsg_13:
   \   000120   7F06         MOV       R7,#0x6
   \   000122   02....       LJMP      ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   85..82       MOV       DPL,?V0
   \   000003   85..83       MOV       DPH,?V1
   \   000006                REQUIRE ??Subroutine6_0
   \   000006                ; // Fall through to label ??Subroutine6_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine6_0:
   \   000000   E0           MOVX      A,@DPTR
   \   000001   F8           MOV       R0,A
   \   000002   A3           INC       DPTR
   \   000003   E0           MOVX      A,@DPTR
   \   000004   F9           MOV       R1,A
   \   000005   7A00         MOV       R2,#0x0
   \   000007   22           RET
   1066          
   1067          #ifdef ZCL_READ
   1068          /*********************************************************************
   1069           * @fn      zclSampleSw_ProcessInReadRspCmd
   1070           *
   1071           * @brief   Process the "Profile" Read Response Command
   1072           *
   1073           * @param   pInMsg - incoming message to process
   1074           *
   1075           * @return  none
   1076           */
   1077          static uint8 zclSampleSw_ProcessInReadRspCmd( zclIncomingMsg_t *pInMsg )
   1078          {
   1079            zclReadRspCmd_t *readRspCmd;
   1080            uint8 i;
   1081          
   1082            readRspCmd = (zclReadRspCmd_t *)pInMsg->attrCmd;
   1083            for (i = 0; i < readRspCmd->numAttr; i++)
   1084            {
   1085              // Notify the originator of the results of the original read attributes
   1086              // attempt and, for each successfull request, the value of the requested
   1087              // attribute
   1088              if( pInMsg->clusterId == ZCL_CLUSTER_ID_GEN_ON_OFF_SWITCH_CONFIG &&//如果该消息是关于指定的Cluster
   1089                  readRspCmd->attrList[i].attrID == ATTRID_ON_OFF_SWITCH_ACTIONS )//如果该属性的ID是指定的属性ID
   1090              {
   1091                  uint8 val;
   1092                  val = *(readRspCmd->attrList[i].data);//读取属性值
   1093                  
   1094                  HalLcdWriteStringValue("Read:", val, 10, 4);//显示信息到屏幕中
   1095              }
   1096            }
   1097          
   1098            return TRUE;
   1099          }
   1100          #endif // ZCL_READ
   1101          
   1102          #ifdef ZCL_WRITE
   1103          /*********************************************************************
   1104           * @fn      zclSampleSw_ProcessInWriteRspCmd
   1105           *
   1106           * @brief   Process the "Profile" Write Response Command
   1107           *
   1108           * @param   pInMsg - incoming message to process
   1109           *
   1110           * @return  none
   1111           */
   1112          static uint8 zclSampleSw_ProcessInWriteRspCmd( zclIncomingMsg_t *pInMsg )
   1113          {
   1114            zclWriteRspCmd_t *writeRspCmd;
   1115            uint8 i;
   1116          
   1117            writeRspCmd = (zclWriteRspCmd_t *)pInMsg->attrCmd;
   1118            for (i = 0; i < writeRspCmd->numAttr; i++)
   1119            {
   1120              // Notify the device of the results of the its original write attributes
   1121              // command.
   1122            }
   1123          
   1124            return TRUE;
   1125          }
   1126          #endif // ZCL_WRITE
   1127          
   1128          /*********************************************************************
   1129           * @fn      zclSampleSw_ProcessInDefaultRspCmd
   1130           *
   1131           * @brief   Process the "Profile" Default Response Command
   1132           *
   1133           * @param   pInMsg - incoming message to process
   1134           *
   1135           * @return  none
   1136           */
   1137          static uint8 zclSampleSw_ProcessInDefaultRspCmd( zclIncomingMsg_t *pInMsg )
   1138          {
   1139            // zclDefaultRspCmd_t *defaultRspCmd = (zclDefaultRspCmd_t *)pInMsg->attrCmd;
   1140            // Device is notified of the Default Response command.
   1141            (void)pInMsg;
   1142            return TRUE;
   1143          }
   1144          
   1145          #ifdef ZCL_DISCOVER
   1146          /*********************************************************************
   1147           * @fn      zclSampleSw_ProcessInDiscCmdsRspCmd
   1148           *
   1149           * @brief   Process the Discover Commands Response Command
   1150           *
   1151           * @param   pInMsg - incoming message to process
   1152           *
   1153           * @return  none
   1154           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1155          static uint8 zclSampleSw_ProcessInDiscCmdsRspCmd( zclIncomingMsg_t *pInMsg )
   \                     zclSampleSw_ProcessInDiscCmdsRspCmd:
   1156          {
   \   000000   C082         PUSH      DPL
   \   000002   C083         PUSH      DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1157            zclDiscoverCmdsCmdRsp_t *discoverRspCmd;
   1158            uint8 i;
   1159          
   1160            discoverRspCmd = (zclDiscoverCmdsCmdRsp_t *)pInMsg->attrCmd;
   \   000004   EA           MOV       A,R2
   \   000005   2417         ADD       A,#0x17
   \   000007   F582         MOV       DPL,A
   \   000009   E4           CLR       A
   \   00000A   3B           ADDC      A,R3
   \   00000B   F583         MOV       DPH,A
   \   00000D   12....       LCALL     ??Subroutine6_0 & 0xFFFF
   1161            for ( i = 0; i < discoverRspCmd->numCmd; i++ )
   \                     ??CrossCallReturnLabel_4:
   \   000010   8001         SJMP      ??zclSampleSw_ProcessInDiscCmdsRspCmd_0
   \                     ??zclSampleSw_ProcessInDiscCmdsRspCmd_1:
   \   000012   0A           INC       R2
   \                     ??zclSampleSw_ProcessInDiscCmdsRspCmd_0:
   \   000013   8882         MOV       DPL,R0
   \   000015   8983         MOV       DPH,R1
   \   000017   A3           INC       DPTR
   \   000018   A3           INC       DPTR
   \   000019   E0           MOVX      A,@DPTR
   \   00001A   FB           MOV       R3,A
   \   00001B   EA           MOV       A,R2
   \   00001C   C3           CLR       C
   \   00001D   9B           SUBB      A,R3
   \   00001E   40F2         JC        ??zclSampleSw_ProcessInDiscCmdsRspCmd_1
   1162            {
   1163              // Device is notified of the result of its attribute discovery command.
   1164            }
   1165          
   1166            return TRUE;
   \   000020   7901         MOV       R1,#0x1
   \   000022   02....       LJMP      ?Subroutine2 & 0xFFFF
   1167          }
   1168          
   1169          /*********************************************************************
   1170           * @fn      zclSampleSw_ProcessInDiscAttrsRspCmd
   1171           *
   1172           * @brief   Process the "Profile" Discover Attributes Response Command
   1173           *
   1174           * @param   pInMsg - incoming message to process
   1175           *
   1176           * @return  none
   1177           */
   1178          static uint8 zclSampleSw_ProcessInDiscAttrsRspCmd( zclIncomingMsg_t *pInMsg )
   1179          {
   1180            zclDiscoverAttrsRspCmd_t *discoverRspCmd;
   1181            uint8 i;
   1182          
   1183            discoverRspCmd = (zclDiscoverAttrsRspCmd_t *)pInMsg->attrCmd;
   1184            for ( i = 0; i < discoverRspCmd->numAttr; i++ )
   1185            {
   1186              // Device is notified of the result of its attribute discovery command.
   1187            }
   1188          
   1189            return TRUE;
   1190          }
   1191          
   1192          /*********************************************************************
   1193           * @fn      zclSampleSw_ProcessInDiscAttrsExtRspCmd
   1194           *
   1195           * @brief   Process the "Profile" Discover Attributes Extended Response Command
   1196           *
   1197           * @param   pInMsg - incoming message to process
   1198           *
   1199           * @return  none
   1200           */
   1201          static uint8 zclSampleSw_ProcessInDiscAttrsExtRspCmd( zclIncomingMsg_t *pInMsg )
   1202          {
   1203            zclDiscoverAttrsExtRsp_t *discoverRspCmd;
   1204            uint8 i;
   1205          
   1206            discoverRspCmd = (zclDiscoverAttrsExtRsp_t *)pInMsg->attrCmd;
   1207            for ( i = 0; i < discoverRspCmd->numAttr; i++ )
   1208            {
   1209              // Device is notified of the result of its attribute discovery command.
   1210            }
   1211          
   1212            return TRUE;
   1213          }
   1214          #endif // ZCL_DISCOVER
   1215          
   1216          #if defined (OTA_CLIENT) && (OTA_CLIENT == TRUE)
   1217          /*********************************************************************
   1218           * @fn      zclSampleSw_ProcessOTAMsgs
   1219           *
   1220           * @brief   Called to process callbacks from the ZCL OTA.
   1221           *
   1222           * @param   none
   1223           *
   1224           * @return  none
   1225           */
   1226          static void zclSampleSw_ProcessOTAMsgs( zclOTA_CallbackMsg_t* pMsg )
   1227          {
   1228            uint8 RxOnIdle;
   1229          
   1230            switch(pMsg->ota_event)
   1231            {
   1232            case ZCL_OTA_START_CALLBACK:
   1233              if (pMsg->hdr.status == ZSuccess)
   1234              {
   1235                // Speed up the poll rate
   1236                RxOnIdle = TRUE;
   1237                ZMacSetReq( ZMacRxOnIdle, &RxOnIdle );
   1238                NLME_SetPollRate( 2000 );
   1239              }
   1240              break;
   1241          
   1242            case ZCL_OTA_DL_COMPLETE_CALLBACK:
   1243              if (pMsg->hdr.status == ZSuccess)
   1244              {
   1245                // Reset the CRC Shadow and reboot.  The bootloader will see the
   1246                // CRC shadow has been cleared and switch to the new image
   1247                HalOTAInvRC();
   1248                SystemReset();
   1249              }
   1250              else
   1251              {
   1252          #if (ZG_BUILD_ENDDEVICE_TYPE)    
   1253                // slow the poll rate back down.
   1254                RxOnIdle = FALSE;
   1255                ZMacSetReq( ZMacRxOnIdle, &RxOnIdle );
   1256                NLME_SetPollRate(DEVICE_POLL_RATE);
   1257          #endif
   1258              }
   1259              break;
   1260          
   1261            default:
   1262              break;
   1263            }
   1264          }
   1265          #endif // defined (OTA_CLIENT) && (OTA_CLIENT == TRUE)
   1266          
   1267          /****************************************************************************
   1268          ****************************************************************************/
   1269          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1270          void zclSampleSw_UiActionToggleLight(uint16 keys)
   \                     zclSampleSw_UiActionToggleLight:
   1271          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000   74F6         MOV       A,#-0xa
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   1272            if (zclSampleSw_OnOffSwitchActions == ON_OFF_SWITCH_ACTIONS_TOGGLE)
   \   000005   EA           MOV       A,R2
   \   000006   5404         ANL       A,#0x4
   \   000008   F8           MOV       R0,A
   \   000009   90....       MOV       DPTR,#zclSampleSw_OnOffSwitchActions
   \   00000C   E0           MOVX      A,@DPTR
   \   00000D   6402         XRL       A,#0x2
   \   00000F   7042         JNZ       ??zclSampleSw_UiActionToggleLight_0
   1273            {
   1274              if (keys & UI_KEY_SW_5_PRESSED)
   \   000011   E8           MOV       A,R0
   \   000012   7003         JNZ       $+5
   \   000014   02....       LJMP      ??zclSampleSw_UiActionToggleLight_1 & 0xFFFF
   1275              {
   1276                zclGeneral_SendOnOff_CmdToggle( SAMPLESW_ENDPOINT, &zclSampleSw_DstAddr, FALSE, bdb_getZCLFrameCounter() );
   \   000017                ; Setup parameters for call to function bdb_getZCLFrameCounter
   \   000017   12....       LCALL     `??bdb_getZCLFrameCounter::?relay`; Banked call to: bdb_getZCLFrameCounter
   \   00001A   E9           MOV       A,R1
   \   00001B   F9           MOV       R1,A
   \   00001C                ; Setup parameters for call to function zcl_SendCommand
   \   00001C   E4           CLR       A
   \   00001D   F5..         MOV       ?V0,A
   \   00001F   F5..         MOV       ?V1,A
   \   000021   78..         MOV       R0,#?V0
   \   000023   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000026   78..         MOV       R0,#?V0
   \   000028   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   00002B   E9           MOV       A,R1
   \   00002C   F5..         MOV       ?V0,A
   \   00002E   78..         MOV       R0,#?V0
   \   000030   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000033   E4           CLR       A
   \   000034   F5..         MOV       ?V0,A
   \   000036   78..         MOV       R0,#?V0
   \   000038   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   00003B   78..         MOV       R0,#?V0
   \   00003D   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000040   78..         MOV       R0,#?V0
   \   000042   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000045   75..01       MOV       ?V0,#0x1
   \   000048   78..         MOV       R0,#?V0
   \   00004A   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   00004D   75..02       MOV       ?V0,#0x2
   \   000050   02....       LJMP      ??zclSampleSw_UiActionToggleLight_2 & 0xFFFF
   1277              }
   1278            }
   1279            else if (((keys & UI_KEY_SW_5_PRESSED) && (zclSampleSw_OnOffSwitchActions == ON_OFF_SWITCH_ACTIONS_ON))
   1280              || ((keys & UI_KEY_SW_5_RELEASED) && (zclSampleSw_OnOffSwitchActions == ON_OFF_SWITCH_ACTIONS_OFF)))
   \                     ??zclSampleSw_UiActionToggleLight_0:
   \   000053   E8           MOV       A,R0
   \   000054   6003         JZ        ??zclSampleSw_UiActionToggleLight_3
   \   000056   E0           MOVX      A,@DPTR
   \   000057   600A         JZ        ??zclSampleSw_UiActionToggleLight_4
   \                     ??zclSampleSw_UiActionToggleLight_3:
   \   000059   EB           MOV       A,R3
   \   00005A   5404         ANL       A,#0x4
   \   00005C   603D         JZ        ??zclSampleSw_UiActionToggleLight_5
   \   00005E   E0           MOVX      A,@DPTR
   \   00005F   6401         XRL       A,#0x1
   \   000061   7038         JNZ       ??zclSampleSw_UiActionToggleLight_5
   1281            {
   1282              zclGeneral_SendOnOff_CmdOn( SAMPLESW_ENDPOINT, &zclSampleSw_DstAddr, FALSE, bdb_getZCLFrameCounter() );
   \                     ??zclSampleSw_UiActionToggleLight_4:
   \   000063                ; Setup parameters for call to function bdb_getZCLFrameCounter
   \   000063   12....       LCALL     `??bdb_getZCLFrameCounter::?relay`; Banked call to: bdb_getZCLFrameCounter
   \   000066   E9           MOV       A,R1
   \   000067   F9           MOV       R1,A
   \   000068                ; Setup parameters for call to function zcl_SendCommand
   \   000068   E4           CLR       A
   \   000069   F5..         MOV       ?V0,A
   \   00006B   F5..         MOV       ?V1,A
   \   00006D   78..         MOV       R0,#?V0
   \   00006F   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000072   78..         MOV       R0,#?V0
   \   000074   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000077   E9           MOV       A,R1
   \   000078   F5..         MOV       ?V0,A
   \   00007A   78..         MOV       R0,#?V0
   \   00007C   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   00007F   E4           CLR       A
   \   000080   F5..         MOV       ?V0,A
   \   000082   78..         MOV       R0,#?V0
   \   000084   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000087   78..         MOV       R0,#?V0
   \   000089   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   00008C   78..         MOV       R0,#?V0
   \   00008E   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000091   75..01       MOV       ?V0,#0x1
   \   000094   78..         MOV       R0,#?V0
   \   000096   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000099   8039         SJMP      ??zclSampleSw_UiActionToggleLight_2
   1283            }
   1284            else
   1285            {
   1286              zclGeneral_SendOnOff_CmdOff( SAMPLESW_ENDPOINT, &zclSampleSw_DstAddr, FALSE, bdb_getZCLFrameCounter() );
   \                     ??zclSampleSw_UiActionToggleLight_5:
   \   00009B                ; Setup parameters for call to function bdb_getZCLFrameCounter
   \   00009B   12....       LCALL     `??bdb_getZCLFrameCounter::?relay`; Banked call to: bdb_getZCLFrameCounter
   \   00009E   E9           MOV       A,R1
   \   00009F   F9           MOV       R1,A
   \   0000A0                ; Setup parameters for call to function zcl_SendCommand
   \   0000A0   E4           CLR       A
   \   0000A1   F5..         MOV       ?V0,A
   \   0000A3   F5..         MOV       ?V1,A
   \   0000A5   78..         MOV       R0,#?V0
   \   0000A7   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000AA   78..         MOV       R0,#?V0
   \   0000AC   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000AF   E9           MOV       A,R1
   \   0000B0   F5..         MOV       ?V0,A
   \   0000B2   78..         MOV       R0,#?V0
   \   0000B4   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   0000B7   E4           CLR       A
   \   0000B8   F5..         MOV       ?V0,A
   \   0000BA   78..         MOV       R0,#?V0
   \   0000BC   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000BF   78..         MOV       R0,#?V0
   \   0000C1   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   0000C4   78..         MOV       R0,#?V0
   \   0000C6   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   0000C9   75..01       MOV       ?V0,#0x1
   \   0000CC   78..         MOV       R0,#?V0
   \   0000CE   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   0000D1   75..00       MOV       ?V0,#0x0
   \                     ??zclSampleSw_UiActionToggleLight_2:
   \   0000D4   78..         MOV       R0,#?V0
   \   0000D6   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   0000D9   7C06         MOV       R4,#0x6
   \   0000DB   7D00         MOV       R5,#0x0
   \   0000DD   7A..         MOV       R2,#zclSampleSw_DstAddr & 0xff
   \   0000DF   7B..         MOV       R3,#(zclSampleSw_DstAddr >> 8) & 0xff
   \   0000E1   7908         MOV       R1,#0x8
   \   0000E3   12....       LCALL     `??zcl_SendCommand::?relay`; Banked call to: zcl_SendCommand
   \   0000E6   740B         MOV       A,#0xb
   \   0000E8   12....       LCALL     ?DEALLOC_XSTACK8
   1287            }
   1288          }
   \                     ??zclSampleSw_UiActionToggleLight_1:
   \   0000EB   02....       LJMP      ?Subroutine1 & 0xFFFF
   1289          
   1290          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1291          void zclSampleSw_UiUpdateLcd(uint8 gui_state, char * line[3])
   \                     zclSampleSw_UiUpdateLcd:
   1292          {
   \   000000   C082         PUSH      DPL
   \   000002   C083         PUSH      DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1293            line[2] = "< TOGGLE LIGHT >";
   \   000004   8A82         MOV       DPL,R2
   \   000006   8B83         MOV       DPH,R3
   \   000008   A3           INC       DPTR
   \   000009   A3           INC       DPTR
   \   00000A   A3           INC       DPTR
   \   00000B   A3           INC       DPTR
   \   00000C   74..         MOV       A,#`?<Constant "< TOGGLE LIGHT >">` & 0xff
   \   00000E   F0           MOVX      @DPTR,A
   \   00000F   A3           INC       DPTR
   \   000010   74..         MOV       A,#(`?<Constant "< TOGGLE LIGHT >">` >> 8) & 0xff
   \   000012   F0           MOVX      @DPTR,A
   1294          }
   \   000013   02....       LJMP      ?Subroutine2 & 0xFFFF

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zclSampleSw_OnOffSwitchType>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for sampleSw_TestEp>`:
   \   000000   08           DB 8
   \   000001   00           DB 0
   \   000002   ....         DW zclSampleSw_TaskID
   \   000004   0000         DW 0H
   \   000006   00           DB 0

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zclSampleSw_NwkState>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zclSampleSw_CmdCallbacks>`:
   \   000000   ....         DW `??zclSampleSw_BasicResetCB::?relay`
   \   000002   0000         DW 0H
   \   000004   0000         DW 0H
   \   000006   0000         DW 0H
   \   000008   0000         DW 0H
   \   00000A   0000         DW 0H
   \   00000C   0000         DW 0H
   \   00000E   0000         DW 0H
   \   000010   0000         DW 0H

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclSampleSw_ReportTest::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_ReportTest

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclSampleSw_Init::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclSampleSw_event_loop::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_event_loop

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclSampleSw_ProcessCommissioningStatus::?rela`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_ProcessCommissioningStatus

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclSampleSw_BasicResetCB::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_BasicResetCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclSampleApp_BatteryWarningCB::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleApp_BatteryWarningCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclSampleSw_ProcessIncomingMsg::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_ProcessIncomingMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclSampleSw_ProcessInDiscCmdsRspCmd::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_ProcessInDiscCmdsRspCmd

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclSampleSw_UiActionToggleLight::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_UiActionToggleLight

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zclSampleSw_UiUpdateLcd::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_UiUpdateLcd

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Report: ">`:
   \   000000   5265706F     DB "Report: "
   \            72743A20
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "TI Sample Switch">`:
   \   000000   54492053     DB "TI Sample Switch"
   \            616D706C
   \            65205377
   \            69746368
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \   000000   50325000     DB "P2P"

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "successful, 202211672332">`:
   \   000000   73756363     DB "successful, 202211672332"
   \            65737366
   \            756C2C20
   \            32303232
   \            31313637
   \            32333332
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "successful, 202211672...">`:
   \   000000   73756363     DB "successful, 202211672332, \326\334\312\300\312\242"
   \            65737366
   \            756C2C20
   \            32303232
   \            31313637
   \            32333332
   \            2C20D6DC
   \            CAC0CAA2
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Read:">`:
   \   000000   52656164     DB "Read:"
   \            3A00    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "< TOGGLE LIGHT >">`:
   \   000000   3C20544F     DB "< TOGGLE LIGHT >"
   \            47474C45
   \            204C4947
   \            4854203E
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_bb8:
   \   000000   B80B0000     DD 3000

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3e8:
   \   000000   E8030000     DD 1000

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_1f4:
   \   000000   F4010000     DD 500

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_2710:
   \   000000   10270000     DD 10000
   1295          

   Maximum stack usage in bytes:

   ISTACK XSTACK Function
   ------ ------ --------
      0      0   zclSampleApp_BatteryWarningCB
      2      0   zclSampleSw_BasicResetCB
        2      0   -> UI_UpdateLcd
        2      0   -> zclSampleSw_ResetAttributesToDefaultValues
      0     36   zclSampleSw_Init
        0     28   -> RegisterForKeys
        0     28   -> RegisterVoltageWarningCB
        0     36   -> UI_Init
        0     28   -> UI_UpdateLcd
        0     28   -> afRegister
        0     28   -> aps_AddGroup
        0     28   -> bdb_RegisterCommissioningStatusCB
        0     28   -> bdb_RegisterSimpleDescriptor
        0     28   -> bdb_StartCommissioning
        0     32   -> osal_start_timerEx
        0     28   -> zclGeneral_RegisterCmdCallbacks
        0     28   -> zclSampleSw_ResetAttributesToDefaultValues
        0     28   -> zcl_registerAttrList
        0     28   -> zcl_registerForMsg
      0     13   zclSampleSw_ProcessCommissioningStatus
        0      9   -> UI_UpdateComissioningStatus
        0      9   -> bdb_StartCommissioning
        0     13   -> osal_start_timerEx
        0      9   -> printf
      2     14   zclSampleSw_ProcessInDiscCmdsRspCmd
      0     27   zclSampleSw_ProcessIncomingMsg
        0     15   -> HalLcdWriteStringValue
        0     14   -> osal_mem_free
        0     14   -> zclSampleSw_ProcessInDiscCmdsRspCmd
      1     41   zclSampleSw_ReportTest
        0     25   -> HalLcdWriteStringValue
        0     24   -> osal_mem_alloc
        0     24   -> osal_mem_free
        0     29   -> zcl_SendReportCmd
      0     21   zclSampleSw_UiActionToggleLight
        0     10   -> bdb_getZCLFrameCounter
        0     21   -> zcl_SendCommand
      2      0   zclSampleSw_UiUpdateLcd
      0     23   zclSampleSw_event_loop
        0     13   -> HalLcdWriteStringValue
        0     12   -> UI_DeviceStateUpdated
        0     12   -> UI_MainStateMachine
        0     12   -> UI_UpdateLcd
        0     12   -> bdb_StartCommissioning
        0     12   -> bdb_ZedAttemptRecoverNwk
        0     12   -> osal_msg_deallocate
        0     12   -> osal_msg_receive
        0     16   -> osal_start_timerEx
        0     12   -> zclSampleSw_ProcessIncomingMsg
        0     12   -> zclSampleSw_ReportTest
        0     23   -> zcl_SendCommand


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
      17  ?<Constant "< TOGGLE LIGHT >">
       4  ?<Constant "P2P">
       6  ?<Constant "Read:">
       9  ?<Constant "Report: ">
      17  ?<Constant "TI Sample Switch">
      33  ?<Constant "successful, 202211672...">
      25  ?<Constant "successful, 202211672332">
      18  ?<Constant {21, ""}>
       7  ?<Initializer for sampleSw_TestEp>
      18  ?<Initializer for zclSampleSw_CmdCallbacks>
       1  ?<Initializer for zclSampleSw_NwkState>
       1  ?<Initializer for zclSampleSw_OnOffSwitchType>
       8  ??Subroutine6_0
       5  ?Subroutine0
       5  ?Subroutine1
       7  ?Subroutine2
       6  ?Subroutine3
       9  ?Subroutine4
       9  ?Subroutine5
       4  __Constant_1f4
       4  __Constant_2710
       4  __Constant_3e8
       4  __Constant_bb8
       1  bcCnt
       1  gcCnt
       1  p2pCnt
       7  sampleSw_TestEp
       1  seqNum
       1  transferId
       3  zclSampleApp_BatteryWarningCB
       6  zclSampleApp_BatteryWarningCB::?relay
       1  zclSampleSwSeqNum
      10  zclSampleSw_BasicResetCB
       6  zclSampleSw_BasicResetCB::?relay
      18  zclSampleSw_CmdCallbacks
      12  zclSampleSw_DstAddr
     262  zclSampleSw_Init
       6  zclSampleSw_Init::?relay
       1  zclSampleSw_NwkState
       1  zclSampleSw_OnOffSwitchActions
       1  zclSampleSw_OnOffSwitchType
     131  zclSampleSw_ProcessCommissioningStatus
       6  zclSampleSw_ProcessCommissioningStatus::?relay
      37  zclSampleSw_ProcessInDiscCmdsRspCmd
       6  zclSampleSw_ProcessInDiscCmdsRspCmd::?relay
     293  zclSampleSw_ProcessIncomingMsg
       6  zclSampleSw_ProcessIncomingMsg::?relay
     250  zclSampleSw_ReportTest
       6  zclSampleSw_ReportTest::?relay
       1  zclSampleSw_TaskID
       2  zclSampleSw_TestAddr
     238  zclSampleSw_UiActionToggleLight
       6  zclSampleSw_UiActionToggleLight::?relay
      12  zclSampleSw_UiStatesMain
      22  zclSampleSw_UiUpdateLcd
       6  zclSampleSw_UiUpdateLcd::?relay
     416  zclSampleSw_event_loop
       6  zclSampleSw_event_loop::?relay

 
 1 711 bytes in segment BANKED_CODE
    60 bytes in segment BANK_RELAYS
    27 bytes in segment XDATA_I
    27 bytes in segment XDATA_ID
   157 bytes in segment XDATA_ROM_C
    22 bytes in segment XDATA_Z
 
    87 bytes of CODE     memory
   141 bytes of CONST    memory (+ 16 bytes shared)
 1 711 bytes of HUGECODE memory
    49 bytes of XDATA    memory

Errors: none
Warnings: 4
